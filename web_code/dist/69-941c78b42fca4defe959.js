(window["webpackJsonp_/@project/web_code"]=window["webpackJsonp_/@project/web_code"]||[]).push([[69],{"+AbH":function(e,t,a){"use strict";a("+YrG")},"+G4H":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"group-panel"},[a("div",{staticClass:"group-panel-search-bar"},[a("el-autocomplete",{staticClass:"autocomplete",attrs:{size:"mini","popper-class":"my-autocomplete","fetch-suggestions":e.apiSearch,placeholder:"请输入名称查找"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(n.name))])]}}]),model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v(" "),a("div",{staticClass:"btn-group"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("el-button",{attrs:{type:"text"}},[e._v("添加")]),e._v(" "),a("el-dropdown-menu",{staticClass:"custom-api-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{staticClass:"drop-down-item",attrs:{command:"api",disabled:!e.apiGroupList.length}},[e._v("新增API\n          ")]),e._v(" "),a("el-dropdown-item",{staticClass:"drop-down-item",attrs:{command:"group"}},[e._v("新增分组\n          ")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"group-list"},[a("n-tree",{ref:"nodeTree",staticClass:"api-group-tree",attrs:{data:e.apiGroupList,"node-key":"id","expand-on-click-node":!0,"default-expand-all":"","highlight-current":"",draggable:!1,"icon-class":"icon-right",props:{children:"apis"}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return a("div",{staticClass:"tree-node",class:{"is-selected":e.isSelected(n)},on:{click:function(t){return t.stopPropagation(),e.handleSelect(n)}}},[a("div",{staticClass:"node-name"},[a("img",{staticClass:"node-icon",attrs:{src:e.getIcon(n),alt:""}}),e._v(" "),n.rename?a("div",[a("el-input",{attrs:{placeholder:"请输入分组名"},on:{blur:function(t){return e.handleRename(n,n.name)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRename(n,n.name)}},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"data.name"}})],1):a("span",[e._v(e._s(n.name))])]),e._v(" "),n.apis?a("el-dropdown",{staticClass:"node-right-menu-icon",attrs:{trigger:"click"},on:{command:function(t){return e.handleApiGroup(t,n)}}},[a("span",{staticClass:"el-dropdown-link",on:{click:function(e){e.stopPropagation()}}},[a("i",{staticClass:"el-icon-more el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{staticClass:"custom-api-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("重命名")]),e._v(" "),a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:0===n.apis.length,expression:"data.apis.length === 0"}],attrs:{command:"delete"}},[e._v("\n              删除\n            ")])],1)],1):e._e()],1)}}])})],1)])},i=[]},"+R0i":function(e,t,a){},"+Xtg":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:e.title,visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticClass:"dialog-content"},["STANDARD"===e.mapConfig.mode?a("div",{staticClass:"mode"},[a("el-button",{on:{click:e.changeMode}},[e._v("专业模式"),a("i",{staticClass:"el-icon-sort pro-icon"})]),e._v(" "),a("el-button",{on:{click:e.handleShowTree}},[e._v("树结构查看")])],1):a("div",{staticClass:"mode"},[a("el-button",{on:{click:e.changeMode}},[e._v("标准模式"),a("i",{staticClass:"el-icon-sort pro-icon"})]),e._v(" "),a("el-button",{on:{click:e.handleMockScript}},[e._v("测试")])],1),e._v(" "),"STANDARD"===e.mapConfig.mode?a("div",{staticClass:"config"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("出参结构定义")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleShowTreeChange}},[e._v("转换器")])],1),e._v(" "),a("JsonTree",{attrs:{treeNode:e.mapConfig.standardMapConfig,stepData:e.stepData}}),e._v(" "),a("JsonView",{ref:"jsonView",attrs:{stepData:e.stepData}}),e._v(" "),a("TreeChange",{ref:"treeChange",on:{confirm:e.handleTreeChangeConfirm}})],1):a("div",{staticClass:"config"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("代码输入")]),e._v(" "),a("div",[a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"left"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.templateContent)},slot:"content"}),e._v(" "),a("i",{staticClass:"el-icon-question test-btn tooltip"})]),e._v(" "),a("el-button-group",{staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{size:"mini",type:"GROOVY"===e.mapConfig.professionalMapConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("GROOVY")}}},[e._v("Groovy")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"JAVASCRIPT"===e.mapConfig.professionalMapConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("JAVASCRIPT")}}},[e._v("JavaScript")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"PYTHON"===e.mapConfig.professionalMapConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("PYTHON")}}},[e._v("Python")])],1)],1)]),e._v(" "),a("div",{staticClass:"code-wrapper",class:{"is-show-log":e.isShowLog}},[a("div",{staticClass:"empty-code",domProps:{innerHTML:e._s(e.templateText)}}),e._v(" "),"JAVASCRIPT"===e.mapConfig.professionalMapConfig.scriptType?a("js-code",{ref:"jsCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.mapConfig.professionalMapConfig.script,callback:function(t){e.$set(e.mapConfig.professionalMapConfig,"script",t)},expression:"mapConfig.professionalMapConfig.script"}}):e._e(),e._v(" "),"GROOVY"===e.mapConfig.professionalMapConfig.scriptType?a("groovy-code",{ref:"groovyCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.mapConfig.professionalMapConfig.script,callback:function(t){e.$set(e.mapConfig.professionalMapConfig,"script",t)},expression:"mapConfig.professionalMapConfig.script"}}):e._e(),e._v(" "),"PYTHON"===e.mapConfig.professionalMapConfig.scriptType?a("python-code",{ref:"pythonCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.mapConfig.professionalMapConfig.script,callback:function(t){e.$set(e.mapConfig.professionalMapConfig,"script",t)},expression:"mapConfig.professionalMapConfig.script"}}):e._e(),e._v(" "),e.isShowLog?a("div",{staticClass:"log-wrapper"},[a("el-button",{staticClass:"clear-btn",attrs:{size:"mini",disabled:!e.logList.length},on:{click:e.handleClearLog}},[e._v("清空结果")]),e._v(" "),a("el-button",{staticClass:"clear-btn",attrs:{size:"mini"},on:{click:function(t){e.isShowLog=!1}}},[e._v("关闭")]),e._v(" "),a("div",{staticClass:"log-list"},e._l(e.logList,(function(t,n){return a("div",{key:n,staticClass:"log-item"},[e._v("\n              "+e._s(t)+"\n            ")])})),0)],1):e._e()],1),e._v(" "),a("div",{staticClass:"params-config"},[a("n-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.params,border:""}},[a("n-table-column",{attrs:{prop:"key",label:"参数名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}],null,!1,3453451902)}),e._v(" "),a("n-table-column",{attrs:{prop:"value",label:"参数值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0!==t.row.value?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.value),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(t.row.value,!0)},on:{click:function(a){return e.handleTagClick(t.row,"value")},close:function(e){t.row.value=void 0}}},[e._v("\n                    "+e._s(e.formatTag(e.getElementName(t.row.value,!0),12))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleShowVariableSelect(t.row,"value")}}},[e._v("参数\n                  ")])],1)],1)]}}],null,!1,767547640)}),e._v(" "),a("n-table-column",{attrs:{prop:"mockValue",label:"测试值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0!==t.row.mockValue?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.mockValue),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":""},on:{click:function(a){return e.handleTagClick(t.row,"mockValue")},close:function(e){t.row.mockValue=void 0}}},[e._v("\n                    "+e._s(e.formatTag(t.row.mockValue))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",{staticStyle:{display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("text",t.row,"mockValue")}}},[e._v("文本\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("number",t.row,"mockValue")}}},[e._v("数值\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("object",t.row,"mockValue")}}},[e._v("对象\n                    ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.mockValue=e}}})],1)],1)]}}],null,!1,2021707137)}),e._v(" "),a("n-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddParams}},[e._v("+")]),e._v(" "),a("div",{staticClass:"add-btn-primary",staticStyle:{"margin-left":"10px"},on:{click:function(a){return e.handleDeleteParams(t.$index)}}},[e._v("\n                  -\n                ")])])]}}],null,!1,3233719987)})],1),e._v(" "),"PYTHON"===e.mapConfig.professionalMapConfig.scriptType?a("div",{staticClass:"return-params",staticStyle:{"margin-top":"10px"}},[e._v("\n          返回值定义："),a("el-tag",{staticStyle:{margin:"0 10px"}},[e._v("out_param")]),e._v(" 程序会返回代码中同名的变量\n        ")],1):e._e(),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}}),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:!0},on:{confirm:e.handleVariableConfirm}})],1)])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1)])},i=[]},"+YrG":function(e,t,a){var n=a("2uWp");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("5ec21d69",n,!0,{})},"//J7":function(e,t,a){"use strict";a("TzBK")},"/Iv9":function(e,t,a){"use strict";a("J6vy")},"/Vzg":function(e,t,a){"use strict";a.r(t);var n=a("FpxB"),i=a("p4Xy");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("lLit");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"13cf3c7b",null);t.default=r.exports},"/ZDK":function(e,t,a){"use strict";a.r(t);var n=a("1se+"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"0X8H":function(e,t,a){"use strict";a.r(t);var n=a("vRL6"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"0avZ":function(e,t,a){var n=a("NbR/");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("f8cb074e",n,!0,{})},"0sKM":function(e,t,a){},"0tbR":function(e,t,a){var n=a("bmgL");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("2f0f15c2",n,!0,{})},"1AIl":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],ref:"dialog",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"步骤测试日志",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"mock-info"},[a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/do-status.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.status))]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("执行状态")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/time.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.time)+" ms")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("总耗时")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/successCount.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.successCount)+"个")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("成功逻辑")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/failedCount.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.failedCount)+"个")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("失败逻辑")])])])]),e._v(" "),a("div",{staticClass:"mock-detail"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("测试内容")])]),e._v(" "),e.logData?[a("el-button-group",e._l(e.logData.actionResults,(function(t){return a("el-button",{key:t.actionInfo.code,staticClass:"action-item-btn",class:{success:!!t.executed&&t.executeResult.success,skip:!t.executed,selected:e.selectedAction===t},attrs:{size:"mini"},on:{click:function(a){return e.handleChangeAction(t)}}},[e._v(e._s(t.actionInfo.code)+"："+e._s(t.actionInfo.name))])})),1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"action-item-detail"},[e._l(e.actionLogList,(function(t,n){return[0!==t.detail.indexOf("[JSON_FORMAT]")?a("div",{key:n,staticClass:"log-info-item"},[e._v("\n              "+e._s(t.detail)+"\n            ")]):a("div",{key:n,staticClass:"log-info-item json"},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.showDetail=!t.showDetail}}},[e._v(e._s(t.showDetail?"收起":"展开"))]),e._v(" "),t.showDetail?a("pre",{staticClass:"json-code"},[e._v(e._s(JSON.stringify(JSON.parse(t.detail.replace("[JSON_FORMAT]","")),(function(e,t){return void 0===t?null:t}),2)))]):e._e()],1)]}))],2)]:e._e()],2),e._v(" "),a("div",{staticClass:"mock-response"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("测试出参")])]),e._v(" "),a("div",{staticClass:"res-detail"},[a("div",{staticClass:"source"},[a("div",{staticClass:"source-title"},[e._v("\n            源出参\n          ")]),e._v(" "),a("div",{staticClass:"input"},[a("pre",[e._v(e._s(e.sourceMsg))])])]),e._v(" "),a("div",{staticClass:"source"},[a("div",{staticClass:"source-title"},[e._v("\n            格式化出参\n          ")]),e._v(" "),a("div",{staticClass:"output"},[a("pre",[e._v(e._s(e.formatMsg))])])])])])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)])},i=[]},"1D54":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("KAmc")),o=a("8SHQ"),s=a("E0s0");a("uD/U");var r=a("a+hW"),l={name:"CustomApiVariableSelect",components:{VueJsonPretty:new s.Factory({virtualLines:30})},inject:["customApiProvide"],props:{showSelf:{type:Boolean,default:!1}},data:function(){return{dialogVisible:!1,selectedPath:"",selectedCode:"global",stepCode:"",onlyGlobal:!1,loading:!1}},computed:{steps:function(){return this.customApiProvide.apiDetail.steps},response:function(){return"global"===this.selectedCode?this.customApiProvide.apiDetail.requestBody:this.showSelf&&this.selectedCode===this.stepCode?window[o.CUSTOM_API_RESPONSE_MAP]["".concat(this.selectedCode,"_source")]:window[o.CUSTOM_API_RESPONSE_MAP][this.selectedCode]||window[o.CUSTOM_API_RESPONSE_MAP]["".concat(this.selectedCode,"_source")]}},methods:{open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fullVariable,a=e.stepCode,n=e.onlyGlobal,i=void 0!==n&&n;if(t){var o=(0,r.getPathList)(t);this.selectedCode=o[0].replace("$",""),this.selectedPath=t.replace(o[0],"response")}else this.selectedCode="global",this.selectedPath="";this.onlyGlobal=i,this.stepCode=a,this.dialogVisible=!0},handleClose:function(e){this.dialogVisible=!1,e()},handleConfirm:function(){if(this.selectedPath){var e=this.selectedPath.replace("response","$".concat(this.selectedCode));this.$emit("confirm",e),this.dialogVisible=!1}else this.$message.error("请选择出参节点！")},clickPath:function(){},handleSelectStep:function(e){this.isDisabledStep(e)||(this.selectedCode=e)},isDisabledStep:function(e){var t=this;if(this.onlyGlobal)return"global"!==e;var a=this.steps.map((function(e){return e.code})),n=a.findIndex((function(e){return e===t.stepCode}));return this.showSelf?a.splice(n+1).includes(e):a.splice(n).includes(e)},getResponse:function(){var e=this,t=this.steps.find((function(t){return t.code===e.selectedCode}));this.loading=!0,this.$http({url:i.default.apiDesignMockRunStep,data:{appId:Number(this.$route.query.id),sessionId:window[o.CUSTOM_API_SESSION_ID],requestBody:this.customApiProvide.apiDetail.requestBody,step:t}}).then((function(a){window[o.CUSTOM_API_RESPONSE_MAP][t.code]=a.data.mappedOutput,window[o.CUSTOM_API_RESPONSE_MAP]["".concat(t.code,"_source")]=a.data.output,e.selectedCode="global",e.selectedCode=t.code})).finally((function(){e.loading=!1}))}}};t.default=l},"1Qg2":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"转换器",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"config"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("步骤出参JSON源")])]),e._v(" "),a("json-code",{staticClass:"json-code-editor",attrs:{isObject:!0,readOnly:!0},model:{value:e.source,callback:function(t){e.source=t},expression:"source"}})],1),e._v(" "),a("el-button",{staticStyle:{margin:"0 10px"},attrs:{size:"mini",type:"primary"},on:{click:e.handleCopy}},[e._v("一键复制"),a("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"5px"}})]),e._v(" "),a("div",{staticClass:"config"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("出参格式化JSON")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("编辑步骤出参格式化后的JSON内容，可快速生成树形结构\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("json-code",{staticClass:"json-code-editor",attrs:{isObject:!0},model:{value:e.map,callback:function(t){e.map=t},expression:"map"}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1)])},i=[]},"1fXb":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=(n(a("YLtl")),n(a("xRjl"))),r=n(a("GRfi")),l=n(a("R2Z8")),c=a("8SHQ"),u=a("E0s0");a("uD/U");var d=new u.Factory({virtualLines:20}),p={name:"StepItem",components:{ActionConfig:s.default,VueJsonPretty:d,StepMock:r.default,Formatter:l.default},inject:["customApiProvide"],provide:function(){return{stepProvide:{stepData:this.stepData}}},props:{stepData:{type:Object},order:{type:Number}},data:function(){return{loading:!1,response:null,popoverWidth:""}},methods:{handleRemoveStep:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确认删除此步骤配置吗？");case 2:e.$emit("remove");case 3:case"end":return t.stop()}}),t)})))()},handleAddAction:function(e){this.stepData.name?this.$refs.actionConfig.open({type:e,stepData:this.stepData}):this.$message.error("请输入步骤名称！")},handleEditAction:function(e){this.$refs.actionConfig.open({type:e.type,actionData:e,stepData:this.stepData})},handleSaveAction:function(e){var t=e.actionData,a=this.stepData.actions.findIndex((function(e){return e.code===t.code}));-1!==a?this.$set(this.stepData.actions,a,t):this.stepData.actions.push(t)},handleRemoveAction:function(e){var t=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确认删除此逻辑吗？","提示");case 2:t.stepData.actions=t.stepData.actions.filter((function(t){return t.code!==e.code}));case 3:case"end":return a.stop()}}),a)})))()},handleMock:function(){this.stepData.name?this.stepData.actions.length?this.$refs.stepMock.open({stepData:this.stepData}):this.$message.error("请先配置逻辑！"):this.$message.error("请输入步骤名称！")},handleUpdateResponse:function(e){this.popoverWidth="".concat(e.target.getBoundingClientRect().width),this.response=this.stepData.mapConfig?window[c.CUSTOM_API_RESPONSE_MAP][this.stepData.code]:window[c.CUSTOM_API_RESPONSE_MAP]["".concat(this.stepData.code,"_source")]},handleFormat:function(){this.stepData.name?this.stepData.actions.length?this.$refs.formatter.open({stepData:this.stepData}):this.$message.error("请先配置逻辑！"):this.$message.error("请输入步骤名称！")},handleFormatConfirm:function(e){this.$set(this.stepData,"mapConfig",e)},handleRemoveFormat:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确认删除格式化配置吗？","提示");case 2:e.stepData.mapConfig=null;case 3:case"end":return t.stop()}}),t)})))()}}};t.default=p},"1kJ6":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"low-code-dialog",title:"新增属性",width:"340px","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,visible:e.popoverVisible,top:"15vh"},on:{"update:visible":function(t){e.popoverVisible=t}}},[e.popoverVisible?a("div",{staticClass:"variable-body"},[a("n-form",{ref:"variableForm",staticClass:"data-form",attrs:{model:e.formData,inline:"","label-width":"60px"},nativeOn:{submit:function(e){e.preventDefault()}}},[e.needName?a("n-form-item",{attrs:{label:"Key",prop:"keyName"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{type:"text",placeholder:"Key"},model:{value:e.formData.keyName,callback:function(t){e.$set(e.formData,"keyName",t)},expression:"formData.keyName"}})],1):e._e(),e._v(" "),a("n-form-item",{attrs:{label:"值类型"}},[a("el-select",{staticStyle:{width:"180px"},attrs:{"popper-append-to-body":!1},on:{change:function(t){e.formData.valName=void 0}},model:{value:e.formatSelected,callback:function(t){e.formatSelected=t},expression:"formatSelected"}},e._l(e.formats,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label,disabled:"variable"===t.value&&!e.showVariable}})})),1)],1),e._v(" "),"variable"===e.formatSelected?[a("n-form-item",{attrs:{label:"测试值"}},[a("div",{staticClass:"value-input-wrapper"},[void 0!==e.formData.valName?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(e.formData.valName),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(e.formData.valName)},on:{click:function(t){return e.handleShowVariableSelect(e.formData,"valName")},close:function(t){e.formData.valName=void 0}}},[e._v("\n                "+e._s(e.formatTag(e.getElementName(e.formData.valName),12))+"\n              ")])],1):a("el-button",{on:{click:function(t){return e.handleShowVariableSelect(e.formData,"valName")}}},[e._v("选择参数\n            ")])],1)])]:e._e(),e._v(" "),["array","object","variable"].includes(e.formatSelected)?e._e():[a("n-form-item",{attrs:{label:"测试值",prop:"valName"}},[a("div",{staticClass:"value-input-wrapper"},["string"===e.formatSelected?a("el-input",{staticStyle:{width:"180px"},attrs:{type:"text",placeholder:"value"},model:{value:e.formData.valName,callback:function(t){e.$set(e.formData,"valName",t)},expression:"formData.valName"}}):e._e(),e._v(" "),"number"===e.formatSelected?a("el-input",{staticStyle:{width:"180px"},attrs:{type:"number",placeholder:"value"},on:{change:e.dealNumber},model:{value:e.formData.valName,callback:function(t){e.$set(e.formData,"valName",t)},expression:"formData.valName"}}):e._e(),e._v(" "),"boolean"===e.formatSelected?a("el-select",{staticStyle:{width:"180px"},on:{change:e.dealBoolean},model:{value:e.formData.valName,callback:function(t){e.$set(e.formData,"valName",t)},expression:"formData.valName"}},[a("el-option",{attrs:{value:!0,label:"true"}}),e._v(" "),a("el-option",{attrs:{value:!1,label:"false"}})],1):e._e()],1)])]],2),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确认 ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.cancel}},[e._v("取消 ")])],1)],1):e._e(),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",on:{confirm:e.handleVariableConfirm}})],1)},i=[]},"1se+":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("slWK")),r=n(a("aAb1")),l=a("xBdn"),c=a("8SHQ"),u=n(a("YLtl")),d=n(a("PHku")),p={name:"MacroVariables",components:{InputDialog:r.default},mixins:[d.default],data:function(){return{dialogVisible:!1,editVisible:!1,loading:!1,dataList:[],detail:{key:"",defaultValue:void 0,desc:"",id:0},rules:{key:(0,l.getValidators)([{message:"请输入变量编码",include:l.required,required:!0,trigger:"change"},{message:"变量编码不能包含特殊字符",include:l.hasSpecialCharacter,trigger:"change"}]),desc:(0,l.getValidators)([{message:"请输入变量名",include:l.required,required:!0,trigger:"change"}])},isManage:!0}},methods:{open:function(){var e=arguments,t=this;return(0,o.default)(i.default.mark((function a(){var n,o,s,r,l;return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},o=n.isManage,s=void 0===o||o,r=n.fullVariable,t.isManage=s,a.next=4,t.handleSearch(!0);case 4:t.dialogVisible=!0,r&&(l=t.dataList.find((function(e){return"$macroVariables.".concat(e.key)===r})),t.$nextTick((function(){l&&t.$refs.xTable.setRadioRow(l)})));case 6:case"end":return a.stop()}}),a)})))()},handleClose:function(e){this.dialogVisible=!1,e()},cancel:function(){this.dialogVisible=!1},handleSearch:function(){var e=this;return this.loading=!0,this.$http({url:s.default.appDataMacroVariableList,data:{appId:Number(this.$route.query.id)}}).then((function(t){var a=t.data;e.dataList=a.map((function(e){return{defaultValue:e.defaultValue,desc:e.description,id:e.id,key:e.name}})),window[c.CUSTOM_API_MACRO_VARIABLES]=e.dataList})).finally((function(){e.loading=!1}))},handleUpdate:function(e){var t=this;void 0!==e.defaultValue?(this.loading=!0,this.$http({url:s.default.appDataMacroVariableUpdate,data:{defaultValue:e.defaultValue,description:e.desc,name:e.key,id:e.id,appId:Number(this.$route.query.id)}}).then((function(e){e.data;t.handleSearch(),t.editVisible=!1})).finally((function(){t.loading=!1}))):this.$message.error("请输入宏变量值！")},handleSave:function(){var e=this;void 0!==this.detail.defaultValue?(this.loading=!0,this.$http({url:s.default.appDataMacroVariableSave,data:{defaultValue:this.detail.defaultValue,description:this.detail.desc,name:this.detail.key,appId:Number(this.$route.query.id)}}).then((function(t){t.data;e.handleSearch(),e.editVisible=!1})).finally((function(){e.loading=!1}))):this.$message.error("请输入宏变量值！")},handleEdit:function(e){var t=this;this.detail=u.default.cloneDeep(e),this.editVisible=!0,this.$nextTick((function(){t.$refs.editForm.clearValidate()}))},handleDelete:function(e){var t=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确认删除[".concat(e.key,"]吗？"));case 2:t.loading=!0,t.$http({url:s.default.appDataMacroVariableRemove,data:{id:e.id}}).then((function(e){e.data;t.handleSearch()})).finally((function(){t.loading=!1}));case 4:case"end":return a.stop()}}),a)})))()},handleAdd:function(){var e=this;this.detail={key:"",defaultValue:void 0,desc:"",id:0},this.editVisible=!0,this.$nextTick((function(){e.$refs.editForm.clearValidate()}))},handleEditConfirm:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.editForm.validate();case 2:if(!e.detail.id){t.next=6;break}e.handleUpdate(e.detail),t.next=10;break;case 6:if(!e.dataList.some((function(t){return t.key===e.detail.key}))){t.next=9;break}return e.$message.error("编码不能重复！"),t.abrupt("return");case 9:e.handleSave();case 10:case"end":return t.stop()}}),t)})))()},getDefaultValue:function(e){return u.default.isObject(e)?JSON.stringify(e,(function(e,t){return void 0===t?null:t}),2):e},confirm:function(){var e=this.$refs.xTable,t=null==e?void 0:e.getRadioRecord();t?(this.$emit("confirm","$macroVariables.".concat(t.key)),this.cancel()):this.$message.error("请选择宏变量")}}};t.default=p},"275s":function(e,t,a){var n=a("imte");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("70eb457d",n,!0,{})},"2KVu":function(e,t,a){"use strict";a("oAoA")},"2Odn":function(e,t,a){"use strict";a.r(t);var n=a("GKGU"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"2aR8":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={name:"KeyTip",data:function(){return{dialogVisible:!1}},methods:{open:function(){this.dialogVisible=!0},handleClose:function(e){this.dialogVisible=!1,e()}}}},"2uWp":function(e,t,a){},"2wg+":function(e,t,a){"use strict";a("z9WI")},"35m7":function(e,t,a){"use strict";a.r(t);var n=a("PAdJ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"3Z33":function(e,t,a){var n=a("JSrl");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("11f2a309",n,!0,{})},"3tqg":function(e,t,a){var n=a("fLK4");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("10d8267a",n,!0,{})},"4+nq":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"选择出参",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"aside"},[a("div",{staticClass:"menu-item",class:{selected:"global"===e.selectedCode},on:{click:function(t){e.selectedCode="global"}}},[e._v("API请求出参")]),e._v(" "),a("el-divider",[a("span",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v("步骤出参")])]),e._v(" "),e._l(e.steps,(function(t){return a("div",{key:t.code,staticClass:"menu-item",class:{selected:e.selectedCode===t.code,disabled:e.isDisabledStep(t.code)},on:{click:function(a){return e.handleSelectStep(t.code)}}},[e._v(e._s(t.name||"未命名步骤"))])}))],2),e._v(" "),a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty no-select",attrs:{path:"response",data:e.response,virtual:!0,itemHeight:32,selectableType:"single",showSelectController:!0,selectOnClickNode:!0},on:{click:e.clickPath},model:{value:e.selectedPath,callback:function(t){e.selectedPath=t},expression:"selectedPath"}}),e._v(" "),e.response?e._e():a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("div",{staticClass:"empty-text"},[e._v("暂无数据")]),e._v(" "),"global"!==e.selectedCode?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:e.getResponse}},[e._v("测试")]):e._e()],1)],1)]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1)])},i=[]},"4NMP":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("rePB")),r=n(a("YLtl"));function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"LogicList",inject:["customApiProvide"],props:{tree:{type:Array},defaultSelectedKeys:{type:Array,default:function(){return[]}},nodeKey:{type:String,default:"code"},treeProps:{type:Object,default:function(){return{children:"actions",label:"name",disabled:function(e,t){return e.disabled}}}},width:{type:[String,Number],default:"380px"}},data:function(){return{popoverVisible:!1,filterText:"",selectedNodes:[],defaultExpandedKeys:[]}},computed:{treeData:function(){return this.tree?this.tree:this.customApiProvide.apiDetail.steps.map((function(e){return c(c({},e),{},{disabled:!0})}))}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t[this.treeProps.label].indexOf(e)},handleCheckClick:function(e,t,a){this.$refs.tree.setCheckedKeys([e[this.nodeKey]])},handleCheckChange:r.default.debounce((0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("选择的配置将覆盖当前配置，是否继续？","提示");case 2:t=this.$refs.tree.getCheckedNodes(),this.$emit("change",t);case 4:case"end":return e.stop()}}),e,this)}))),100),getIcon:function(e){return e.actions?this.$getImgPrefix("/design/el-icon-folder-opened.png"):this.$getImgPrefix("/design/el-icon-tickets.png")}}};t.default=u},"4r5A":function(e,t,a){var n=a("TRM7");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("79c0cc37",n,!0,{})},"52Qv":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("YLtl")),r=n(a("lrFb")),l=a("8SHQ"),c={name:"TreeChange",components:{JsonCode:r.default},data:function(){return{dialogVisible:!1,source:{},map:{}}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},handleConfirm:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("已配置的格式化数据将被覆盖，是否继续？");case 2:e.$emit("confirm",e.map),e.dialogVisible=!1;case 4:case"end":return t.stop()}}),t)})))()},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stepData,a=window[l.CUSTOM_API_RESPONSE_MAP]["".concat(t.code,"_source")];this.source=s.default.cloneDeep(a),this.map={},this.dialogVisible=!0},handleCopy:function(){this.map=s.default.cloneDeep(this.source)}}};t.default=c},"5PXa":function(e,t,a){"use strict";a.r(t);var n=a("LLrg"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"5nuN":function(e,t,a){},"5ziZ":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("PHku")),o=n(a("ydmR")),s=n(a("T4dZ")),r=n(a("Nu7Z")),l=n(a("tQ29")),c={components:{ObjectFormatter:o.default,StringFormatter:s.default,BooleanFormatter:r.default,NumberFormatter:l.default},name:"JsonTree",mixins:[i.default],props:{treeNode:{type:Object},stepData:{type:Object},isFlat:{type:Boolean,default:!1}},data:function(){return{types:[{label:"文本",value:"String"},{label:"数值",value:"Number"},{label:"布尔",value:"Boolean"},{label:"对象",value:"Object"},{label:"数组",value:"Array"}]}},methods:{handleAddNode:function(){this.treeNode.children.push({key:"",type:"String"}),this.handleUpdateIndex()},handleDeleteNode:function(e){if(1===this.treeNode.children.length)return this.treeNode.children[0].key="",this.treeNode.children[0].type="String",this.treeNode.children[0].mapperConfig=null,this.treeNode.children[0].reference=null,void this.handleUpdateIndex();this.treeNode.children.splice(e,1),this.handleUpdateIndex()},handleUpdateIndex:function(){"Array"===this.treeNode.type&&this.treeNode.children.forEach((function(e,t){return e.key="".concat(t)}))},handleShowFormatter:function(e){if(e.key)switch(e.type){case"String":this.$refs.stringFormatter.open({currentNode:e});break;case"Number":this.$refs.numberFormatter.open({currentNode:e});break;case"Boolean":this.$refs.booleanFormatter.open({currentNode:e});break;case"Object":case"Array":this.isFlat?this.$emit("addLevel",e):this.$refs.objectFormatter.open({stepData:this.stepData,rootNode:e})}else this.$message.error("请先输入参数名称!")},getTips:function(e){if(e.mapperConfig)switch(e.mapperConfig.type){case"OBJECT_MAP":return"对象格式化";case"ARRAY_MAP":return"数组格式化";case"TEXT_EXTRACT":return"文本提取";case"TEXT_REPLACE":return"文本替换";case"TEXT_JOIN":return"文本合并";case"TEXT_DATE_FORMAT":return"日期格式化";case"BOOLEAN_MAP":return"布尔值格式化";case"NUMBER_COUNT":return"数值统计";case"NUMBER_CALCULATE":return"数值计算";case"DECIMAL_POINT_FORMAT":return"小数点格式化"}if(e.reference)return this.formatTip(e.reference.name)},getTag:function(e){return e.mapperConfig?this.getTips(e):e.reference?this.getElementName(e.reference.name,!0):void 0},handleTagClick:function(e){e.key?e.mapperConfig?this.handleShowFormatter(e):e.reference&&this.handleShowVariableSelect(e.reference,"name"):this.$message.error("请先输入参数名称!")},handleDeleteFormatter:function(e){e.reference=void 0,e.mapperConfig=void 0},getTagErrorType:function(e){return e.mapperConfig?"":e.reference?this.getTagType(e.reference.name,!0):void 0},handleSelectVar:function(e){e.key?(e.reference||this.$set(e,"reference",{name:"",expression:""}),this.handleShowVariableSelect(e.reference,"name")):this.$message.error("请先输入参数名称!")},isShowFormat:function(e){if(e.mapperConfig){switch(!0){case"OBJECT_MAP"===e.mapperConfig.type&&!e.mapperConfig.objectMap:case"ARRAY_MAP"===e.mapperConfig.type&&!e.mapperConfig.arrayMap:case"TEXT_EXTRACT"===e.mapperConfig.type&&!e.mapperConfig.textExtract:case"TEXT_REPLACE"===e.mapperConfig.type&&!e.mapperConfig.textReplace:case"TEXT_JOIN"===e.mapperConfig.type&&!e.mapperConfig.textJoin:case"TEXT_DATE_FORMAT"===e.mapperConfig.type&&!e.mapperConfig.textDateFormat:case"BOOLEAN_MAP"===e.mapperConfig.type&&!e.mapperConfig.booleanMap:case"NUMBER_COUNT"===e.mapperConfig.type&&!e.mapperConfig.numberCount:case"NUMBER_CALCULATE"===e.mapperConfig.type&&!e.mapperConfig.numberCalculate:case"DECIMAL_POINT_FORMAT"===e.mapperConfig.type&&!e.mapperConfig.decimalPointFormat:return!1}return!0}if(e.reference)return e.reference.name},handleFormatConfirm:function(e){var t=this.treeNode.children.findIndex((function(t){return t.key===e.key}));this.$set(this.treeNode.children,t,e)}}};t.default=c},"6/aR":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"source-select"},[e.showLabel?a("span",{staticClass:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("选择参数：")]):e._e(),e._v(" "),e.source.name?a("el-tooltip",{attrs:{effect:"dark",content:e.source.name,placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(e.source.name,!0)},on:{click:function(t){return e.handleShowVariableSelect(e.source,"name",e.handleBuildAttr)},close:function(t){return e.handleBuildAttr("")}}},[e._v("\n      "+e._s(e.getElementName(e.source.name,!0))+"\n    ")])],1):a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleShowVariableSelect(e.source,"name",e.handleBuildAttr)}}},[e._v(e._s(e.title))]),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:!0},on:{confirm:e.handleVariableConfirm}})],1)},i=[]},"6I2U":function(e,t,a){"use strict";a.r(t);var n=a("sOD7"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"6SMo":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],staticClass:"input-dialog",attrs:{"custom-class":"low-code-dialog",title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,width:"1000px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-body"},["text"===e.type?a("el-input",{staticClass:"input-item",attrs:{type:"textarea",rows:3,placeholder:"请输入文本"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e(),e._v(" "),"number"===e.type?a("el-input-number",{staticClass:"input-item",attrs:{placeholder:"请输入数值"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e(),e._v(" "),"object"===e.type?a("div",{staticClass:"json-input"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"树形结构",name:"tree"}},["tree"===e.activeName?a("JsonEditor",{staticClass:"json-editor",attrs:{"callback-id":e.callbackId},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{name:"json"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                  JSON\n                  "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\nJSON文件都是被包裹在一个大括号{}或者方括号[]中，通过key-value的方式来表达数据。JSON的Key必须包裹在一个双引号中，在实践中，编写 JSON 的时候，忘了给 Key 值加双引号或者是把双引号写成单引号是常见错误。\n\nJSON的值只能是以下几种数据格式，其他任何格式都会触发报错，例如 JavaScript 中的 undefined。\n\n1.数字，包含浮点数和整数\n2.字符串，需要包裹在双引号中\n3.Bool值，true 或者 false\n4.数组，需要包裹在方括号中 []\n5.对象，需要包裹在大括号中 {}\n6.Null\n\n还需要注意的是 JSON 文件中无法使用注释，试图添加注释将会引发报错\n                    ")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),"json"===e.activeName?a("json-code",{staticClass:"json-code-editor",model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e()],1)],1)],1):e._e(),e._v(" "),"js"===e.type?a("div",{staticClass:"js-input"},[a("js-config",{staticClass:"input-item",model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])},i=[]},"6Z5G":function(e,t,a){},"6cMV":function(e,t,a){"use strict";a("CFxy")},"6wtB":function(e,t,a){"use strict";a.r(t);var n=a("rcpd"),i=a("O3Zp");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("9HmO");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"607e8bcc",null);t.default=r.exports},"72HB":function(e,t,a){var n=a("+R0i");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("53d69f62",n,!0,{})},"74Pu":function(e,t,a){"use strict";a.r(t);var n=a("GCzl"),i=a("V8Qa");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("ECxf");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"c0b9621e",null);t.default=r.exports},"7buB":function(e,t,a){},"7ota":function(e,t,a){"use strict";a.r(t);var n=a("gzKy"),i=a("ABca");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("Zcd6");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"0f1d90aa",null);t.default=r.exports},8087:function(e,t,a){"use strict";a.r(t);var n=a("qU0l"),i=a("KOCq");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("kdlR"),a("8Ep0");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"40392e1a",null);t.default=r.exports},"83Fj":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"python-code"},[a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],ref:"codeEditor",staticClass:"highlight-code"}),e._v(" "),e.resizable?a("ChangeHeight",{on:{heightChange:e.handleHeightChange}}):e._e()],1)},i=[]},"8Ep0":function(e,t,a){"use strict";a("a11y")},"8Rwu":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"宏变量管理",visible:e.dialogVisible,width:"1000px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"app-variables"},[a("el-button",{staticStyle:{margin:"0 0 15px 0"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增\n    ")]),e._v(" "),e.dialogVisible?a("vxe-table",{ref:"xTable",attrs:{size:"mini",data:e.dataList,border:"","show-overflow":"","header-cell-class-name":"header-cell","row-id":"key","radio-config":e.isManage?void 0:{trigger:"row",highlight:!0}}},[e.isManage?e._e():a("vxe-table-column",{attrs:{type:"radio",title:"选择",align:"center",width:"60"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"key",title:"变量编码"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"desc",title:"变量名","min-width":"100px"}}),e._v(" "),a("vxe-table-column",{attrs:{title:"默认值",field:"defaultValue"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.getDefaultValue(n.defaultValue)))])]}}],null,!1,3805519123)}),e._v(" "),a("vxe-table-column",{attrs:{title:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除\n          ")])]}}],null,!1,1083762825)})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isManage?a("el-button",{on:{click:e.cancel}},[e._v("关 闭")]):a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 认")])],1),e._v(" "),a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:e.detail.id?"编辑":"新增",visible:e.editVisible,width:"1000px",top:"5vh"},on:{"update:visible":function(t){e.editVisible=t}}},[a("n-form",{ref:"editForm",attrs:{"label-position":"left",rules:e.rules,model:e.detail,"label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("n-form-item",{attrs:{label:"变量编码",prop:"key"}},[a("el-input",{attrs:{disabled:e.detail.id},model:{value:e.detail.key,callback:function(t){e.$set(e.detail,"key",t)},expression:"detail.key"}})],1),e._v(" "),a("n-form-item",{attrs:{label:"变量名",prop:"desc"}},[a("el-input",{model:{value:e.detail.desc,callback:function(t){e.$set(e.detail,"desc",t)},expression:"detail.desc"}})],1),e._v(" "),a("n-form-item",{attrs:{label:"变量值",prop:"defaultValue"}},[void 0!==e.detail.defaultValue?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(e.detail.defaultValue),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(e.detail.defaultValue)},on:{click:function(t){return e.handleTagClick(e.detail,"defaultValue")},close:function(t){e.detail.defaultValue=void 0}}},[e._v("\n            "+e._s(e.formatTag(e.getElementName(e.detail.defaultValue),12))+"\n          ")])],1):[a("el-button-group",{staticClass:"default-value"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.showInputDialog("text",e.detail,"defaultValue")}}},[e._v("文本")])],1)]],2)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleEditConfirm}},[e._v("确 认")])],1)],1),e._v(" "),a("input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}})],1)},i=[]},"8YQo":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],ref:"dialog",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"API测试日志",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"mock-info"},[a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/do-status.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.status))]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("执行状态")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/time.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.time)+" ms")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("总耗时")])])])]),e._v(" "),a("div",{staticClass:"mock-request"},[a("div",{staticClass:"title",on:{click:function(t){e.isShowRequest=!e.isShowRequest}}},[a("span",{staticClass:"t"},[e._v("入参JSON")]),e._v(" "),a("i",{class:e.isShowRequest?"el-icon-arrow-down":"el-icon-arrow-right"})]),e._v(" "),e.isShowRequest?a("div",{staticClass:"mock-request-content"},[a("pre",{staticClass:"json-code"},[e._v(e._s(JSON.stringify(e.apiDetail.requestBody,(function(e,t){return void 0===t?null:t}),2)))])]):e._e()]),e._v(" "),a("div",{staticClass:"mock-request"},[a("div",{staticClass:"title",on:{click:function(t){e.isShowLog=!e.isShowLog}}},[a("span",{staticClass:"t"},[e._v("测试日志")]),e._v(" "),a("i",{class:e.isShowLog?"el-icon-arrow-down":"el-icon-arrow-right"})]),e._v(" "),e.isShowLog?a("div",{staticClass:"mock-request-content"},[a("pre",{staticClass:"json-code"},[e._v(e._s(e.logMessage))])]):e._e()]),e._v(" "),a("div",{staticClass:"mock-request"},[a("div",{staticClass:"title",on:{click:function(t){e.isShowResult=!e.isShowResult}}},[a("span",{staticClass:"t"},[e._v("测试结果")]),e._v(" "),a("i",{class:e.isShowResult?"el-icon-arrow-down":"el-icon-arrow-right"})]),e._v(" "),e.isShowResult?a("div",{staticClass:"mock-request-content"},[a("pre",{staticClass:"json-code"},[e._v(e._s(JSON.stringify(e.response,(function(e,t){return void 0===t?null:t}),2)))])]):e._e()])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)])},i=[]},"9HmO":function(e,t,a){"use strict";a("AhRJ")},"9LRD":function(e,t,a){"use strict";a("gRNa")},"9Ti4":function(e,t,a){"use strict";a.r(t);var n=a("fy6Q"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"9Tsg":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],staticClass:"data-select-dialog",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"数据集编辑",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],staticClass:"dialog-content"},[e.detail?a("n-form",{ref:"dataForm",staticClass:"data-set-save-form",attrs:{"label-position":"left",model:e.detail,rules:e.rules,"label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("n-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.detail.name,callback:function(t){e.$set(e.detail,"name","string"==typeof t?t.trim():t)},expression:"detail.name"}})],1),e._v(" "),a("n-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.detail.description,callback:function(t){e.$set(e.detail,"description","string"==typeof t?t.trim():t)},expression:"detail.description"}})],1)],1):e._e(),e._v(" "),e.dialogVisible?a("data-set-config",{ref:"dataSetConfig",attrs:{request:{apiRequest:e.apiRequest,sqlRequest:e.sqlRequest,staticData:e.staticData},type:e.activeDataType,"is-hide-select":!0},on:{"update:type":function(t){e.activeDataType=t},response:e.handleResponse}}):e._e(),e._v(" "),a("el-collapse",{staticClass:"config-collapse",model:{value:e.activeCollapse,callback:function(t){e.activeCollapse=t},expression:"activeCollapse"}},[a("el-collapse-item",{attrs:{name:"response"}},[a("template",{slot:"title"},[a("div",{staticClass:"config-collapse-title"},[e._v("响应体")])]),e._v(" "),a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty",attrs:{path:"response",data:e.response,virtual:!0,itemHeight:24,showSelectController:!1}}),e._v(" "),e.response?e._e():a("div",{staticClass:"empty-text"},[e._v("暂无数据")])],1)],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirm}},[e._v("确 认")])],1)])},i=[]},"9yPJ":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("KQm4")),s=n(a("ODXe")),r=n(a("HaE+")),l=n(a("YLtl")),c={name:"GroovyCode",components:{ChangeHeight:n(a("ZoP3")).default},props:{value:{type:String},paramsData:{type:Array,default:function(){return[]}},resizable:{type:Boolean,default:!1}},data:function(){return{loading:!1,hints:[],monacoInstance:null,provider:null,logList:[],code:""}},computed:{dynamicHints:function(){return this.paramsData.map((function(e){return e.key})).filter((function(e){return e}))}},watch:{paramsData:{handler:function(e,t){e.length&&this.initHints()},deep:!0,immediate:!0},value:{handler:function(e,t){var a;l.default.isEqual(e,t)||(this.code=e,null===(a=this.monacoInstance)||void 0===a||a.setValue(e))},immediate:!0}},methods:{initHints:function(){this.hints=Array.from(new Set(this.dynamicHints)).sort()},dispose:function(){this.monacoInstance&&(this.monacoInstance.getModel()&&this.monacoInstance.getModel().dispose(),this.monacoInstance.dispose(),this.monacoInstance=null,this.provider&&(this.provider.dispose(),this.provider=null))},init:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,r,l,c,u,d,p,f,v;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$refs.codeEditor){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,e.code=e.value,r=[Promise.all([a.e(0),a.e(1)]).then(a.t.bind(null,"M/lh",7)),Promise.all([a.e(0),a.e(1),a.e(7),a.e(2)]).then(a.t.bind(null,"cOx4",7)),Promise.all([a.e(0),a.e(1),a.e(7)]).then(a.t.bind(null,"A2Yk",7))],t.next=8,Promise.all(r);case 8:l=t.sent,c=(0,s.default)(l,3),u=c[0],d=c[1],p=c[2],u.languages.register({id:"groovy"}),p.registerRulesForLanguage("groovy",new d.default),f=e,e.dispose(),v=function(e){var t=e.replace(/[\*\[\]@\$\(\)]/g,"").replace(/(\s+|\.)/g," ").split(" "),a=t[t.length-1],n=a.length,i=new RegExp("([^\\w]|^)"+a+"\\w*","gim"),s=f.value.match(i),r=s?s.map((function(e){var t=new RegExp(a,"gim"),n=e.search(t);return e.substr(n)})):[],l=Array.from(new Set([].concat((0,o.default)(f.hints),(0,o.default)(r)))).sort().filter((function(e){var t=new RegExp(e.substr(0,n),"gim");return!(s&&1===s.length&&e===a||1===e.length)&&a.match(t)}));return l.map((function(e){return{label:e,kind:f.hints.indexOf(e)>-1?u.languages.CompletionItemKind.Keyword:u.languages.CompletionItemKind.Text,documentation:e,insertText:e}}))},e.provider=u.languages.registerCompletionItemProvider("groovy",{provideCompletionItems:function(e,t){var a=e.getValueInRange({startLineNumber:t.lineNumber,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column});return{suggestions:v(a)}}}),e.monacoInstance=u.editor.create(n,{value:e.code,language:"groovy",theme:"vs",folding:!1,foldingHighlight:!0,foldingStrategy:"indentation",showFoldingControls:"always",disableLayerHinting:!0,emptySelectionClipboard:!1,selectionClipboard:!1,automaticLayout:!0,codeLens:!1,scrollBeyondLastLine:!1,colorDecorators:!0,accessibilitySupport:"off",lineNumbers:"on",lineNumbersMinChars:5,enableSplitViewResizing:!1,roundedSelection:!1,overviewRulerBorder:!1,minimap:{enabled:!1},autoIndent:"full",readOnly:!1,tabSize:2}),e.monacoInstance.onDidFocusEditorText((function(){e.$emit("focus-change",!0)})),e.monacoInstance.onDidBlurEditorText((function(){e.monacoInstance&&(e.code=e.monacoInstance.getValue(),e.$emit("input",e.code),e.$emit("focus-change",!1))})),e.loading=!1;case 23:case"end":return t.stop()}}),t)})))()},getParams:function(){var e=this.paramsData.filter((function(e){return e.key}));return Object.fromEntries(e.map((function(e){return[e.key,e.test]})))},handleHeightChange:l.default.throttle((function(e){var t=e.height,a=this.$el.clientHeight+t,n=this.$el.clientWidth;this.monacoInstance.layout({width:n,height:a<244?224:a})}),60)},created:function(){this.initHints()},mounted:function(){var e=this;this.$nextTick((function(){e.init()}))},beforeDestroy:function(){this.dispose()}};t.default=c},ABca:function(e,t,a){"use strict";a.r(t);var n=a("bIxA"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},AZVa:function(e,t,a){"use strict";a.r(t);var n=a("vofx"),i=a("BpXj");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("jwV1");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"5fe7fc76",null);t.default=r.exports},AdRi:function(e,t,a){"use strict";a("GHYn")},AhRJ:function(e,t,a){var n=a("EftP");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("9475b930",n,!0,{})},AilM:function(e,t,a){"use strict";a.r(t);var n=a("hvQ7"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},B27P:function(e,t,a){"use strict";a.r(t);var n=a("6/aR"),i=a("RMti");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("AdRi");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"3d4880f4",null);t.default=r.exports},BHDk:function(e,t,a){var n=a("diF1");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("cd18fd10",n,!0,{})},BHnC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={provide:function(){return{useByCode:!0}},components:{DataSource:a("HuuX").DataSource},props:{},data:function(){return{visible:!1,loading:!1,appendPath:[]}},created:function(){},mounted:function(){},methods:{open:function(){this.visible=!0,this.appendPath=this.$store.state.appendPath},onClose:function(){this.$store.commit("setAppendPath",{data:this.appendPath})}},computed:{},watch:{}};t.default=n},BLds:function(e,t,a){"use strict";a("k5Br")},BpXj:function(e,t,a){"use strict";a.r(t);var n=a("M1bW"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},CFxy:function(e,t,a){var n=a("Zort");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("377ea5e3",n,!0,{})},CQVr:function(e,t,a){"use strict";a.r(t);var n=a("YFlw"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},D0lE:function(e,t,a){var n=a("r8Az");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("483a3ed0",n,!0,{})},DWmU:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"bottom",title:"选择Api",trigger:"click"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[a("el-input",{staticClass:"tree-select-search",attrs:{placeholder:"输入名称筛选",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("n-tree",{ref:"tree",staticClass:"tree-select-popper-content",style:{minWidth:"string"==typeof e.width?e.width:e.width-24+"px"},attrs:{data:e.treeData,"show-checkbox":"","default-expand-all":!0,"default-expanded-keys":e.defaultExpandedKeys,"check-on-click-node":!0,"expand-on-click-node":!0,"node-key":e.nodeKey,"check-strictly":!0,"filter-node-method":e.filterNode,"icon-class":"icon-right",props:e.treeProps,"default-checked-keys":e.defaultSelectedKeys},on:{check:e.handleCheckClick,"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return a("div",{staticClass:"widget-tree-node-name"},[a("img",{staticClass:"widget-tree-node-icon",attrs:{src:e.getIcon(n),alt:""}}),e._v(" "),a("span",[e._v(e._s(n.name))])])}}])}),e._v(" "),e._t("default",null,{slot:"reference"})],2)},i=[]},Dc21:function(e,t,a){var n=a("d2Wf");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("6d8fbac2",n,!0,{})},ECxf:function(e,t,a){"use strict";a("hEKV")},EOaU:function(e,t,a){"use strict";a.r(t);var n=a("ugZR"),i=a("reC4");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("qsS1");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"24a8a6d1",null);t.default=r.exports},EQOX:function(e,t,a){"use strict";a.r(t);var n=a("TepS"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},EUTq:function(e,t,a){"use strict";a.r(t);var n=a("gCWh"),i=a("gEGy");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("wdmC");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"7363c053",null);t.default=r.exports},EftP:function(e,t,a){},Ey78:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("YLtl")),o=n(a("B27P")),s=n(a("PHku")),r={name:"StringFormatter",components:{SourceSelect:o.default},mixins:[s.default],data:function(){return{dialogVisible:!1,currentNode:null,dateFormatOptions:[{label:"YYYY-MM-DD",value:"yyyy-MM-dd"},{label:"YYYY-MM-DD HH:mm",value:"yyyy-MM-dd HH:mm"},{label:"YYYY-MM-DD HH:mm:ss",value:"yyyy-MM-dd HH:mm:ss"},{label:"HH:mm",value:"HH:mm"},{label:"HH:mm:ss",value:"HH:mm:ss"},{label:"时间戳",value:"TIMESTAMP"}]}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(e){var t=e.currentNode;this.currentNode=i.default.cloneDeep(t),this.handleAddAttr(),this.dialogVisible=!0},handleConfirm:function(){var e=!1;switch(this.currentNode.mapperConfig.type){case"TEXT_EXTRACT":if(e=!!this.currentNode.mapperConfig.textExtract.source.name,!this.currentNode.mapperConfig.textExtract.regex)return void this.$message.error("请输入正则表达式");break;case"TEXT_REPLACE":if(e=!!this.currentNode.mapperConfig.textReplace.source.name,!this.currentNode.mapperConfig.textReplace.searchText)return void this.$message.error("请输入文本内容");break;case"TEXT_JOIN":e=!!this.currentNode.mapperConfig.textJoin.joinParams.filter((function(e){return e.value||e.source.name})).length;break;case"TEXT_DATE_FORMAT":if(e=!!this.currentNode.mapperConfig.textDateFormat.source.name,!this.currentNode.mapperConfig.textDateFormat.srcPattern)return void this.$message.error("请选择源格式");if(!this.currentNode.mapperConfig.textDateFormat.destPattern)return void this.$message.error("请选目标格式");break;default:e=!0}e?(this.$emit("confirm",this.currentNode),this.dialogVisible=!1):this.$message.error("请选择参数")},handleAddAttr:function(){this.currentNode.mapperConfig||this.$set(this.currentNode,"mapperConfig",{type:"TEXT_EXTRACT",textExtract:{regex:"",source:{name:""}},textDateFormat:{destPattern:"",source:{name:""},srcPattern:""},textJoin:{joinParams:[],separator:""},textReplace:{regular:!1,replacement:"",searchText:"",source:{name:""}}})},handleSourceChange:function(e){},handleAddTextJoinVar:function(e){this.currentNode.mapperConfig.textJoin.joinParams.push({source:{name:e}})},handleAddTextJoinValue:function(e){e&&this.currentNode.mapperConfig.textJoin.joinParams.push({source:{name:""},value:e})}}};t.default=r},EzBS:function(e,t,a){var n=a("HtwQ");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("e44d1ffc",n,!0,{})},F4BC:function(e,t,a){"use strict";a.r(t);var n=a("m4w2"),i=a("LD2z");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"1f019004",null);t.default=r.exports},Fo4g:function(e,t,a){"use strict";a.r(t);var n=a("xmx0"),i=a("35m7");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("/Iv9");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"0d4d47ea",null);t.default=r.exports},FpxB:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"结构预览",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("vue-json-pretty",{staticClass:"json-pretty",attrs:{data:e.json,virtual:!0,itemHeight:32}})],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)])},i=[]},G6pp:function(e,t,a){"use strict";a("3Z33")},GCzl:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],ref:"dialog",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"API测试日志",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"response-detail",style:{height:e.responseHeight+"px"}},[a("div",{staticClass:"handler",on:{click:e.handleToggleShowResponse}},[e._v("\n        响应体\n        "),a("i",{class:e.isShowResponse?"el-icon-arrow-right":"el-icon-arrow-left"})]),e._v(" "),e.isShowResponse?a("div",{staticClass:"content",class:{show:e.isShowResponse}},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty",style:{height:e.responseHeight-20+"px"},attrs:{data:e.response,virtual:!0,itemHeight:32}}),e._v(" "),e.response?e._e():a("div",{staticStyle:{"text-align":"center",margin:"10px"}},[e._v("暂无数据")])],1):e._e()]),e._v(" "),a("div",{staticClass:"mock-info"},[a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/do-status.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.status))]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("执行状态")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/time.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.time)+" ms")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("总耗时")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/successCount.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.successCount)+"个")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("成功步骤")])])]),e._v(" "),a("div",{staticClass:"info-item"},[a("img",{staticClass:"info-item",attrs:{src:e.$getImgPrefix("/custom-api/failedCount.svg")}}),e._v(" "),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-title"},[e._v(e._s(e.failedCount)+"个")]),e._v(" "),a("div",{staticClass:"info-desc"},[e._v("失败步骤")])])])]),e._v(" "),a("div",{staticClass:"mock-request"},[a("div",{staticClass:"title",on:{click:function(t){e.isShowRequest=!e.isShowRequest}}},[a("span",{staticClass:"t"},[e._v("入参JSON")]),e._v(" "),a("i",{class:e.isShowRequest?"el-icon-arrow-down":"el-icon-arrow-right"})]),e._v(" "),e.isShowRequest?a("div",{staticClass:"mock-request-content"},[a("pre",{staticClass:"json-code"},[e._v(e._s(JSON.stringify(e.apiDetail.requestBody,(function(e,t){return void 0===t?null:t}),2)))])]):e._e()]),e._v(" "),a("div",{staticClass:"mock-detail"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("测试日志")])]),e._v(" "),e.logData?e._l(e.logData.stepDetails,(function(t){return a("div",{key:t.stepInfo.code,staticClass:"step-item"},[a("div",{staticClass:"title",on:{click:function(a){return e.handleChangeStepShow(t)}}},[a("div",{staticClass:"title-left"},[a("i",{staticClass:"title-left-icon",class:t.isShow?"el-icon-arrow-down":"el-icon-arrow-right"}),e._v(" "),a("div",{staticClass:"name"},[e._v(e._s(t.stepInfo.name))])]),e._v(" "),a("div",{staticClass:"step-info"},[a("span",{staticClass:"step-info-item",style:{color:t.executeResult.success?"#5ACD76":"#F66E6E"}},[e._v(e._s(t.executeResult.success?"执行成功":"执行失败"))]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("span",{staticClass:"step-info-item"},[e._v("总耗时："+e._s(t.executeResult.endTime-t.executeResult.beginTime)+"\n                ms")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("span",{staticClass:"step-info-item"},[e._v("成功逻辑："+e._s(t.executeResult.successCount)+" 个")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("span",{staticClass:"step-info-item"},[e._v("失败逻辑："+e._s(t.executeResult.failedCount)+" 个")])],1)]),e._v(" "),t.isShow?a("div",{staticClass:"content"},[a("el-button-group",e._l(t.actionResults,(function(t){return a("el-button",{key:t.actionInfo.code,staticClass:"action-item-btn",class:{success:!!t.executed&&t.executeResult.success,skip:!t.executed,selected:e.selectedAction===t},attrs:{size:"mini"},on:{click:function(a){return e.changeAction(t)}}},[e._v(e._s(t.actionInfo.code)+"："+e._s(t.actionInfo.name))])})),1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"action-item-detail"},[e._l(e.actionLogList,(function(t,n){return[0!==t.detail.indexOf("[JSON_FORMAT]")?a("div",{key:n,staticClass:"log-info-item"},[e._v("\n                  "+e._s(t.detail)+"\n                ")]):a("div",{key:n,staticClass:"log-info-item json"},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.showDetail=!t.showDetail}}},[e._v(e._s(t.showDetail?"收起":"展开"))]),e._v(" "),t.showDetail?a("pre",{staticClass:"json-code"},[e._v(e._s(JSON.stringify(JSON.parse(t.detail.replace("[JSON_FORMAT]","")),(function(e,t){return void 0===t?null:t}),2)))]):e._e()],1)]}))],2),e._v(" "),a("div",{staticClass:"res-detail"},[a("div",{staticClass:"source"},[a("div",{staticClass:"source-title"},[e._v("\n                  源出参\n                ")]),e._v(" "),a("div",{staticClass:"input"},[a("pre",[e._v(e._s(e.sourceMsg))])])]),e._v(" "),a("div",{staticClass:"source"},[a("div",{staticClass:"source-title"},[e._v("\n                  格式化出参\n                ")]),e._v(" "),a("div",{staticClass:"output"},[a("pre",[e._v(e._s(e.formatMsg))])])])])],1):e._e()])})):e._e()],2)]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)])},i=[]},GHYn:function(e,t,a){var n=a("UGbD");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("c969678c",n,!0,{})},GKGU:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("rePB")),r=n(a("IFH0")),l=n(a("EUTq")),c=n(a("zUJO")),u=n(a("Fo4g")),d=n(a("6wtB")),p=n(a("YLtl")),f=n(a("PHku")),v=a("E0s0");a("uD/U");var m=a("0O+R");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b=new v.Factory({virtualLines:20}),y={name:"ActionConfig",components:{Condition:d.default,CustomApiVariableSelect:r.default,ApiAction:c.default,VueJsonPretty:b,LogicList:l.default,SqlAction:u.default},mixins:[f.default],inject:["customApiProvide"],data:function(){return{dialogVisible:!1,loading:!1,actionData:null,response:null,selectedPath:"",stepData:null}},computed:{title:function(){var e;return 1===(null===(e=this.actionData)||void 0===e?void 0:e.type)?"调用API":"调用SQL"}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,a=e.actionData,n=e.stepData;switch(this.stepData=n,this.actionData=a?p.default.cloneDeep(a):{code:(0,m.getRandomHexadecimal)(6),name:"",type:t,condition:{conditionItems:[],enable:!1},config:{db:{dataSourceId:0,params:[{key:"",mockValue:void 0,value:void 0}],sql:"",sqlType:1},http:{body:[{key:"",mockValue:void 0,value:void 0}],headers:[{key:"",mockValue:void 0,value:void 0}],method:"POST",params:[{key:"",mockValue:void 0,value:void 0}],url:"",type:6,dynamicOrigin:void 0,useDynamicOrigin:!1,urlBuildConfig:null}}},this.actionData.type){case 1:this.actionData.config.http=g(g({},this.actionData.config.http),{},{body:this.actionData.config.http.body.length?this.actionData.config.http.body:[{key:"",mockValue:void 0,value:void 0}],headers:this.actionData.config.http.headers.length?this.actionData.config.http.headers:[{key:"",mockValue:void 0,value:void 0}],params:this.actionData.config.http.params.length?this.actionData.config.http.params:[{key:"",mockValue:void 0,value:void 0}]});break;case 2:this.actionData.config.db=g(g({},this.actionData.config.db),{},{params:this.actionData.config.db.params.length?this.actionData.config.db.params:[{key:"",mockValue:void 0,value:void 0}]})}this.response=null,this.dialogVisible=!0},handleConfirm:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var a,n;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.actionData.name){t.next=3;break}return e.$message.error("请输入逻辑名称！"),t.abrupt("return");case 3:t.t0=e.actionData.type,t.next=1===t.t0?6:2===t.t0?11:16;break;case 6:return t.next=8,e.$refs.apiAction.getResult();case 8:return a=t.sent,e.actionData.config.http=a,t.abrupt("break",16);case 11:return t.next=13,e.$refs.sqlAction.getResult();case 13:return n=t.sent,e.actionData.config.db=n,t.abrupt("break",16);case 16:e.$emit("confirm",{actionData:e.actionData}),e.dialogVisible=!1;case 18:case"end":return t.stop()}}),t)})))()},showInputResponseDialog:function(){this.$refs.inputDialog.open({type:"object",data:this,key:"response",from:"response"})},handleEnableChange:function(e){e&&(this.actionData.condition.conditionItems.length||this.actionData.condition.conditionItems.push({items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"},{items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"}))},handleResponse:function(e){var t=e.response;this.response=t},handleLogicChange:function(e){var t=e[0].code,a=this.customApiProvide.apiDetail.steps.map((function(e){return e.actions})).flat(1/0).find((function(e){return e.code===t})),n=p.default.cloneDeep(a);n.code=(0,m.getRandomHexadecimal)(6),this.open({type:n.type,actionData:n,stepData:this.stepData})}}};t.default=y},GRfi:function(e,t,a){"use strict";a.r(t);var n=a("1AIl"),i=a("zx9K");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("nfOR");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"d9c9b6fc",null);t.default=r.exports},GwQN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={provide:function(){return{useByCode:!0}},components:{DataModelList:a("HuuX").DataModelList},props:{},data:function(){return{visible:!1,loading:!1,appendPath:[]}},created:function(){},mounted:function(){},methods:{open:function(){this.visible=!0,this.appendPath=this.$store.state.appendPath},onClose:function(){this.$store.commit("setAppendPath",{data:this.appendPath})}},computed:{},watch:{}};t.default=n},HH6s:function(e,t,a){"use strict";a("VLy3")},HOqx:function(e,t,a){var n=a("SUvN");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("a92fe9d6",n,!0,{})},HtwQ:function(e,t,a){},IFH0:function(e,t,a){"use strict";a.r(t);var n=a("4+nq"),i=a("fOhA");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("G6pp");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"72506bfa",null);t.default=r.exports},Il8n:function(e,t,a){},IsbH:function(e,t,a){"use strict";a("BHDk")},J3wn:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("YLtl")),o=n(a("KAmc")),s=n(a("UeeE")).default.createInstance({id:"id",children:"apis",pid:"parentId"});var r={name:"GroupPanel",props:{defaultSelectId:{type:Number}},data:function(){return{keyword:"",apiGroupList:[],loading:!1}},watch:{defaultSelectId:{handler:function(e,t){var a=this;e?this.$nextTick((function(){var t;null===(t=a.$refs.nodeTree)||void 0===t||t.setCurrentKey(e)})):this.$nextTick((function(){var e;null===(e=a.$refs.nodeTree)||void 0===e||e.setCurrentKey(null)}))},immediate:!0}},methods:{apiSearch:function(e,t){var a=e?s.filter(this.apiGroupList,function(e){return function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}}(e)):this.apiGroupList;t(s.toList(a).filter((function(e){return!e.apis})))},handleSelect:function(e){e.apis||this.$emit("select",i.default.cloneDeep(e))},handleCommand:function(e){this.$emit("create",e)},handleGetApiGroupList:function(){var e=this;return this.loading=!0,this.$http({url:o.default.apiGroupList,data:{appId:+this.$route.query.id}}).then((function(t){e.apiGroupList=t.data,e.$emit("update",e.apiGroupList)})).finally((function(){e.loading=!1}))},handleApiGroupRemoveById:function(e){var t=this;this.loading=!0,this.$http({url:o.default.apiGroupRemove,data:{id:e}}).then((function(e){t.handleGetApiGroupList()})).finally((function(){t.loading=!1}))},handleApiGroup:function(e,t){switch(e){case"delete":this.handleApiGroupRemoveById(t.id);break;case"edit":this.$set(t,"rename",!0)}},getIcon:function(e){return e.apis?this.$getImgPrefix("/design/el-icon-folder-opened.png"):2===e.status?this.$getImgPrefix("/design/edit-page.png"):(e.status,this.$getImgPrefix("/design/el-icon-tickets.png"))},isSelected:function(e){return this.defaultSelectId===e.id},handleRename:function(e,t){var a=this;this.loading=!0,this.$http({url:o.default.apiGroupUpdate,data:{appId:+this.$route.query.id,id:e.id,name:t}}).then((function(t){a.$set(e,"rename",!1),a.handleGetApiGroupList()})).finally((function(){a.loading=!1}))}},created:function(){this.handleGetApiGroupList()}};t.default=r},J6vy:function(e,t,a){var n=a("NNe1");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("1c6bff29",n,!0,{})},JSrl:function(e,t,a){},K3qR:function(e,t,a){"use strict";a("72HB")},KOCq:function(e,t,a){"use strict";a.r(t);var n=a("1fXb"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},Kfku:function(e,t,a){},KtNt:function(e,t,a){"use strict";a("4r5A")},LCmA:function(e,t,a){var n=a("vkiJ");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("65a1db1e",n,!0,{})},LD2z:function(e,t,a){"use strict";a.r(t);var n=a("eNIk"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},LDYN:function(e,t,a){"use strict";a.r(t);var n=a("5ziZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},LLrg:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("KQm4")),r=n(a("slWK")),l=a("cCei"),c=a("a+hW"),u=a("7C5+"),d=a("inkn"),p={name:"PageHistoryManage",inject:(0,s.default)(u.pageInject),data:function(){return{dialogVisible:!1,loading:!1,historyDetail:null,showSaveDialog:!1,pageCount:1,formData:{description:"",createTime:"",user:""}}},methods:{formatTime:c.formatTime,open:function(){this.handleGetHistoryList(),this.dialogVisible=!0},beforeClose:function(e){this.dialogVisible=!1,e()},handleGetHistoryList:function(){var e=this;this.loading=!0;var t=this.getElementPropsById(this.getStore().layoutData.elementId).pageDesignId;this.$http({url:r.default.appDesignPageSnapshotPaging,data:{condition:{pageDesignId:t},pagination:{pagenum:1,pagesize:10*this.pageCount,sort:{name:"",type:""}}}}).then((function(t){var a=t.data;e.historyDetail=a})).finally((function(){e.loading=!1}))},handleDelete:function(e){var t=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确认删除这条快照记录吗？");case 2:t.loading=!0,t.$http({url:r.default.appDesignPageSnapshotRemove,data:{pageSnapshotId:e}}).then((function(e){e.data;t.handleGetHistoryList()})).finally((function(){t.loading=!1}));case 4:case"end":return a.stop()}}),a)})))()},getElementPropsById:function(e){var t="app"===e?this.getStore().layoutData.elementId:e;return this.getStore().dynamicProps[t]||{}},handleSave:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formData.description){t.next=3;break}return e.$message.error("请输入快照描述！"),t.abrupt("return");case 3:return t.next=5,e._storeDispatch(l.SAVE_PAGE_CONFIG,{isToast:!1});case 5:e.handleSaveHistory();case 6:case"end":return t.stop()}}),t)})))()},handleSaveHistory:function(){var e=this;this.loading=!0;var t=this.getElementPropsById(this.getStore().layoutData.elementId).pageDesignId;return this.$http({url:r.default.appDesignPageSnapshotSave,data:{pageDesignId:t,description:this.formData.description}}).then((function(t){t.data;e.handleGetHistoryList(),e.showSaveDialog=!1})).finally((function(){e.loading=!1}))},beforeSaveClose:function(e){this.showSaveDialog=!1,e()},handleSaveClick:function(){var e=window.rootStore.state.loginKey||{};this.formData={description:"",createTime:(0,c.formatTime)(),user:e.account},this.showSaveDialog=!0},handleGetHistoryConfigById:function(e){var t=this;this.loading=!0,this.$http({url:r.default.appDesignPageSnapshotRevertToSnapshot,data:{pageSnapshotId:e}}).then((function(e){e.data;t.getPageConfig()})).finally((function(){t.loading=!1}))},handleSelectHistory:function(e){var t=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.$confirm("恢复快照记录将会覆盖当前页面的所有配置项且不可回退，是否将当前页面配置进行快照备份","快照恢复提示",{type:"info",cancelButtonText:"暂不保存",confirmButtonText:"保存备份",closeOnClickModal:!1,closeOnPressEscape:!1,showClose:!1}).then((0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.formData.description="该备份为最新的一次快照备份记录",a.next=3,t.handleSaveHistory();case 3:t.handleGetHistoryConfigById(e.id);case 4:case"end":return a.stop()}}),a)})))).catch((function(){t.handleGetHistoryConfigById(e.id)}));case 1:case"end":return a.stop()}}),a)})))()},getPageConfig:function(){var e=this,t=this.$loading({lock:!0,text:"正在请求页面配置"});setTimeout((function(){var a=e.getStore().layoutData.elementId,n=e.getElementPropsById(a).pageDesignId;e._storeDispatch(l.UPDATE_PAGE_CONFIG,{elementId:a,pageDesignId:n,appDesignId:e.$route.query.vid}).then((function(){e.$message.success("恢复快照成功！"),(0,d.reset)(),e.dialogVisible=!1})).finally((function(){t.close()}))}),100)},handleShowMore:function(){this.pageCount++,this.handleGetHistoryList()}}};t.default=p},Lxu4:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"groovy-code"},[a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],ref:"codeEditor",staticClass:"highlight-code"}),e._v(" "),e.resizable?a("ChangeHeight",{on:{heightChange:e.handleHeightChange}}):e._e()],1)},i=[]},M1bW:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("i7/w")),r=n(a("IFH0")),l=n(a("wxxj")),c=n(a("aAb1")),u=n(a("wFyv")),d=n(a("rJQu")),p=n(a("EOaU")),f=n(a("KAmc")),v=a("0O+R"),m=a("8SHQ"),h=n(a("UeeE")).default.createInstance({id:"id",children:"apis",pid:"parentId"});s.default.component("CustomApiVariableSelect",r.default),s.default.component("MacroVariableSelect",l.default),s.default.component("CustomInputDialog",c.default),s.default.component("JsonTree",u.default);var g={name:"CustomApi",components:{GroupPanel:d.default,ApiItem:p.default},data:function(){return{loading:!1,dialogVisible:!1,selectedApi:null,apiGroupList:[]}},computed:{defaultSelectId:function(){var e;return null===(e=this.selectedApi)||void 0===e?void 0:e.id}},methods:{open:function(){var e=this;this.dialogVisible=!0,this.$nextTick((function(){e.handleRefresh()}))},handleClose:function(e){window[m.CUSTOM_API_RESPONSE_MAP]={},this.dialogVisible=!1,e()},handleCreate:function(e){switch(e){case"api":this.selectedApi={id:null,appId:+this.$route.query.id,description:"",groupId:void 0,name:"",path:"",requestBody:{},status:void 0,steps:[],useScript:!1,scriptConfig:{scriptType:"GROOVY",script:""}};break;case"group":this.handleAddGroup()}},handleUpdate:function(){this.$refs.groupPanel.handleGetApiGroupList()},handleRefresh:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.groupPanel.handleGetApiGroupList();case 2:e.selectedApi=e.selectedApi&&h.toList(e.apiGroupList).find((function(t){return t.id===e.selectedApi.id}))||null;case 3:case"end":return t.stop()}}),t)})))()},handleAddGroup:function(){var e=this;this.loading=!0,this.$http({url:f.default.apiGroupSave,data:{appId:+this.$route.query.id,name:"新增分组".concat(this.apiGroupList.length+1)}}).then((function(t){e.$refs.groupPanel.handleGetApiGroupList()})).finally((function(){e.loading=!1}))}},created:function(){window[m.CUSTOM_API_SESSION_ID]||(window[m.CUSTOM_API_SESSION_ID]=(0,v.getRandomHexadecimal)(12)),window[m.CUSTOM_API_RESPONSE_MAP]||(window[m.CUSTOM_API_RESPONSE_MAP]={})}};t.default=g},MhPV:function(e,t,a){"use strict";a.r(t);var n=a("GwQN"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},MqYS:function(e,t,a){"use strict";a.r(t);var n=a("J3wn"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},NH8S:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"page-header"},[a("div",{staticClass:"header-left"},[a("div",{staticClass:"back",on:{click:e.goBack}},[a("i",{staticClass:"el-icon-back"}),e._v(" "),a("el-button",{attrs:{type:"text"}},[e._v("返回")])],1),e._v(" "),a("span",{staticClass:"app-name"},[e._v(e._s(e.info.appName))]),e._v(" "),a("el-tag",{staticClass:"version-tag"},[e._v(e._s(e.info.version))]),e._v(" "),e.statusMap[e.info.status]?a("el-tag",{staticClass:"version-tag",attrs:{effect:"plain",type:e.statusMap[e.info.status].type}},[e._v(e._s(e.statusMap[e.info.status].name))]):e._e()],1),e._v(" "),a("div",{staticClass:"flex-full"}),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"text"},on:{click:e.showKeyTip}},[e._v("快捷键")]),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini",type:"primary"},on:{click:e.handleOpenApi}},[e._v("自定义API")]),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(){return e.$refs.dataSource.open()}}},[e._v("数据源")]),e._v(" "),a("div",{staticClass:"header-right"},[a("el-tooltip",{attrs:{effect:"dark",content:"后退（ctrl + z）",placement:"top"}},[a("n-badge",{attrs:{value:e.redoLength,hidden:0===e.redoLength}},[a("el-button",{attrs:{type:"icon",disabled:0===e.redoLength},on:{click:e.handleGoBack}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/edit-back.svg"),alt:""}})])],1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"前进（ctrl + shift + z）",placement:"top"}},[a("n-badge",{attrs:{value:e.undoLength,hidden:0===e.undoLength}},[a("el-button",{attrs:{type:"icon",disabled:0===e.undoLength},on:{click:e.handleGoForward}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/edit-goforward.svg"),alt:""}})])],1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"快照记录",placement:"top"}},[a("el-button",{attrs:{type:"icon"},on:{click:e.handleShowHistory}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/history.svg"),alt:""}})])],1),e._v(" "),a("el-dropdown",{attrs:{"hide-on-click":!0,trigger:"click"},on:{command:e.handleMoreClick}},[a("el-button",{attrs:{type:"icon"}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/edit-more.svg"),alt:""}})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"app"}},[e._v("应用变量管理")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"dataset"}},[e._v("数据集管理")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"events"}},[e._v("事件管理")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"source"}},[e._v("资源管理")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"settings"}},[e._v("应用设置")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"dataModel"}},[e._v("数据模型")])],1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"保存（ctrl + s）",placement:"top"}},[a("el-button",{ref:"saveBtn",attrs:{type:"icon"},on:{click:e.handleSave}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/edit-save.svg"),alt:""}})])],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"预览（ctrl + p）",placement:"top"}},[a("el-button",{attrs:{type:"icon"},on:{click:e.openPreview}},[a("img",{attrs:{src:e.$getImgPrefix("/design/svg/edit-preview.svg"),alt:""}})])],1)],1),e._v(" "),a("data-model",{ref:"dataModel"}),e._v(" "),a("data-source",{ref:"dataSource"}),e._v(" "),a("app-variables",{ref:"appVariables"}),e._v(" "),a("data-set-manage",{ref:"dataSetManage"}),e._v(" "),a("key-tip",{ref:"keyTip"}),e._v(" "),a("custom-api",{ref:"customApi"}),e._v(" "),a("event-select",{ref:"eventSelect"}),e._v(" "),a("SourceManage",{ref:"sourceManage"}),e._v(" "),a("PageHistoryManage",{ref:"pageHistoryManage"}),e._v(" "),a("settingsManage",{ref:"settingsManage"})],1)},i=[]},NNe1:function(e,t,a){},"NbR/":function(e,t,a){},NbdW:function(e,t,a){var n=a("nl3a");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("ecfcd6ce",n,!0,{})},Nu7Z:function(e,t,a){"use strict";a.r(t);var n=a("gYbz"),i=a("hX/p");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("+AbH");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"d29303a8",null);t.default=r.exports},Nxdt:function(e,t,a){"use strict";a.r(t);var n=a("pAkb"),i=a("MhPV");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("z7BS");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"0003bc81",null);t.default=r.exports},O3Zp:function(e,t,a){"use strict";a.r(t);var n=a("yURZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},OPx6:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("ODXe")),o=n(a("rePB")),s=n(a("PHku")),r=n(a("YLtl")),l=a("a+hW"),c=a("8SHQ"),u=a("7Qib"),d={name:"ObjectFormatter",mixins:[s.default],data:function(){return{dialogVisible:!1,stepData:null,rootNode:null,currentNode:null,nodeList:[]}},computed:{title:function(){var e;return"Array"===(null===(e=this.currentNode)||void 0===e?void 0:e.type)?"数组格式化":"对象格式化"}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},handleAddAttr:function(){this.currentNode.children||("Array"===this.currentNode.type?this.$set(this.currentNode,"children",[{key:"0",type:"String"}]):this.$set(this.currentNode,"children",[{key:"",type:"String"}]));var e="Object"===this.currentNode.type?"objectMap":"arrayMap";this.currentNode.mapperConfig||this.$set(this.currentNode,"mapperConfig",(0,o.default)({type:"Object"===this.currentNode.type?"OBJECT_MAP":"ARRAY_MAP"},e,{source:{name:""}}))},open:function(e){var t=e.stepData,a=e.rootNode;this.stepData=t,this.rootNode=a,this.currentNode=r.default.cloneDeep(a),this.handleAddAttr(),this.nodeList=[this.currentNode],this.dialogVisible=!0},handleAddLevel:function(e){this.currentNode=e,this.handleAddAttr(),this.nodeList.push(this.currentNode)},handleChangeLevel:function(e,t){this.currentNode=e,this.nodeList.splice(t+1,this.nodeList.length-t)},handleConfirm:function(){var e=r.default.cloneDeep(this.nodeList[0]);this.$emit("confirm",e),this.dialogVisible=!1},handleBuildAttr:function(e){var t,a=(0,l.getPathList)(e);switch(a[0]){case"$global":t=this.customApiProvide.apiDetail.requestBody;break;case"$".concat(this.stepData.code):t=window[c.CUSTOM_API_RESPONSE_MAP]["".concat(this.stepData.code,"_source")];break;default:t=window[c.CUSTOM_API_RESPONSE_MAP][this.stepData.code]}var n=r.default.get(t,a.slice(1));if(!Array.isArray(n))return this.$message.error("数据源必须为数组！"),void(this.currentNode.mapperConfig.arrayMap.source.name="");if(r.default.isObject(n[0])){var o=Object.entries(n[0]).map((function(t){var a=(0,i.default)(t,2),n=a[0],o=a[1];return{key:n,type:(0,u.getMapType)(o),reference:{name:"".concat(e,"[0].").concat(n)}}}));this.$set(this.currentNode.children,0,{key:"0",type:Array.isArray(n[0])?"Array":"Object",children:o.length?o:[{key:"",type:"String"}]})}else this.$set(this.currentNode.children,0,{key:"0",type:(0,u.getMapType)(n[0])});this.$set(this.currentNode.mapperConfig.arrayMap.source,"name",e),this.$forceUpdate()}}};t.default=d},OVJj:function(e,t,a){var n=a("sV6C");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("1bdaa0a2",n,!0,{})},OeHT:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("YLtl")),o=n(a("B27P")),s=n(a("6wtB")),r=n(a("PHku")),l=[{items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"},{items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"}],c={name:"StringFormatter",components:{SourceSelect:o.default,Condition:s.default},mixins:[r.default],data:function(){return{dialogVisible:!1,currentNode:null,functionOptions:[{label:"求平均值",value:"AVG"},{label:"取最大值",value:"MAX"},{label:"取最小值",value:"MIN"},{label:"求和",value:"SUM"},{label:"取总数",value:"SIZE"}]}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(e){var t=e.currentNode;this.currentNode=i.default.cloneDeep(t),this.handleAddAttr(),this.dialogVisible=!0},handleConfirm:function(){var e=!1;switch(this.currentNode.mapperConfig.type){case"NUMBER_COUNT":e=!!this.currentNode.mapperConfig.numberCount.source.name;break;case"NUMBER_CALCULATE":if(e=!!this.currentNode.mapperConfig.numberCalculate.items.filter((function(e){return e.source.name})).length,!this.currentNode.mapperConfig.numberCalculate.formula)return void this.$message.error("请输入公式");break;case"DECIMAL_POINT_FORMAT":e=!!this.currentNode.mapperConfig.decimalPointFormat.source.name;break;default:e=!0}e?(this.$emit("confirm",this.currentNode),this.dialogVisible=!1):this.$message.error("请选择参数")},handleAddAttr:function(){this.currentNode.mapperConfig||this.$set(this.currentNode,"mapperConfig",{type:"NUMBER_COUNT",decimalPointFormat:{pointNumber:0,source:{name:""}},numberCalculate:{pointNumber:0,formula:"",items:[{description:"",name:"A",source:{name:""}}]},numberCount:{filter:{enable:!1,conditionItems:i.default.cloneDeep(l)},function:"AVG",pointNumber:0,source:{name:""}}})},handleSourceChange:function(e){},handleAddItem:function(){this.currentNode.mapperConfig.numberCalculate.items.push({name:"",description:"",source:{name:""}})},handleDeleteItem:function(e){var t=this.currentNode.mapperConfig.numberCalculate.items;if(1===t.length)return t[0].name="",t[0].description="",void(t[0].source.name="");t.splice(e,1)},getTagErrorType:function(e){return"参数不合法，请重新选择"===this.getElementName(e.source.name,!0)?"danger":""}}};t.default=c},PAdJ:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("rePB")),s=n(a("HaE+")),r=n(a("ODXe")),l=n(a("Ze3F")),c=n(a("c7JL")),u=a("xBdn"),d=n(a("PHku")),p=n(a("KAmc")),f=n(a("slWK")),v=a("8SHQ"),m=n(a("YLtl")),h=a("fZI4"),g=a("7Qib");function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _="使用“#{参数名}”格式进行参数取值（系统自动进行非空判断），示例SQL：<br>\n  select id,name,age,sex,create_time from user <br>\n  where id=#{id} and name=#{name} and age=#age",C="使用freemarker模板语法进行参数非空判断和取值，示例SQL：<br>\n  select id,name,age,sex,create_time from user <br>\n  where 1=1 <br>\n  <#if id??> and id=${id}</#if> <br>\n  <#if id??> and name='${name}'</#if> <br>\n  <#if id??> and age=${age}</#if>",w={name:"SqlAction",components:{SqlCode:c.default,SqlDataSelect:l.default},mixins:[d.default],props:{actionData:{type:Object},stepData:{type:Object}},data:function(){return{sqlTemplate1:_,sqlTemplate2:C,loading:!1,sqlRequest:null,activeCollapse:["config"],rules:{sql:(0,u.getValidators)([{message:"请输入SQL",include:u.required,trigger:"change"}])},editorFocus:!1}},computed:{sqlTemplate:function(){return this.sqlRequest.sql||this.editorFocus?"":1===this.sqlRequest.sqlType?_:C},params:function(){return this.sqlRequest.params},dynamicHints:function(){return this.params.map((function(e){return"#{".concat(e.key,"}")}))},paramsSource:{get:function(){return{params:Object.fromEntries(this.sqlRequest.params.map((function(e){return[[e.key],e.value]})))}},set:function(e){var t=this.customApiProvide.apiDetail.steps.map((function(e){return e.code}));this.sqlRequest.params=Object.entries(e).map((function(e){var a=(0,r.default)(e,2),n=a[0],i=a[1];return{key:n,value:i,mockValue:(0,g.isValidateParams)(i,t)?void 0:JSON.parse(JSON.stringify(void 0===i?null:i,(function(e,a){return(0,g.isValidateParams)(a,t)?null:a})))}}))}}},watch:{actionData:{handler:function(e,t){m.default.isEqual(e,t)||(this.sqlRequest=m.default.cloneDeep(e.config.db),this.sqlRequest.sql=(0,h.decryptByDES)(this.sqlRequest.sql),this.handleGetDataSetDetail())},deep:!0,immediate:!0}},methods:{focusChange:function(e){this.editorFocus=e},handleShowVariableSelect:function(e,t,a){this.variableRowDetail={row:e,key:t,cb:a},this.$refs.variableSelect.open({fullVariable:e[t],callbackId:this.callbackId})},handleVariableConfirm:function(e){var t=this.variableRowDetail,a=t.row,n=t.key,i=t.cb;n&&this.$set(a,n,e),null==i||i(e)},handleAddParams:function(){this.sqlRequest.params.push({key:"",value:void 0,mockValue:void 0})},handleDeleteParams:function(e){var t=this.sqlRequest.params;if(1===t.length)return t[0].key="",t[0].value=void 0,void(t[0].mockValue=void 0);t.splice(e,1)},handleShowSqlDataSelect:function(){this.$refs.sqlDataSelect.open()},handleSqlDataConfirm:function(e){this.$set(this.sqlRequest,"sqlData",e),this.sqlRequest.dataSourceId=e.id},handleMock:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getResult();case 2:delete(a=t.sent).sqlData,e.$emit("response",{response:null}),e.loading=!0,e.$http({url:p.default.apiDesignMockRunAction,data:{appId:Number(e.$route.query.id),sessionId:window[v.CUSTOM_API_SESSION_ID],stepCode:e.actionData.code,action:y(y({},e.actionData),{},{config:y(y({},e.actionData.config),{},{http:null,db:a})}),requestBody:e.customApiProvide.apiDetail.requestBody}}).then((function(t){e.$emit("response",{response:t.data})})).finally((function(){e.loading=!1}));case 7:case"end":return t.stop()}}),t)})))()},getResult:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.sqlRequest.validate();case 2:if(e.sqlRequest.dataSourceId){t.next=5;break}return e.$message.error("请选择数据源"),t.abrupt("return",Promise.reject("请选择数据源"));case 5:return a=y(y({},e.sqlRequest),{},{params:e.sqlRequest.params.filter((function(e){return e.key})),sql:(0,h.encryptByDES)(e.sqlRequest.sql)}),t.abrupt("return",Promise.resolve(a));case 7:case"end":return t.stop()}}),t)})))()},handleGetDataSetDetail:function(){var e=this;this.sqlRequest.dataSourceId&&(this.loading=!0,this.$http({url:f.default.sqlDataSourceDetailById,data:{id:this.sqlRequest.dataSourceId}}).then((function(t){e.sqlRequest.sqlData=t.data})).finally((function(){e.loading=!1})))}}};t.default=w},PCZw:function(e,t,a){"use strict";a("Dc21")},PHku:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("U8pU")),o=a("7Qib"),s=a("a+hW"),r={inject:["customApiProvide","stepProvide"],data:function(){return{variableRowDetail:null}},methods:{formatTip:o.formatTip,formatTag:o.formatTag,isValidateVariableParams:function(e){var t=this.customApiProvide.apiDetail.steps.map((function(e){return e.code}));return(0,o.isValidateParams)(e,t)},handleTagClick:function(e,t){var a=e[t];if("string"==typeof a)return!["test","mockValue"].includes(t)&&this.isValidateVariableParams(a)?0===a.indexOf("$macroVariables")?void this.handleShowMacroVariableSelect(e,t):void this.handleShowVariableSelect(e,t):void this.showInputDialog("text",e,t);!a||"object"!==(0,i.default)(a)||a instanceof File?"number"!=typeof a||this.showInputDialog("number",e,t):this.showInputDialog("object",e,t)},showInputDialog:function(e,t,a,n){this.$refs.inputDialog.open({type:e,data:t,key:a,from:n})},handleUpdateValue:function(e,t){t&&(this[t]=e)},getElementName:function(e,t){var a=this;if("string"!=typeof e)return(0,o.formatTip)(e);var n=(0,s.getPathList)(e)[0],i=this.customApiProvide.apiDetail.steps.map((function(e){return e.code}));if(this.isValidateVariableParams(n)){if("$global"===n)return"API请求出参";if("$macroVariables"===n)return"宏变量";var r=i.findIndex((function(e){var t,n;return e===(null===(t=a.stepProvide)||void 0===t||null===(n=t.stepData)||void 0===n?void 0:n.code)}));if((t||this.showSelf?i.slice(r+1):i.slice(r)).includes(n.slice(1)))return"参数不合法，请重新选择";var l=this.customApiProvide.apiDetail.steps.find((function(e){return"$".concat(e.code)===n}));return l?l.name||"未命名步骤":(0,o.formatTip)(e)}return(0,o.formatTip)(e)},getTagType:function(e,t){return"参数不合法，请重新选择"===this.getElementName(e,t||this.showSelf)?"danger":""},handleShowVariableSelect:function(e,t,a){var n,i;this.variableRowDetail={row:e,key:t,cb:a},this.$refs.variableSelect.open({fullVariable:e[t],stepCode:null===(n=this.stepProvide)||void 0===n||null===(i=n.stepData)||void 0===i?void 0:i.code})},handleVariableConfirm:function(e){var t=this.variableRowDetail,a=t.row,n=t.key,i=t.cb;n&&this.$set(a,n,e),null==i||i(e)},handleShowMacroVariableSelect:function(e,t){this.variableRowDetail={row:e,key:t},this.$refs.macroVariableSelect.open({fullVariable:e[t],isManage:!1})}}};t.default=r},"PJp+":function(e,t,a){},Pw7p:function(e,t,a){"use strict";a("VPoD")},PwvG:function(e,t,a){"use strict";a("wKF/")},"Q+Qv":function(e,t,a){"use strict";a.r(t);var n=a("spK8"),i=a("CQVr");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("nHGG");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"13e0f338",null);t.default=r.exports},Qn9X:function(e,t,a){"use strict";a.r(t);var n=a("83Fj"),i=a("cqvt");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("gCY9");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"deb7d5cc",null);t.default=r.exports},R2Z8:function(e,t,a){"use strict";a.r(t);var n=a("+Xtg"),i=a("ZUwS");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("BLds");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"2df36d73",null);t.default=r.exports},RD0S:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"文本格式化",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("n-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleChangeType},model:{value:e.currentNode.mapperConfig.type,callback:function(t){e.$set(e.currentNode.mapperConfig,"type",t)},expression:"currentNode.mapperConfig.type"}},[a("n-tab-pane",{attrs:{label:"正则提取",name:"TEXT_EXTRACT"}},[a("SourceSelect",{attrs:{source:e.currentNode.mapperConfig.textExtract.source},on:{change:e.handleSourceChange}}),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("正则表达式：")]),e._v(" "),a("el-input",{staticClass:"input",attrs:{placeholder:"请输入正则表达式"},model:{value:e.currentNode.mapperConfig.textExtract.regex,callback:function(t){e.$set(e.currentNode.mapperConfig.textExtract,"regex",t)},expression:"currentNode.mapperConfig.textExtract.regex"}})],1)],1),e._v(" "),a("n-tab-pane",{attrs:{label:"文本替换",name:"TEXT_REPLACE"}},[a("SourceSelect",{attrs:{source:e.currentNode.mapperConfig.textReplace.source},on:{change:e.handleSourceChange}}),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("文本内容：")]),e._v(" "),a("el-input",{staticClass:"input",attrs:{placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.textReplace.searchText,callback:function(t){e.$set(e.currentNode.mapperConfig.textReplace,"searchText",t)},expression:"currentNode.mapperConfig.textReplace.searchText"}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"10px"},model:{value:e.currentNode.mapperConfig.textReplace.regular,callback:function(t){e.$set(e.currentNode.mapperConfig.textReplace,"regular",t)},expression:"currentNode.mapperConfig.textReplace.regular"}},[e._v("正则表达式")])],1),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("替换为：")]),e._v(" "),a("el-input",{staticClass:"input",attrs:{placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.textReplace.replacement,callback:function(t){e.$set(e.currentNode.mapperConfig.textReplace,"replacement",t)},expression:"currentNode.mapperConfig.textReplace.replacement"}})],1)],1),e._v(" "),a("n-tab-pane",{attrs:{label:"文本合并",name:"TEXT_JOIN"}},[a("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px"}},[a("div",{staticClass:"label",staticStyle:{width:"100px"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("文本类型：\n          ")]),e._v(" "),a("SourceSelect",{attrs:{showLabel:!1,title:"选择参数",source:{name:""}},on:{change:e.handleAddTextJoinVar}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInputDialog("text",{value:""},"value")}}},[e._v("选择常量\n          ")])],1),e._v(" "),a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"label",staticStyle:{width:"100px","padding-left":"5px"}},[e._v("\n            文本内容：\n          ")]),e._v(" "),a("div",{staticClass:"select-list"},e._l(e.currentNode.mapperConfig.textJoin.joinParams,(function(t,n){return a("el-tag",{key:n,attrs:{closable:""},on:{close:function(t){return e.currentNode.mapperConfig.textJoin.joinParams.splice(n,1)}}},[e._v(e._s(t.value||t.source.name))])})),1)]),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("\n            分隔符：\n            "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"left"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("合并后参数之间展示的间隔符号，不填则默认没有间隔符")]),e._v(" "),a("i",{staticClass:"el-icon-question test-btn tooltip"})])],1),e._v(" "),a("el-input",{staticClass:"input",attrs:{placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.textJoin.separator,callback:function(t){e.$set(e.currentNode.mapperConfig.textJoin,"separator",t)},expression:"currentNode.mapperConfig.textJoin.separator"}})],1)]),e._v(" "),a("n-tab-pane",{attrs:{label:"日期转换",name:"TEXT_DATE_FORMAT"}},[a("SourceSelect",{attrs:{source:e.currentNode.mapperConfig.textDateFormat.source},on:{change:e.handleSourceChange}}),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("源格式：")]),e._v(" "),a("el-select",{attrs:{size:"mini"},model:{value:e.currentNode.mapperConfig.textDateFormat.srcPattern,callback:function(t){e.$set(e.currentNode.mapperConfig.textDateFormat,"srcPattern",t)},expression:"currentNode.mapperConfig.textDateFormat.srcPattern"}},e._l(e.dateFormatOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("目标格式：")]),e._v(" "),a("el-select",{attrs:{size:"mini"},model:{value:e.currentNode.mapperConfig.textDateFormat.destPattern,callback:function(t){e.$set(e.currentNode.mapperConfig.textDateFormat,"destPattern",t)},expression:"currentNode.mapperConfig.textDateFormat.destPattern"}},e._l(e.dateFormatOptions.slice(0,-1),(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleAddTextJoinValue}})],1)},i=[]},RMti:function(e,t,a){"use strict";a.r(t);var n=a("WtFg"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},Rv1O:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("YLtl")),o=n(a("UeeE")),s=a("8SHQ"),r=a("E0s0");a("uD/U");var l=a("a+hW"),c=new r.Factory({virtualLines:50}),u=o.default.createInstance({id:"key",children:"children",pid:"parentId"}),d={name:"JsonView",components:{VueJsonPretty:c},inject:["customApiProvide"],props:{stepData:{type:Object}},data:function(){return{dialogVisible:!1,json:{}}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(e){var t=this,a=e.treeData,n=u.filter(a,(function(e){return e.mapperConfig||e.reference}));this.json=function e(a,n){var o=n?[]:{};return a.forEach((function(a){if(a.mapperConfig)switch(a.type){case"String":o[a.key]="";break;case"Number":o[a.key]=0;break;case"Boolean":o[a.key]=!1;break;case"Object":o[a.key]=e(a.children);break;case"Array":o[a.key]=e(a.children,!0);break;case"Null":case"Undefined":o[a.key]=null}else{var n,r=(0,l.getPathList)(a.reference.name);switch(r[0]){case"$global":n=t.customApiProvide.apiDetail.requestBody;break;case"$".concat(t.stepData.code):n=window[s.CUSTOM_API_RESPONSE_MAP]["".concat(t.stepData.code,"_source")];break;default:n=window[s.CUSTOM_API_RESPONSE_MAP][t.stepData.code]}o[a.key]=i.default.get(n,r.slice(1))}})),o}(n),this.dialogVisible=!0}}};t.default=d},SPUz:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("rePB")),r=n(a("YLtl"));function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"ApiList",inject:["customApiProvide"],props:{tree:{type:Array},defaultSelectedKeys:{type:Array,default:function(){return[]}},nodeKey:{type:String,default:"code"},treeProps:{type:Object,default:function(){return{children:"apis",label:"name",disabled:function(e,t){return e.disabled}}}},width:{type:[String,Number],default:"380px"}},data:function(){return{popoverVisible:!1,filterText:"",selectedNodes:[],defaultExpandedKeys:[]}},computed:{treeData:function(){if(this.tree)return this.tree.map((function(e){return c(c({},e),{},{disabled:!0})}))}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t[this.treeProps.label].indexOf(e)},handleCheckClick:function(e,t,a){this.$refs.tree.setCheckedKeys([e[this.nodeKey]])},handleCheckChange:r.default.debounce((0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("选择的配置将覆盖当前配置，是否继续？","提示");case 2:t=this.$refs.tree.getCheckedNodes(),this.$emit("change",t);case 4:case"end":return e.stop()}}),e,this)}))),100),getIcon:function(e){return e.apis?this.$getImgPrefix("/design/el-icon-folder-opened.png"):this.$getImgPrefix("/design/el-icon-tickets.png")}}};t.default=u},SUvN:function(e,t,a){},SjY5:function(e,t,a){},T4dZ:function(e,t,a){"use strict";a.r(t);var n=a("RD0S"),i=a("VGvL");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("mpsT");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"c0367a60",null);t.default=r.exports},TRM7:function(e,t,a){},TepS:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("rePB")),s=n(a("HaE+")),r=n(a("YLtl")),l=n(a("pKu3")),c=n(a("E0s0"));a("uD/U");var u=n(a("slWK")),d=a("xBdn");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={name:"DataSetDialog",components:{DataSetConfig:l.default,VueJsonPretty:c.default},data:function(){return{dialogVisible:!1,loading:!1,apiRequest:void 0,sqlRequest:void 0,staticData:void 0,response:null,activeDataType:"api",activeCollapse:["response"],detail:null,rules:{name:(0,d.getValidators)([{message:"请输入名称",include:d.required,trigger:"change",required:!0}]),description:(0,d.getValidators)([{message:"请输入描述信息",include:d.required,trigger:"change",required:!0}])}}},methods:{open:function(e){this.detail=r.default.cloneDeep(e);var t=JSON.parse(e.config),a=t.apiRequest,n=t.sqlRequest,i=t.staticData;this.staticData=r.default.cloneDeep(i)||void 0,this.apiRequest=r.default.cloneDeep(a)||void 0,this.sqlRequest=r.default.cloneDeep(n)||void 0,this.response=null,this.dialogVisible=!0},handleClose:function(e){this.dialogVisible=!1,e()},confirm:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a,n,o,s,r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.dataForm.validate();case 2:a=e.$refs.dataSetConfig.getResult(),n=a.apiRequest,o=a.sqlRequest,s=a.staticData,e.apiRequest=n,e.sqlRequest=o,e.staticData=s,r=JSON.stringify({apiRequest:n,sqlRequest:o,staticData:s}),e.handleUpdate(r);case 8:case"end":return t.stop()}}),t)})))()},handleResponse:function(e){var t=e.response,a=e.responseOptions;this.response=t,this.responseOptions=a},handleUpdate:function(e){var t=this;this.loading=!0,this.$http({url:u.default.datasetManageUpdate,data:f(f({},this.detail),{},{config:e})}).then((function(e){e.data;t.$message.success("保存成功！"),t.$emit("refresh"),t.dialogVisible=!1})).finally((function(){t.loading=!1}))}}};t.default=v},Ttgw:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!0,"modal-append-to-body":!0,"append-to-body":!0,title:"快捷键",visible:e.dialogVisible,width:"836px",top:"10vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"ve-popup-content"},[a("div",{staticClass:"ve-shortcuts-control ve-shortcuts-control-col",staticStyle:{width:"780px",height:"380px"}},[a("div",{staticClass:"shortcuts-content-item",staticStyle:{width:"370px"}},[a("div",{staticClass:"item-title"},[a("div",{staticClass:"item-title-wrap"},[e._v("常规操作"),a("span",[e._v(" ")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("常规快捷键仅在页面编辑中生效，弹窗中不支持使用快捷键。")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)]),e._v(" "),a("div"),e._v(" "),a("div",{staticClass:"item-content",staticStyle:{height:"auto"}},[a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("保存")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("S")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("预览")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("P")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("后退")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("Z")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("前进")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("Shift")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("Z")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("复制组件")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("C")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("粘贴组件")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("V")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("剪切组件")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("ctrl")]),e._v(" "),a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("X")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("删除组件")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("Delete")])])])])]),e._v(" "),a("div",{staticClass:"shortcuts-content-item",staticStyle:{width:"370px"}},[a("div",{staticClass:"item-title"},[a("div",{staticClass:"item-title-wrap"},[e._v("\n              组件选择和移动"),a("span",[e._v(" ")])])]),e._v(" "),a("div"),e._v(" "),a("div",{staticClass:"item-content",staticStyle:{height:"auto"}},[a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("选择父节点")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("↑")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("选择子节点")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("↓")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("向右选择兄弟节点")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("→")])])]),e._v(" "),a("div",{staticClass:"item-li"},[a("div",{staticClass:"item-li-left"},[e._v("向左选择兄弟节点")]),e._v(" "),a("div",{staticClass:"item-li-right"},[a("div",{staticClass:"li-btn",attrs:{"data-btn":"btn"}},[e._v("←")])])])])])])])])])},i=[]},TzBK:function(e,t,a){var n=a("dZZJ");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("7279804e",n,!0,{})},UGbD:function(e,t,a){},UTqS:function(e,t,a){"use strict";a.r(t);var n=a("ZUMZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},UqOf:function(e,t,a){var n=a("vsCC");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("c1be3354",n,!0,{})},"Ut2/":function(e,t,a){"use strict";a.r(t);var n=a("mC5a"),i=a("kyEg");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("XwKj");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"58392153",null);t.default=r.exports},V8Qa:function(e,t,a){"use strict";a.r(t);var n=a("dM/z"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},VGvL:function(e,t,a){"use strict";a.r(t);var n=a("Ey78"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},VLy3:function(e,t,a){var n=a("5nuN");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("94bf0840",n,!0,{})},VPoD:function(e,t,a){var n=a("Z8+y");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("5cf89a52",n,!0,{})},WOyx:function(e,t,a){"use strict";a.r(t);var n=a("zz4O"),i=a("9Ti4");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("6cMV");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"408b0deb",null);t.default=r.exports},WTgn:function(e,t,a){"use strict";a("LCmA")},WtFg:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"SourceSelect",mixins:[n(a("PHku")).default],props:{source:{type:Object},showLabel:{type:Boolean,default:!0},title:{type:String,default:"选择"}},methods:{handleBuildAttr:function(e){this.source.name=e,this.$emit("change",e)}}};t.default=i},XCVn:function(e,t,a){},XuTA:function(e,t,a){},XwKj:function(e,t,a){"use strict";a("lQwB")},Y3Tp:function(e,t,a){"use strict";a.r(t);var n=a("fD9S"),i=a("AilM");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("dVYA");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"194b675f",null);t.default=r.exports},YFlw:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"JsonView",mixins:[n(a("PHku")).default],props:{showVariable:{type:Boolean,default:!0},valueLabel:{type:String,default:""},value:{type:[Object,Array]}},inject:["editorProvide"],data:function(){return{formats:[{label:"参数",value:"variable"},{label:"文本",value:"string"},{label:"数值",value:"number"},{label:"布尔",value:"boolean"},{label:"对象",value:"object"},{label:"数组",value:"array"}],hideMyBlock:{}}},components:{"array-view":function(){return a.e(78).then(a.bind(null,"A1Rg"))}},methods:{delItem:function(e,t,a){this.value.splice(a,1),this.hideMyBlock[a]&&(this.hideMyBlock[a]=!1),this.$emit("input",this.value)},closeBlock:function(e,t){this.$set(this.hideMyBlock,e,!this.hideMyBlock[e])},addItem:function(){this.editorProvide.addItem(this)},newItem:function(e){var t={name:e.key,type:e.type};"array"===e.type||"object"===e.type?(t.childParams=e.val,t.remark=null):(t.childParams=null,t.remark=e.val),t.name?(this.value.push(t),this.$emit("input",this.value)):this.$message.error("请输入Key")},keyInputBlur:function(e,t){e.name.length<=0&&(this.$message.error("请输入Key"),e.name="null",t.target.focus())},onDragEnd:function(){this.$emit("input",this.value)},itemTypeChange:function(e){"array"!==e.type&&"object"!==e.type||(e.childParams=[],e.remark=null),"boolean"===e.type&&(e.remark=!0),"string"===e.type&&(e.remark=""),"number"===e.type&&(e.remark=0),"variable"===e.type&&(e.remark="$global.__")},numberInputChange:function(e){e.remark||(e.remark=0)},handleShowVariableSelect:function(e,t,a){this.editorProvide.handleShowVariableSelect(e,t,a)}}};t.default=i},YhVc:function(e,t,a){"use strict";a.r(t);var n=a("1kJ6"),i=a("UTqS");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("2KVu");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"a941bc38",null);t.default=r.exports},"Z8+y":function(e,t,a){},ZGo6:function(e,t,a){"use strict";a.r(t);var n=a("8YQo"),i=a("tevo");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("rulp");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"43ffb9f0",null);t.default=r.exports},ZUMZ:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"ItemAddForm",mixins:[n(a("PHku")).default],inject:["editorProvide"],data:function(){return{formats:[{label:"参数",value:"variable"},{label:"文本",value:"string"},{label:"数值",value:"number"},{label:"布尔",value:"boolean"},{label:"对象",value:"object"},{label:"数组",value:"array"}],formatSelected:"string",popoverVisible:!1,formData:{keyName:"",valName:""}}},props:{showVariable:{type:Boolean,default:!0},needName:{default:!0}},methods:{show:function(e,t,a){this.formData.keyName=e,this.formData.valName=t,this.formatSelected=a||"string",this.popoverVisible=!0},confirm:function(){if(!this.needName||this.formData.keyName)if("variable"!==this.formatSelected||this.formData.valName){var e=null;e="array"===this.formatSelected||"object"===this.formatSelected?[]:this.formData.valName;var t={key:this.needName?this.formData.keyName:null,val:e,type:this.formatSelected};this.$emit("confirm",t),this.popoverVisible=!1}else this.$message.error("请选择变量");else this.$message.error("请输入key")},cancel:function(){this.popoverVisible=!1},dealBoolean:function(){this.formData.valName=Boolean(this.formData.valName)},dealNumber:function(){this.formData.valName=Number(this.formData.valName)}}};t.default=i},ZUwS:function(e,t,a){"use strict";a.r(t);var n=a("rChg"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},Zcd6:function(e,t,a){"use strict";a("OVJj")},Zort:function(e,t,a){},ZthT:function(e,t,a){"use strict";a.r(t);var n=a("ZutC"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},ZutC:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("rePB")),s=n(a("HaE+")),r=n(a("ODXe")),l=n(a("KQm4")),c=n(a("GhP2")),u=n(a("KAmc")),d=a("8SHQ"),p=n(a("YLtl")),f=n(a("PHku")),v=a("xBdn"),m=a("hNau"),h=n(a("yQm5")),g=a("7Qib");function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={name:"ApiAction",components:{GatewayDataSelect:c.default},mixins:[f.default],props:{actionData:{type:Object},stepData:{type:Object}},data:function(){return{loading:!1,methods:["POST","GET","PUT","DELETE","PATCH"],activeParamsName:"body",rules:{url:(0,v.getValidators)([{message:"请输入",include:v.required,trigger:"change"}])},contentTypeOptions:["application/json","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],headersOptions:["snc-token","Content-Type","Authorization"],apiRequest:null}},computed:{url:{get:function(){return this.apiRequest.url},set:function(e){var t=this,a=this.apiRequest.url.split("?")[0],n=e.split("?")[0],i=new h.default(a),o=new h.default(n),s=i.pathname(),r=o.pathname(),c=[],u=[];try{u=(0,m.parse)(s).filter((function(e){return p.default.isObject(e)})).map((function(e){return e.name})),c=(0,m.parse)(r).filter((function(e){return p.default.isObject(e)})).map((function(e){return e.name}))}catch(e){return this.apiRequest.url=n,void(this.apiRequest.useDynamicOrigin&&(this.actionData.config.http.urlBuildConfig.path=r))}var d=c.map((function(e){var a=t.apiRequest.params.find((function(t){return t.key===e}));return{key:e,value:null==a?void 0:a.value,mockValue:null==a?void 0:a.mockValue}})),f=this.apiRequest.params.filter((function(e){return![].concat((0,l.default)(u),(0,l.default)(c)).includes(e.key)}));this.apiRequest.params=d.length?p.default.uniqBy([].concat((0,l.default)(d),(0,l.default)(f)),"key"):f.length?f:[{key:"",value:void 0,mockValue:void 0}],this.apiRequest.url=n}},currentParamsData:function(){return this.apiRequest[this.activeParamsName]},paramsSource:{get:function(){return{body:Object.fromEntries(this.apiRequest.body.map((function(e){return[[e.key],e.value]}))),params:Object.fromEntries(this.apiRequest.params.map((function(e){return[[e.key],e.value]}))),headers:Object.fromEntries(this.apiRequest.headers.map((function(e){return[[e.key],e.value]})))}},set:function(e){var t=this.customApiProvide.apiDetail.steps.map((function(e){return e.code}));this.apiRequest[this.activeParamsName]=Object.entries(e).map((function(e){var a=(0,r.default)(e,2),n=a[0],i=a[1];return{key:n,value:i,mockValue:(0,g.isValidateParams)(i,t)?void 0:JSON.parse(JSON.stringify(void 0===i?null:i,(function(e,a){return(0,g.isValidateParams)(a,t)?null:a})))}}))}},bodyLength:function(){var e;return(null===(e=this.apiRequest.body)||void 0===e?void 0:e.filter((function(e){return e.key})).length)||0},paramsLength:function(){var e;return(null===(e=this.apiRequest.params)||void 0===e?void 0:e.filter((function(e){return e.key})).length)||0},headersLength:function(){var e;return(null===(e=this.apiRequest.headers)||void 0===e?void 0:e.filter((function(e){return e.key})).length)||0}},watch:{actionData:{handler:function(e,t){p.default.isEqual(e,t)||(this.apiRequest=p.default.cloneDeep(e.config.http))},deep:!0,immediate:!0}},methods:{handleAddParams:function(){this.currentParamsData.push({key:"",value:void 0,mockValue:void 0})},handleDeleteParams:function(e){var t=this.currentParamsData;if(1===t.length)return t[0].key="",t[0].value=void 0,void(t[0].mockValue=void 0);t.splice(e,1)},handleShowGatewayDataSelect:function(){this.$refs.gatewayDataSelect.open()},handleGatewayDataConfirm:function(e){var t=this,a=e.apiRequest,n=(e.response,e.apiInfo);this.bodyLength||this.paramsLength||this.headersLength?this.$confirm("是否覆盖已配置的请求参数？").then((function(){t.apiRequest=p.default.cloneDeep({url:a.url,method:a.method,type:a.type,body:a.bodyData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),params:a.paramsData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),headers:a.headersData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),desc:n.description})})).catch((function(){t.apiRequest.url=a.url,t.apiRequest.desc=n.description})):this.apiRequest=p.default.cloneDeep({url:a.url,method:a.method,type:a.type,body:a.bodyData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),params:a.paramsData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),headers:a.headersData.map((function(e){return{key:e.key,value:e.value,mockValue:e.test}})),desc:n.description})},changeType:function(e){var t=this;this.apiRequest.type!==e&&(this.apiRequest.url="",this.apiRequest.type=e,this.apiRequest.desc="",this.$nextTick((function(){t.$refs.apiRequest.clearValidate()})))},paramsInputDisabled:function(e){if("params"!==this.activeParamsName)return!1;var t=new h.default("".concat(this.url)).pathname(),a=[];try{a=(0,m.parse)(t).filter((function(e){return p.default.isObject(e)})).map((function(e){return e.name}))}catch(e){return!1}return a.includes(e)},handleMock:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getResult();case 2:a=t.sent,e.$emit("response",{response:null}),e.loading=!0,e.$http({url:u.default.apiDesignMockRunAction,data:{appId:Number(e.$route.query.id),sessionId:window[d.CUSTOM_API_SESSION_ID],stepCode:e.actionData.code,action:y(y({},e.actionData),{},{config:y(y({},e.actionData.config),{},{http:a,db:null})}),requestBody:e.customApiProvide.apiDetail.requestBody}}).then((function(t){e.$emit("response",{response:t.data})})).finally((function(){e.loading=!1}));case 6:case"end":return t.stop()}}),t)})))()},getResult:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a,n,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.apiRequest.validate();case 2:if(!e.apiRequest.useDynamicOrigin){t.next=6;break}if(e.apiRequest.dynamicOrigin){t.next=6;break}return e.$message.error("请选择动态协议域名端口"),t.abrupt("return",Promise.reject("请选择动态协议域名端口"));case 6:return a=new h.default(e.apiRequest.url),n=a.pathname(),o=y(y({},e.apiRequest),{},{body:e.apiRequest.body.filter((function(e){return e.key})),headers:e.apiRequest.headers.filter((function(e){return e.key})),params:e.apiRequest.params.filter((function(e){return e.key})),urlBuildConfig:e.apiRequest.useDynamicOrigin?{address:e.apiRequest.dynamicOrigin,path:n}:null}),t.abrupt("return",Promise.resolve(o));case 10:case"end":return t.stop()}}),t)})))()},handleUseDynamicOriginChange:function(e){var t=new h.default("".concat(this.url));this.url=e?t.pathname()||"/":this.url,this.apiRequest.dynamicOrigin=this.apiRequest.dynamicOrigin||void 0},handleShowVariableSelect:function(e,t,a){var n,i;this.variableRowDetail={row:e,key:t,cb:a},this.$refs.variableSelect.open({fullVariable:e[t],stepCode:null===(n=this.stepProvide)||void 0===n||null===(i=n.stepData)||void 0===i?void 0:i.code,onlyGlobal:e===this.apiRequest&&this.apiRequest.useDynamicOrigin&&"dynamicOrigin"===t})},handleVariableConfirm:function(e){var t=this.variableRowDetail,a=t.row,n=t.key,i=t.cb;if(n&&(this.$set(a,n,e),a===this.apiRequest&&this.apiRequest.useDynamicOrigin&&"dynamicOrigin"===n)){var o=window[d.CUSTOM_API_MACRO_VARIABLES].find((function(t){return"$macroVariables.".concat(t.key)===e}));0!==((null==o?void 0:o.defaultValue)||"").indexOf("http")&&(this.$message.error("动态协议域名端口格式不正确，请确认当前选择的宏变量的默认值为正确的url格式，如https://...."),this.$set(a,n,void 0))}null==i||i(e)}}};t.default=_},a11y:function(e,t,a){var n=a("yJIN");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("48431484",n,!0,{})},aAb1:function(e,t,a){"use strict";a.r(t);var n=a("6SMo"),i=a("0X8H");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("nDTW");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"a85ae87a",null);t.default=r.exports},adEZ:function(e,t,a){"use strict";a.r(t);var n=a("NH8S"),i=a("6I2U");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("2wg+");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"45ad7168",null);t.default=r.exports},ayh6:function(e,t,a){"use strict";a.r(t);var n=a("Ttgw"),i=a("gVYA");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("WTgn");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"b998e3ee",null);t.default=r.exports},bIxA:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("KAmc")),r=a("E0s0");a("uD/U");var l={name:"Publish",components:{VueJsonPretty:new r.Factory({virtualLines:20})},inject:["customApiProvide"],props:{apiGroupList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,dialogVisible:!1,response:null,apiData:null,pathPrepend:"/app".concat(this.$route.query.id,"/")}},computed:{apiGroupName:function(){var e,t=this;return null===(e=this.apiGroupList.find((function(e){var a;return e.id===(null===(a=t.apiData)||void 0===a?void 0:a.groupId)})))||void 0===e?void 0:e.name}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(e){var t=e.apiData,a=e.response;this.apiData=t,this.response=a,this.dialogVisible=!0},handleConfirm:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("发布后可在网关API中选用","是否保存并发布至网关");case 2:e.loading=!0,e.$http({url:s.default.apiDesignPublish,data:{id:e.apiData.id}}).then((function(t){e.apiData.status=2,e.$message.success("发布成功！"),e.$emit("success"),e.dialogVisible=!1})).finally((function(){e.loading=!1}));case 4:case"end":return t.stop()}}),t)})))()}}};t.default=l},bPPv:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"json-tree"},[a("vxe-table",{ref:"xTable",staticClass:"json-tree-table",attrs:{size:"mini",resizable:"","max-height":"500",data:e.treeNode.children}},[a("vxe-column",{attrs:{field:"key",title:"出参名称"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-input",{attrs:{disabled:["Array"].includes(e.treeNode.type),size:"mini",placeholder:"出参名称"},model:{value:n.key,callback:function(t){e.$set(n,"key",t)},expression:"row.key"}})]}}])}),e._v(" "),a("vxe-column",{attrs:{field:"map",title:"格式化操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",{staticClass:"value-input"},[e.isShowFormat(n)?a("el-tooltip",{attrs:{effect:"dark",content:e.getTips(n),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagErrorType(n)},on:{click:function(t){return e.handleTagClick(n)},close:function(t){return e.handleDeleteFormatter(n)}}},[e._v("\n              "+e._s(e.getTag(n))+"\n            ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleSelectVar(n)}}},[e._v("选择出参")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleShowFormatter(n)}}},[e._v("格式化")])],1)],1)],1)]}}])}),e._v(" "),a("vxe-column",{attrs:{field:"type",title:"出参类型"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-select",{attrs:{size:"mini",disabled:n.mapperConfig},model:{value:n.type,callback:function(t){e.$set(n,"type",t)},expression:"row.type"}},e._l(e.types,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),e._v(" "),a("vxe-column",{attrs:{title:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.rowIndex;return[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddNode}},[e._v("+")]),e._v(" "),a("div",{staticClass:"add-btn-primary",on:{click:function(t){return e.handleDeleteNode(n)}}},[e._v("\n            -\n          ")])])]}}])})],1),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:!0},on:{confirm:e.handleVariableConfirm}}),e._v(" "),a("ObjectFormatter",{ref:"objectFormatter",on:{confirm:e.handleFormatConfirm}}),e._v(" "),a("StringFormatter",{ref:"stringFormatter",on:{confirm:e.handleFormatConfirm}}),e._v(" "),a("BooleanFormatter",{ref:"booleanFormatter",on:{confirm:e.handleFormatConfirm}}),e._v(" "),a("NumberFormatter",{ref:"numberFormatter",on:{confirm:e.handleFormatConfirm}})],1)},i=[]},bbu0:function(e,t,a){"use strict";a.r(t);var n=a("Lxu4"),i=a("rCLk");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("K3qR");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"2e0f1250",null);t.default=r.exports},bc0g:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:e.title,visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"action-info"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("逻辑信息")])]),e._v(" "),a("div",{staticClass:"action-info-item"},[a("n-form",{staticStyle:{flex:"1"},attrs:{"label-position":"left","label-width":"80px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("n-form-item",{attrs:{required:"",label:"逻辑名称"}},[a("el-input",{model:{value:e.actionData.name,callback:function(t){e.$set(e.actionData,"name",t)},expression:"actionData.name"}})],1)],1),e._v(" "),a("logic-list",{on:{change:e.handleLogicChange}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"}},[e._v("选择已存逻辑")])],1)],1)]),e._v(" "),a("div",{staticClass:"action-condition"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("条件配置")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("span",{attrs:{slot:"content"},slot:"content"},[e._v("配置该逻辑的条件判断，满足条件时执行逻辑，不满足则停止执行。")]),e._v(" "),a("i",{staticClass:"el-icon-question",staticStyle:{"margin-right":"10px"}})]),e._v(" "),a("el-switch",{on:{change:e.handleEnableChange},model:{value:e.actionData.condition.enable,callback:function(t){e.$set(e.actionData.condition,"enable",t)},expression:"actionData.condition.enable"}})],1),e._v(" "),e.actionData.condition.enable?a("Condition",{attrs:{condition:e.actionData.condition}}):e._e()],1),e._v(" "),a("div",{staticClass:"action-config"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("逻辑配置")])]),e._v(" "),1===e.actionData.type?a("ApiAction",{ref:"apiAction",attrs:{actionData:e.actionData,stepData:e.stepData},on:{response:e.handleResponse}}):e._e(),e._v(" "),2===e.actionData.type?a("SqlAction",{ref:"sqlAction",attrs:{actionData:e.actionData,stepData:e.stepData},on:{response:e.handleResponse}}):e._e()],1),e._v(" "),a("div",{staticClass:"action-response"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("响应体")])]),e._v(" "),a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty",attrs:{path:"response",data:e.response,virtual:!0,itemHeight:32},model:{value:e.selectedPath,callback:function(t){e.selectedPath=t},expression:"selectedPath"}}),e._v(" "),e.response?e._e():a("div",{staticClass:"empty-text"},[e._v("暂无数据")])],1)])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}})],1)},i=[]},bmgL:function(e,t,a){},brNU:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"数值格式化",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("n-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleChangeType},model:{value:e.currentNode.mapperConfig.type,callback:function(t){e.$set(e.currentNode.mapperConfig,"type",t)},expression:"currentNode.mapperConfig.type"}},[a("n-tab-pane",{attrs:{label:"数值统计",name:"NUMBER_COUNT"}},[a("SourceSelect",{attrs:{source:e.currentNode.mapperConfig.numberCount.source},on:{change:e.handleSourceChange}}),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("\n            过滤条件：\n          ")]),e._v(" "),a("el-switch",{model:{value:e.currentNode.mapperConfig.numberCount.filter.enable,callback:function(t){e.$set(e.currentNode.mapperConfig.numberCount.filter,"enable",t)},expression:"currentNode.mapperConfig.numberCount.filter.enable"}})],1),e._v(" "),e.currentNode.mapperConfig.numberCount.filter.enable?a("Condition",{attrs:{isShowLeft:!1,condition:e.currentNode.mapperConfig.numberCount.filter,showSelf:!0}}):e._e(),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("统计函数：")]),e._v(" "),a("el-select",{attrs:{size:"mini"},model:{value:e.currentNode.mapperConfig.numberCount.function,callback:function(t){e.$set(e.currentNode.mapperConfig.numberCount,"function",t)},expression:"currentNode.mapperConfig.numberCount.function"}},e._l(e.functionOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("小数点保留：")]),e._v(" "),a("div",{staticClass:"input"},[a("el-input-number",{staticStyle:{width:"193px"},attrs:{size:"mini","step-strictly":"",min:0,max:6,placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.numberCount.pointNumber,callback:function(t){e.$set(e.currentNode.mapperConfig.numberCount,"pointNumber",t)},expression:"currentNode.mapperConfig.numberCount.pointNumber"}})],1)])],1),e._v(" "),a("n-tab-pane",{attrs:{label:"数值运算",name:"NUMBER_CALCULATE"}},[a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("\n            运算公式：\n            "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"left"}},[a("div",{staticStyle:{"white-space":"nowrap"},attrs:{slot:"content"},slot:"content"},[e._v("\n                支持加减乘除四则运算，参照模板输入数值运算的公式，如：(A*B)+(C*D)-(E/F)+G+...\n              ")]),e._v(" "),a("i",{staticClass:"el-icon-question test-btn tooltip"})])],1)]),e._v(" "),a("el-input",{staticClass:"input",staticStyle:{margin:"10px 0"},attrs:{placeholder:"支持加减乘除四则运算，参照模板输入数值运算的公式，如：(A*B)+(C*D)-(E/F)+G+..."},model:{value:e.currentNode.mapperConfig.numberCalculate.formula,callback:function(t){e.$set(e.currentNode.mapperConfig.numberCalculate,"formula",t)},expression:"currentNode.mapperConfig.numberCalculate.formula"}}),e._v(" "),a("vxe-table",{ref:"xTable",staticClass:"json-tree-table",staticStyle:{width:"100%"},attrs:{size:"mini","auto-resize":!0,resizable:"","max-height":"500",data:e.currentNode.mapperConfig.numberCalculate.items}},[a("vxe-column",{attrs:{field:"name",title:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-input",{attrs:{size:"mini",placeholder:"请输入名称"},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"row.name"}})]}}],null,!1,881657609)}),e._v(" "),a("vxe-column",{attrs:{field:"source"},scopedSlots:e._u([{key:"header",fn:function(){return[a("span",[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("参数\n              ")])]},proxy:!0},{key:"default",fn:function(t){var n=t.row;return[a("div",{staticClass:"value-input"},[n.source.name?a("el-tooltip",{attrs:{effect:"dark",content:n.source.name,placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagErrorType(n)},on:{click:function(t){return e.handleShowVariableSelect(n.source,"name")},close:function(e){n.source.name=""}}},[e._v("\n                    "+e._s(e.getElementName(n.source.name,!0))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},[a("SourceSelect",{attrs:{showLabel:!1,title:"选择参数",source:n.source}})],1)],1)]}}],null,!1,2792773134)}),e._v(" "),a("vxe-column",{attrs:{field:"description",title:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-input",{attrs:{size:"mini",placeholder:"请输入描述"},model:{value:n.description,callback:function(t){e.$set(n,"description",t)},expression:"row.description"}})]}}],null,!1,2314696266)}),e._v(" "),a("vxe-column",{attrs:{title:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.rowIndex;return[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddItem}},[e._v("+")]),e._v(" "),a("div",{staticClass:"add-btn-primary",staticStyle:{"margin-left":"15px"},on:{click:function(t){return e.handleDeleteItem(n)}}},[e._v("\n                  -\n                ")])])]}}],null,!1,3703359140)})],1),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("小数点保留：")]),e._v(" "),a("div",{staticClass:"input"},[a("el-input-number",{staticStyle:{width:"193px"},attrs:{size:"mini","step-strictly":"",min:0,max:6,placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.numberCalculate.pointNumber,callback:function(t){e.$set(e.currentNode.mapperConfig.numberCalculate,"pointNumber",t)},expression:"currentNode.mapperConfig.numberCalculate.pointNumber"}})],1)])],1),e._v(" "),a("n-tab-pane",{attrs:{label:"小数点保留",name:"DECIMAL_POINT_FORMAT"}},[a("SourceSelect",{attrs:{source:e.currentNode.mapperConfig.decimalPointFormat.source},on:{change:e.handleSourceChange}}),e._v(" "),a("div",{staticClass:"input-item",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"label"},[e._v("小数点保留：")]),e._v(" "),a("div",{staticClass:"input"},[a("el-input-number",{staticStyle:{width:"193px"},attrs:{size:"mini","step-strictly":"",min:0,max:6,placeholder:"请输入"},model:{value:e.currentNode.mapperConfig.decimalPointFormat.pointNumber,callback:function(t){e.$set(e.currentNode.mapperConfig.decimalPointFormat,"pointNumber",t)},expression:"\n                currentNode.mapperConfig.decimalPointFormat.pointNumber\n              "}})],1)])],1)],1)],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleAddTextJoinValue}}),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:!0},on:{confirm:e.handleVariableConfirm}})],1)},i=[]},c8t2:function(e,t,a){},cBEb:function(e,t,a){"use strict";a.r(t);var n=a("1Qg2"),i=a("eT/0");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("//J7");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"36b7f4e4",null);t.default=r.exports},cELa:function(e,t,a){},cqvt:function(e,t,a){"use strict";a.r(t);var n=a("vPsv"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},d2Wf:function(e,t,a){},"dM/z":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("rePB")),o=n(a("KAmc")),s=a("8SHQ"),r=a("E0s0");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a("uD/U");var u={name:"ApiMock",components:{VueJsonPretty:new r.Factory({virtualLines:50})},inject:["customApiProvide"],data:function(){return{dialogVisible:!1,loading:!1,apiDetail:{},logData:null,selectedAction:null,selectedStep:null,responseHeight:0,isShowResponse:!1,response:null,isShowRequest:!0,actionLogList:[]}},computed:{time:function(){return this.logData?this.logData.executeResult.endTime-this.logData.executeResult.beginTime:0},status:function(){var e,t;return null!==(e=this.logData)&&void 0!==e&&null!==(t=e.executeResult)&&void 0!==t&&t.success?"执行成功":"执行失败"},successCount:function(){var e,t;return(null===(e=this.logData)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.successCount)||0},failedCount:function(){var e,t;return(null===(e=this.logData)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.failedCount)||0},inputMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.input;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},outputMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.output;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},errorMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.errorReason;return a},sourceMsg:function(){var e,t,a=null===(e=this.selectedStep)||void 0===e||null===(t=e.stepOutput)||void 0===t?void 0:t.output;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},formatMsg:function(){var e,t,a,n,i=null!==(e=this.selectedStep)&&void 0!==e&&null!==(t=e.stepOutput)&&void 0!==t&&t.hasMapped?null===(a=this.selectedStep)||void 0===a||null===(n=a.stepOutput)||void 0===n?void 0:n.mappedOutput:"";return i?JSON.stringify(i,(function(e,t){return void 0===t?null:t}),2):"无数据"}},methods:{handleClose:function(e){this.apiDetail={},this.logData=null,this.selectedAction=null,this.selectedStep=null,this.responseHeight=0,this.isShowResponse=!1,this.response=null,this.isShowRequest=!0,this.actionLogList=[],this.dialogVisible=!1,e()},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.apiDetail;this.apiDetail=t,this.handleMock(),this.dialogVisible=!0},handleMock:function(){var e=this;this.loading=!0,this.$http({url:o.default.apiDesignMockRunApi,data:{sessionId:window[s.CUSTOM_API_SESSION_ID],api:this.apiDetail}}).then((function(t){e.response=t,window[s.CUSTOM_API_RESPONSE_MAP][e.apiDetail.id]=e.response,e.handleGetLog(),e.handleUpdateOutputMap()})).catch((function(){e.dialogVisible=!1})).finally((function(){e.loading=!1}))},handleExport:function(){},handleGetLog:function(){var e=this;this.$http({url:o.default.apiDesignGetRunApiDetail,data:{sessionId:window[s.CUSTOM_API_SESSION_ID]}}).then((function(t){e.logData=t.data,e.logData.stepDetails=e.logData.stepDetails.map((function(e){return c(c({},e),{},{isShow:!1})}))})).finally((function(){e.loading=!1}))},handleUpdateOutputMap:function(){this.$http({url:o.default.apiDesignGetAllStepOutput,data:{sessionId:window[s.CUSTOM_API_SESSION_ID]}}).then((function(e){Object.keys(e.data).forEach((function(t){window[s.CUSTOM_API_RESPONSE_MAP]["".concat(t,"_source")]=e.data[t].output,window[s.CUSTOM_API_RESPONSE_MAP]["".concat(t)]=e.data[t].mappedOutput}))}))},updateHeight:function(){var e=this.$refs.dialog.$el.firstChild;this.responseHeight=(null==e?void 0:e.getBoundingClientRect().height)-40},handleChangeStepShow:function(e){var t=this,a=e.isShow;this.logData.stepDetails.forEach((function(e){return e.isShow=!1})),e.actionResults?(e.isShow=!a,this.selectedAction=e.actionResults[0],this.selectedStep=e,this.$nextTick((function(){t.updateHeight()}))):(this.loading=!0,this.$http({url:o.default.apiDesignGetRunStepDetail,data:{sessionId:window[s.CUSTOM_API_SESSION_ID],stepCode:e.stepInfo.code}}).then((function(a){t.$set(e,"actionResults",a.data.actionResults),t.$set(e,"hasMapped",a.data.hasMapped),t.$set(e,"output",a.data.output),t.$set(e,"mappedOutput",a.data.mappedOutput),t.$set(e,"stepOutput",a.data.stepOutput),t.selectedAction=e.actionResults[0],t.selectedStep=e,e.isShow=!0,t.handleGetActionListLog(),t.$nextTick((function(){t.updateHeight()}))})).finally((function(){t.loading=!1})))},handleGetActionListLog:function(){var e=this;this.loading=!0,this.$http({url:o.default.apiDesignGetListRunActionLog,data:{sessionId:window[s.CUSTOM_API_SESSION_ID],actionCode:this.selectedAction.actionInfo.code}}).then((function(t){e.actionLogList=t.data.map((function(e){return{showDetail:0!==e.indexOf("[JSON_FORMAT"),detail:e}}))})).finally((function(){e.loading=!1}))},handleToggleShowResponse:function(){var e=this;this.isShowResponse?this.isShowResponse=!1:(this.updateHeight(),this.$nextTick((function(){e.isShowResponse=!0})))},changeAction:function(e){this.selectedAction=e,this.handleGetActionListLog()}}};t.default=u},dVYA:function(e,t,a){"use strict";a("EzBS")},dX1I:function(e,t,a){var n=a("f2bP");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("e0b0320a",n,!0,{})},dZZJ:function(e,t,a){},diF1:function(e,t,a){},eNIk:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("rePB")),o=n(a("slWK")),s=n(a("/S23")),r=a("WIBD"),l=(n(a("YLtl")),a("Zct0"));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={components:{},props:{},data:function(){return{dialogVisible:!1,activeName:"navigate",settings:{}}},created:function(){},mounted:function(){},methods:u(u({},(0,r.mapMutations)({setVersionInfo:s.default.VERSION_INFO})),{},{open:function(){this.dialogVisible=!0},updateSetting:function(){var e=this;this.$http({url:o.default.updateSettings,data:{appDesignId:this.versionInfo.id,settings:JSON.stringify(this.settings)}}).then((function(){e.setVersionInfo(u(u({},e.versionInfo),{},{settings:JSON.stringify(e.settings)}))}))}}),computed:{versionInfo:function(){return this.$store.state.CODE.baseInfo.VERSION_INFO}},watch:{versionInfo:{immediate:!0,handler:function(e){this.settings=(0,l.formatSetting)(e.settings)}}}};t.default=d},"eT/0":function(e,t,a){"use strict";a.r(t);var n=a("52Qv"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},f2bP:function(e,t,a){},fD9S:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"数据集管理",visible:e.dialogVisible,width:"1000px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"table-search"},[a("el-select",{on:{change:e.doSearch},model:{value:e.condition.type,callback:function(t){e.$set(e.condition,"type",t)},expression:"condition.type"}},e._l(e.optionList,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1),e._v(" "),a("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"",placeholder:"输入关键字查询"},model:{value:e.condition.keyword,callback:function(t){e.$set(e.condition,"keyword",t)},expression:"condition.keyword"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}})],1),e._v(" "),a("vxe-table",{ref:"table",attrs:{size:"mini",data:e.dataList,border:"","show-overflow":"","header-cell-class-name":"header-cell"}},[a("vxe-table-column",{attrs:{field:"name",title:"名称"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"type",title:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.getTypeLabel(n.type)))])]}}])}),e._v(" "),a("vxe-table-column",{attrs:{field:"description",title:"描述","min-width":"100px"}}),e._v(" "),a("vxe-table-column",{attrs:{title:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("div",{staticClass:"pager"},[a("vxe-pager",{attrs:{background:"",size:"small","current-page":e.pagination.pagenum,"page-size":e.pagination.pagesize,total:e.totalCount,"page-sizes":[10,20,50,100]},on:{"page-change":e.handlePageChange}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 认")])],1),e._v(" "),a("data-set-dialog",{ref:"dataSetDialog",on:{refresh:e.handleSearch}})],1)},i=[]},fLK4:function(e,t,a){},fOhA:function(e,t,a){"use strict";a.r(t);var n=a("1D54"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},fy6Q:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("U8pU")),o=n(a("Q+Qv")),s=a("8SHQ"),r=n(a("PHku")),l=n(a("YhVc")),c={name:"JsonEditor",mixins:[r.default],props:{value:{type:[Object,Array,String],required:!0},showVariable:{type:Boolean,default:!0},valueLabel:{type:String,default:""}},data:function(){return{parsedData:{},editorProvide:{showButtons:!1,handleShowVariableSelect:this.handleShowVariableSelect,handleVariableConfirm:this.handleVariableConfirm,addItem:this.addItem},currentContext:{},loading:!0}},provide:function(){return{editorProvide:this.editorProvide}},created:function(){var e;this.lastParsedData={};try{e="object"===(0,i.default)(this.value)?this.value:JSON.parse(this.value||"{}")}catch(t){this.$message.error("JSON解析失败"),console.log(t),e={}}this.parsedData=this.jsonParse(e)},mounted:function(){var e=this;setTimeout((function(){e.loading=!1}),100)},watch:{value:{handler:function(e,t){var a="object"===(0,i.default)(this.value)?this.value:JSON.parse(this.value||"{}");this.parsedData=this.jsonParse(a)}},parsedData:{handler:function(e,t){if(JSON.stringify(e)!==JSON.stringify(this.lastParsedData)){var a;this.lastParsedData=e;var n=this.makeJson(this.parsedData);a=Object.keys(n).length&&Object.keys(n).every((function(e){return/^[0-9]+.?[0-9]*$/.test(e)}))?Object.values(n):n,this.$emit("input",a)}},deep:!0}},components:{"item-add-form":l.default,"json-view":o.default},methods:{jsonParse:function(e){var t=this,a=function e(a){var i=[];return Object.keys(a).forEach((function(o,s){if(""!==o&&void 0!==o){var r=a[o],l=r;"object"===t.getType(r)?l=e(r):"array"===t.getType(r)&&(l=n(r));var c={name:o,type:t.getType(r)};"array"===c.type||"object"===c.type?(c.childParams=l,c.remark=null):(c.childParams=null,c.remark=l),i.push(c)}})),i},n=function e(n){for(var i=[],o=0;o<n.length;++o){var s=n[o],r=s;"object"===t.getType(s)?r=a(s):"array"===t.getType(s)&&(r=e(s));var l={name:null,type:t.getType(s)};"array"===l.type||"object"===l.type?(l.childParams=r,l.remark=null):(l.childParams=null,l.remark=r),i.push(l)}return i};return a(e)},getType:function(e){switch(Object.prototype.toString.call(e)){case"[object Array]":return"array";case"[object Object]":return"object";case"[object Null]":case"[object Function]":case"[object Undefined]":return"string";case"[object String]":return e.includes(s.FUNCTION_FLAG)||this.isValidateVariableParams(e)?"variable":"string";default:return(0,i.default)(e)}},makeJson:function(e){var t=function e(t){for(var n={},i=0;i<t.length;++i){var o,s=t[i],r=void 0;o=s.name,r="array"===s.type?a(s.childParams):"object"===s.type?e(s.childParams):s.remark,n[o]=r}return n},a=function e(a){for(var n=[],i=0;i<a.length;++i){var o=a[i],s=void 0;s="array"===o.type?e(o.childParams):"object"===o.type?t(o.childParams):o.remark,n.push(s)}return n};return t(e)},handleShowVariableSelect:function(e,t,a){this.variableRowDetail={row:e,key:t,cb:a},this.$refs.variableSelect.open({fullVariable:e[t],callbackId:this.callbackId})},handleVariableConfirm:function(e){var t=this.variableRowDetail,a=t.row,n=t.key,i=t.cb;n&&this.$set(a,n,e),null==i||i(e)},addItem:function(e){this.$refs.popover.show(),this.currentContext=e},newItem:function(e){this.currentContext.newItem(e)}}};t.default=c},gCWh:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"bottom",title:"选择逻辑",trigger:"click"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[a("el-input",{staticClass:"tree-select-search",attrs:{placeholder:"输入名称筛选",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("n-tree",{ref:"tree",staticClass:"tree-select-popper-content",style:{minWidth:"string"==typeof e.width?e.width:e.width-24+"px"},attrs:{data:e.treeData,"show-checkbox":"","default-expand-all":!0,"default-expanded-keys":e.defaultExpandedKeys,"check-on-click-node":!0,"expand-on-click-node":!0,"node-key":e.nodeKey,"check-strictly":!0,"filter-node-method":e.filterNode,"icon-class":"icon-right",props:e.treeProps,"default-checked-keys":e.defaultSelectedKeys},on:{check:e.handleCheckClick,"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return a("div",{staticClass:"widget-tree-node-name"},[a("img",{staticClass:"widget-tree-node-icon",attrs:{src:e.getIcon(n),alt:""}}),e._v(" "),a("span",[e._v(e._s(n.name))])])}}])}),e._v(" "),e._t("default",null,{slot:"reference"})],2)},i=[]},gCY9:function(e,t,a){"use strict";a("dX1I")},gEGy:function(e,t,a){"use strict";a.r(t);var n=a("4NMP"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},gRNa:function(e,t,a){var n=a("6Z5G");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("48d04d93",n,!0,{})},gVYA:function(e,t,a){"use strict";a.r(t);var n=a("2aR8"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},gYbz:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"布尔值格式化",visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("Condition",{attrs:{condition:e.currentNode.mapperConfig.booleanMap,showSelf:!0}})],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1)])},i=[]},gzKy:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"发布自定义API",visible:e.dialogVisible,width:"1000px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"api-detail"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("API信息")])]),e._v(" "),a("div",{staticClass:"detail-content"},[a("el-row",{staticClass:"detail-item"},[a("el-col",{attrs:{span:2}},[e._v("API名称")]),e._v(" "),a("el-col",{attrs:{span:10}},[e._v(e._s(e.apiData.name))]),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("分组")]),e._v(" "),a("el-col",{attrs:{span:10}},[e._v(e._s(e.apiGroupName))])],1),e._v(" "),a("el-row",{staticClass:"detail-item"},[a("el-col",{attrs:{span:2}},[e._v("API路径")]),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-tag",[e._v("POST")])],1),e._v(" "),a("el-col",{attrs:{span:20}},[e._v(e._s(e.pathPrepend+e.apiData.path))])],1),e._v(" "),a("el-row",{staticClass:"detail-item"},[a("el-col",{attrs:{span:2}},[e._v("API描述")]),e._v(" "),a("el-col",{attrs:{span:22}},[e._v(e._s(e.apiData.description))])],1)],1)]),e._v(" "),a("div",{staticClass:"api-res"},[a("div",{staticClass:"api-request"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("入参定义")])]),e._v(" "),a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.apiData.requestBody,expression:"apiData.requestBody"}],staticClass:"json-pretty",attrs:{data:e.apiData.requestBody,virtual:!0,itemHeight:32}}),e._v(" "),e.apiData.requestBody?e._e():a("div",{staticClass:"empty-text"},[e._v("暂无数据")])],1)]),e._v(" "),a("div",{staticClass:"api-response"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("响应体")])]),e._v(" "),a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty",attrs:{data:e.response,virtual:!0,itemHeight:32}}),e._v(" "),e.response?e._e():a("div",{staticClass:"empty-text"},[e._v("暂无数据")])],1)])])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("发 布")])],1)])},i=[]},hAVY:function(e,t,a){"use strict";a.r(t);var n=a("OeHT"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},hEKV:function(e,t,a){var n=a("ydOG");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("01b8d878",n,!0,{})},"hX/p":function(e,t,a){"use strict";a.r(t);var n=a("k2dZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},hvQ7:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("slWK")),r={name:"DataSetManage",components:{DataSetDialog:n(a("wwYs")).default},data:function(){return{loading:!1,dialogVisible:!1,dataList:[],condition:{type:2,keyword:""},pagination:{pagenum:1,pagesize:20},totalCount:0,optionList:[{label:"静态数据",value:1},{label:"模板SQL",value:3},{label:"动态SQL",value:2},{label:"网关API",value:4},{label:"自定义API",value:5},{label:"外部API",value:6}]}},methods:{open:function(){this.condition.type=2,this.condition.keyword="",this.pagination.pagenum=1,this.pagination.pagesize=20,this.handleSearch(),this.dialogVisible=!0},getTypeLabel:function(e){var t;return null===(t=this.optionList.find((function(t){return t.value===e})))||void 0===t?void 0:t.label},handleClose:function(e){this.dialogVisible=!1,e()},handleEdit:function(e){this.$refs.dataSetDialog.open(e)},handleDelete:function(e){var t=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确认删除[".concat(e.name,"]吗？"));case 2:t.handleRemove(e.id);case 3:case"end":return a.stop()}}),a)})))()},doSearch:function(){this.pagination.pagenum=1,this.handleSearch()},handleRemove:function(e){var t=this;this.loading=!0,this.$http({url:s.default.datasetManageRemove,data:{id:e}}).then((function(a){a.data;t.dataList=t.dataList.filter((function(t){return t.id!==e})),t.totalCount--})).finally((function(){t.loading=!1}))},handleSearch:function(){var e=this;this.loading=!0,this.$http({url:s.default.datasetManagePage,data:{condition:this.condition,pagination:this.pagination}}).then((function(t){var a=t.data;e.dataList=a.records,e.totalCount=a.rowCount})).finally((function(){e.loading=!1}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.pagination.pagenum=t,this.pagination.pagesize=a,this.handleSearch()}}};t.default=r},"iC/w":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:e.title,visible:e.dialogVisible,width:"1200px",top:"5vh","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"dialog-content"},[a("n-breadcrumb",{staticClass:"tree-breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.nodeList,(function(t,n){return a("n-breadcrumb-item",{key:n,staticClass:"tree-breadcrumb-item",class:{isCurrent:e.currentNode===t},nativeOn:{click:function(a){return e.handleChangeLevel(t,n)}}},[e._v(e._s(t.key))])})),1),e._v(" "),"Array"===e.currentNode.type?a("div",{staticClass:"source-select"},[e._v("\n      选择源数组：\n      "),e.currentNode.mapperConfig.arrayMap.source.name?a("el-tooltip",{attrs:{effect:"dark",content:e.currentNode.mapperConfig.arrayMap.source.name,placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(e.currentNode.mapperConfig.arrayMap.source.name,!0)},on:{click:function(t){return e.handleShowVariableSelect(e.currentNode.mapperConfig.arrayMap.source,"name",e.handleBuildAttr)},close:function(t){e.currentNode.mapperConfig.arrayMap.source.name=""}}},[e._v("\n          "+e._s(e.getElementName(e.currentNode.mapperConfig.arrayMap.source.name,!0))+"\n        ")])],1):a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleShowVariableSelect(e.currentNode.mapperConfig.arrayMap.source,"name",e.handleBuildAttr)}}},[e._v("选择")]),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("说明：选择源数组后默认该数组下的所有元素的数据结构是相同的，且无法新增数组下标；不选择源数组则可自由新增数组下标并定义相应的数据结构")]),e._v(" "),a("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"5px"}})])],1):e._e(),e._v(" "),a("JsonTree",{attrs:{treeNode:e.currentNode,stepData:e.stepData,isFlat:!0},on:{addLevel:e.handleAddLevel}})],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 认")])],1),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:!0},on:{confirm:e.handleVariableConfirm}})],1)},i=[]},imte:function(e,t,a){},jwV1:function(e,t,a){"use strict";a("rwbg")},k2dZ:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("6wtB")),o=n(a("YLtl")),s=n(a("PHku")),r=[{items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"},{items:[{left:{source:{expression:"",name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{expression:"",name:""},type:void 0,value:void 0}}],logic:"or"}],l={name:"StringFormatter",components:{Condition:i.default},mixins:[s.default],data:function(){return{dialogVisible:!1,currentNode:null}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},open:function(e){var t=e.currentNode;this.currentNode=o.default.cloneDeep(t),this.handleAddAttr(),this.dialogVisible=!0},handleConfirm:function(){0!==this.currentNode.mapperConfig.booleanMap.conditionItems.map((function(e){return e.items})).flat().filter((function(e){return e.left.source.name||e.left.value||e.right.source.name||e.right.value})).length?(this.$emit("confirm",this.currentNode),this.dialogVisible=!1):this.$message.error("请配置格式化")},handleAddAttr:function(){this.currentNode.mapperConfig?this.currentNode.mapperConfig.booleanMap.conditionItems.length||(this.currentNode.mapperConfig.booleanMap.conditionItems=o.default.cloneDeep(r)):this.$set(this.currentNode,"mapperConfig",{type:"BOOLEAN_MAP",booleanMap:{conditionItems:o.default.cloneDeep(r)}})}}};t.default=l},k5Br:function(e,t,a){var n=a("o1ZN");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("14c67ea0",n,!0,{})},k6MW:function(e,t,a){"use strict";a("yqXf")},kY7n:function(e,t,a){"use strict";a("HOqx")},kZNv:function(e,t,a){"use strict";a.r(t);var n=a("OPx6"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},kdlR:function(e,t,a){"use strict";a("0avZ")},kyEg:function(e,t,a){"use strict";a.r(t);var n=a("BHnC"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},lGBO:function(e,t,a){var n=a("XuTA");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("0118d281",n,!0,{})},lJrv:function(e,t,a){"use strict";a("275s")},lLit:function(e,t,a){"use strict";a("lGBO")},lQwB:function(e,t,a){var n=a("SjY5");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("17997c38",n,!0,{})},"m3y+":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("KAmc")),o=a("8SHQ"),s={name:"ApiScriptMock",inject:["customApiProvide"],data:function(){return{dialogVisible:!1,loading:!1,apiDetail:{},logData:null,response:null,isShowRequest:!0,isShowLog:!0,isShowResult:!0}},computed:{time:function(){return this.logData?this.logData.scriptResult.endTime-this.logData.scriptResult.beginTime:0},status:function(){var e,t;return null!==(e=this.logData)&&void 0!==e&&null!==(t=e.scriptResult)&&void 0!==t&&t.success?"执行成功":"执行失败"},logMessage:function(){return this.logData&&this.logData.scriptResult.log||"无数据"}},methods:{handleClose:function(e){this.apiDetail={},this.logData=null,this.selectedAction=null,this.selectedStep=null,this.responseHeight=0,this.isShowResponse=!1,this.response=null,this.isShowRequest=!0,this.dialogVisible=!1,e()},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.apiDetail;this.apiDetail=t,this.handleMock(),this.dialogVisible=!0},handleMock:function(){var e=this;this.loading=!0,this.$http({url:i.default.apiDesignMockRunApi,data:{sessionId:window[o.CUSTOM_API_SESSION_ID],api:this.apiDetail}}).then((function(t){e.response=t,window[o.CUSTOM_API_RESPONSE_MAP][e.apiDetail.id]=e.response,e.handleGetLog()})).catch((function(){e.dialogVisible=!1})).finally((function(){e.loading=!1}))},handleExport:function(){},handleGetLog:function(){var e=this;this.$http({url:i.default.apiDesignGetRunApiDetail,data:{sessionId:window[o.CUSTOM_API_SESSION_ID]}}).then((function(t){e.logData=t.data})).finally((function(){e.loading=!1}))}}};t.default=s},m4w2:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"settings-manage",attrs:{title:"应用设置",visible:e.dialogVisible,"close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0},on:{close:function(t){e.dialogVisible=!1}}},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"导航设置",name:"navigate"}},[a("el-form",[a("el-form-item",{attrs:{label:"显示导航"}},[a("el-switch",{on:{change:e.updateSetting},model:{value:e.settings.navigateShow,callback:function(t){e.$set(e.settings,"navigateShow",t)},expression:"settings.navigateShow"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"导航位置"}},[a("el-radio-group",{on:{change:e.updateSetting},model:{value:e.settings.navigatePosition,callback:function(t){e.$set(e.settings,"navigatePosition",t)},expression:"settings.navigatePosition"}},[a("el-radio-button",{attrs:{label:"left"}},[e._v("左侧")]),e._v(" "),a("el-radio-button",{attrs:{label:"top"}},[e._v("顶部")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"显示工具栏"}},[a("el-switch",{on:{change:e.updateSetting},model:{value:e.settings.headerShow,callback:function(t){e.$set(e.settings,"headerShow",t)},expression:"settings.headerShow"}})],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"调试设置",name:"debug"}},[a("el-form",[a("el-form-item",{attrs:{label:"编辑页调试"}},[a("el-switch",{on:{change:e.updateSetting},model:{value:e.settings.edit,callback:function(t){e.$set(e.settings,"edit",t)},expression:"settings.edit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预览页调试"}},[a("el-switch",{on:{change:e.updateSetting},model:{value:e.settings.preview,callback:function(t){e.$set(e.settings,"preview",t)},expression:"settings.preview"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)],1)},i=[]},mC5a:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog",width:"80%",visible:e.visible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.onClose}},[e.loading?a("div",{staticClass:"loading-wrap"},[a("i",{staticClass:"el-icon-loading"})]):e._e(),e._v(" "),a("data-source")],1)},i=[]},mpsT:function(e,t,a){"use strict";a("xc0H")},nDTW:function(e,t,a){"use strict";a("t6MG")},nHGG:function(e,t,a){"use strict";a("tASM")},nUOe:function(e,t,a){},nfOR:function(e,t,a){"use strict";a("ws0p")},nl3a:function(e,t,a){},nvO3:function(e,t,a){"use strict";a.r(t);var n=a("SPUz"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},o1ZN:function(e,t,a){},oAoA:function(e,t,a){var n=a("PJp+");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("fbec8984",n,!0,{})},oipZ:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("HaE+")),s=n(a("YLtl")),r=n(a("lrFb")),l=n(a("WOyx")),c=n(a("8087")),u=n(a("p1zo")),d=n(a("7ota")),p=n(a("74Pu")),f=n(a("ZGo6")),v=n(a("2o9+")),m=n(a("bbu0")),h=n(a("Qn9X")),g=a("xBdn"),b=n(a("KAmc")),y=a("0O+R"),_=a("8SHQ"),C=a("fZI4"),w=[{key:"in_param",name:"入参定义",desc:"API的入参定义，对象格式"}],k=[{key:"in_param",name:"入参定义",desc:"API的入参定义，对象格式"},{key:"out_param",name:"返回值定义",desc:"程序会返回代码中同名的变量"}],S={name:"ApiItem",components:{JsonCode:r.default,JsonEditor:l.default,StepItem:c.default,ApiList:u.default,Publish:d.default,ApiMock:p.default,JsCode:v.default,GroovyCode:m.default,PythonCode:h.default,ApiScriptMock:f.default},props:{apiData:{type:Object},apiGroupList:{type:Array,default:function(){return[]}}},provide:function(){return{customApiProvide:{apiDetail:this.formData}}},data:function(){return{loading:!1,activeMenu:"apiDefine",activeJsonType:"tree",formData:{appId:+this.$route.query.id,description:"",groupId:void 0,name:"",path:"",requestBody:{},status:void 0,steps:[],useScript:!1,scriptConfig:{scriptType:"GROOVY",script:""}},rules:{name:(0,g.getValidators)([{message:"请输入API名称",include:g.required,trigger:"change",required:!0}]),groupId:(0,g.getValidators)([{message:"请选择分组",include:g.required,trigger:"change",required:!0}]),path:(0,g.getValidators)([{message:"请输入路径",include:g.required,trigger:"change",required:!0}])},pathPrepend:"/app".concat(this.$route.query.id,"/"),editorFocus:!1}},computed:{statusMap:function(){switch(this.formData.status){case 0:return{type:"",title:"未发布"};case 1:return{type:"warning",title:"发布中"};case 2:return{type:"success",title:"已发布"};case 3:return{type:"danger",title:"已下线"};default:return{type:"info",title:"草稿"}}},templateText:function(){var e,t;return null!==(e=this.formData)&&void 0!==e&&null!==(t=e.scriptConfig)&&void 0!==t&&t.script||this.editorFocus||this.isShowLog?"":this.templateContent},templateContent:function(){var e,t;switch(null===(e=this.formData)||void 0===e||null===(t=e.scriptConfig)||void 0===t?void 0:t.scriptType){case"JAVASCRIPT":return"支持JS原生语法，使用“参数名”进行取值, 使用return返回结果，示例JS：<br>\nvar age = in_param.age; <br>\nreturn age + 1;";case"GROOVY":return"支持Groovy语法，使用“参数名”进行取值，示例Groovy：<br>\ndef age = in_param.age; <br>\nreturn age + 1;";case"PYTHON":return"支持Python语法，使用“参数名”进行取值，示例Python：<br>\nage = in_param['age'] <br>\nout_param= age + 1"}},paramsData:function(){var e,t,a=[{key:"in_param",value:{},test:{}}];switch(null===(e=this.formData)||void 0===e||null===(t=e.scriptConfig)||void 0===t?void 0:t.scriptType){case"JAVASCRIPT":case"GROOVY":return a;case"PYTHON":return[{key:"in_param",value:{},test:{}},{key:"out_param",value:{},test:{}}]}},innerParams:function(){var e,t;switch(null===(e=this.formData)||void 0===e||null===(t=e.scriptConfig)||void 0===t?void 0:t.scriptType){case"JAVASCRIPT":case"GROOVY":return w;case"PYTHON":return k}},scriptCode:{get:function(){var e,t,a=(null===(e=this.formData)||void 0===e||null===(t=e.scriptConfig)||void 0===t?void 0:t.script)||"";return(0,C.decryptByDES)(a)},set:function(e){this.formData.scriptConfig.script=(0,C.encryptByDES)(e)}}},watch:{apiData:{deep:!0,immediate:!0,handler:function(e,t){var a=this;e.id||s.default.isEqual(e,t)||(Object.assign(this.formData,e),this.formData.requestBody=s.default.cloneDeep(e.requestBody),this.formData.steps=s.default.cloneDeep(e.steps),this.$nextTick((function(){a.$refs.apiDefineForm.clearValidate()}))),e.id&&this.getApiDetailById(e.id)}}},methods:{getApiDetailById:function(e,t){var a=this;this.loading=!0,this.$http({url:b.default.apiDesignDetail,data:{id:e}}).then((function(e){Object.assign(a.formData,e.data),a.formData.useScript||(a.formData.useScript=!1,a.formData.scriptConfig={scriptType:"GROOVY",script:""}),t&&(a.formData.status=void 0,a.formData.id=void 0)})).finally((function(){a.loading=!1}))},handleAddStep:function(){var e={actions:[],apiId:this.formData.id,code:(0,y.getRandomHexadecimal)(6),config:{ignoreError:!1,timeout:5},name:""};this.formData.steps.push(e)},handleApiChange:function(e){this.getApiDetailById(e[0].id,!0)},handleMock:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.activeMenu="apiDefine",t.next=3,e.$refs.apiDefineForm.validate();case 3:if(e.formData.path){t.next=6;break}return e.$message.error("请输入路径！"),t.abrupt("return");case 6:if(!e.formData.requestBody){t.next=17;break}if(s.default.isObject(e.formData.requestBody)){t.next=10;break}return e.$message.error("入参定义必须为对象！"),t.abrupt("return");case 10:if(!Array.isArray(e.formData.requestBody)){t.next=17;break}if(!e.formData.requestBody.length){t.next=16;break}return e.$message.error("入参定义必须为对象！"),t.abrupt("return");case 16:e.formData.requestBody={};case 17:if(!e.formData.useScript){t.next=23;break}if(e.formData.scriptConfig.script){t.next=21;break}return e.$message.error("代码不能为空！"),t.abrupt("return");case 21:return e.$refs.apiScriptMock.open({apiDetail:e.formData}),t.abrupt("return");case 23:if(null!==(a=e.formData.steps)&&void 0!==a&&a.length){t.next=26;break}return e.$message.error("请配置业务逻辑！"),t.abrupt("return");case 26:if(!e.formData.steps.some((function(e){return!e.name}))){t.next=29;break}return e.$message.error("请输入步骤名称！"),t.abrupt("return");case 29:e.$refs.apiMock.open({apiDetail:e.formData});case 30:case"end":return t.stop()}}),t)})))()},handleRemove:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("删除后不可恢复","确认删除API吗？",{type:"error"});case 2:e.loading=!0,e.$http({url:b.default.apiDesignRemove,data:{id:e.formData.id}}).then((function(t){e.$emit("refresh"),e.$message.success("删除成功！")})).finally((function(){e.loading=!1}));case 4:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.activeMenu="apiDefine",t.next=3,e.$refs.apiDefineForm.validate();case 3:if(e.formData.path){t.next=6;break}return e.$message.error("请输入路径！"),t.abrupt("return");case 6:if(!e.formData.requestBody){t.next=17;break}if(s.default.isObject(e.formData.requestBody)){t.next=10;break}return e.$message.error("入参定义必须为对象！"),t.abrupt("return");case 10:if(!Array.isArray(e.formData.requestBody)){t.next=17;break}if(!e.formData.requestBody.length){t.next=16;break}return e.$message.error("入参定义必须为对象！"),t.abrupt("return");case 16:e.formData.requestBody={};case 17:if(!e.formData.useScript){t.next=23;break}if(e.formData.scriptConfig.script){t.next=21;break}return e.$message.error("代码不能为空！"),t.abrupt("return");case 21:t.next=29;break;case 23:if(null!==(a=e.formData.steps)&&void 0!==a&&a.length){t.next=26;break}return e.$message.error("请配置业务逻辑！"),t.abrupt("return");case 26:if(!e.formData.steps.some((function(e){return!e.name}))){t.next=29;break}return e.$message.error("请输入步骤名称！"),t.abrupt("return");case 29:e.loading=!0,e.$http({url:b.default.apiDesignSaveOrUpdate,data:JSON.parse(JSON.stringify(e.formData,(function(e,t){return void 0===t?null:t})))}).then((function(t){void 0===e.formData.status&&(e.formData.status=0),e.formData.id=t.data,e.$message.success("保存成功！"),e.$emit("update")})).finally((function(){e.loading=!1}));case 31:case"end":return t.stop()}}),t)})))()},handlePublish:function(){var e=window[_.CUSTOM_API_RESPONSE_MAP][this.formData.id];this.$refs.publish.open({apiData:this.formData,response:e})},handleUnpublish:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("API下线后将无法被调用","是否下线自定义API",{type:"warning"});case 2:e.loading=!0,e.$http({url:b.default.apiDesignUnpublish,data:{id:e.formData.id}}).then((function(t){e.formData.status=3,e.$emit("update"),e.$message.success("下线成功！")})).finally((function(){e.loading=!1}));case 4:case"end":return t.stop()}}),t)})))()},changeScriptType:function(e){e!==this.formData.scriptConfig.scriptType&&(this.formData.scriptConfig.scriptType=e)},focusChange:function(e){this.editorFocus=e}}};t.default=S},p1zo:function(e,t,a){"use strict";a.r(t);var n=a("DWmU"),i=a("nvO3");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("IsbH");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"45bc5472",null);t.default=r.exports},p4Xy:function(e,t,a){"use strict";a.r(t);var n=a("Rv1O"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},pAkb:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],attrs:{"custom-class":"low-code-dialog",width:"80%",visible:e.visible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.onClose}},[e.loading?a("div",{staticClass:"loading-wrap"},[a("i",{staticClass:"el-icon-loading"})]):e._e(),e._v(" "),a("DataModelList")],1)},i=[]},qU0l:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"step-item"},[a("div",{staticClass:"step-left"},[a("div",{staticClass:"step-index"},[e._v(e._s(e.order))]),e._v(" "),a("div",{staticClass:"step-line"}),e._v(" "),a("div",{staticClass:"step-arrow"})]),e._v(" "),a("div",{staticClass:"step-right"},[a("i",{staticClass:"step-remove el-icon-circle-close",on:{click:e.handleRemoveStep}}),e._v(" "),a("div",{staticClass:"name right-item"},[a("div",{staticClass:"label",staticStyle:{"align-items":"center"}},[e._v("步骤名称")]),e._v(" "),a("div",{staticClass:"content"},[a("el-input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入步骤名称"},model:{value:e.stepData.name,callback:function(t){e.$set(e.stepData,"name","string"==typeof t?t.trim():t)},expression:"stepData.name"}}),e._v(" "),a("el-popover",{ref:"popover",attrs:{width:"300",trigger:"click",placement:"right",title:"执行规则"}},[a("n-form",{attrs:{"label-position":"left","label-width":"100px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("n-form-item",{attrs:{label:"超时时间（秒）"}},[a("el-input-number",{attrs:{min:1,max:60},model:{value:e.stepData.config.timeout,callback:function(t){e.$set(e.stepData.config,"timeout",t)},expression:"stepData.config.timeout"}})],1),e._v(" "),a("n-form-item",{attrs:{label:"忽略异常继续"}},[a("el-switch",{model:{value:e.stepData.config.ignoreError,callback:function(t){e.$set(e.stepData.config,"ignoreError",t)},expression:"stepData.config.ignoreError"}})],1)],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"24px","margin-right":"20px"},attrs:{slot:"reference"},slot:"reference"},[e._v("规则")])],1)],1)]),e._v(" "),a("div",{staticClass:"actions right-item"},[a("div",{staticClass:"label"},[a("div",[e._v("\n          逻辑定义\n          "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("span",{attrs:{slot:"content"},slot:"content"},[e._v("逻辑之间为并行关系")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)]),e._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"actions-item-wrapper"},[e.stepData.actions.length?e._l(e.stepData.actions,(function(t){return a("div",{key:t.code,staticClass:"actions-item",on:{click:function(a){return e.handleEditAction(t)}}},[a("div",{staticClass:"action-handler"}),e._v(" "),a("span",{staticClass:"action-name"},[e._v(e._s(t.name))]),e._v(" "),a("i",{staticClass:"action-remove el-icon-close",on:{click:function(a){return a.stopPropagation(),e.handleRemoveAction(t)}}})])})):a("div",{staticClass:"actions-empty"},[e._v("暂无数据")])],2),e._v(" "),a("div",{staticClass:"btn-wrapper"},[a("el-popover",{ref:"popover",attrs:{width:"200",trigger:"click",placement:"right",title:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAddAction(1)}}},[e._v("调用API")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAddAction(2)}}},[e._v("调用SQL")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"24px","margin-right":"20px"},attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v("新增")])],1)],1)])]),e._v(" "),a("div",{staticClass:"response right-item"},[a("div",{staticClass:"label"},[e._v("步骤出参")]),e._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"res-top"},[e.stepData.mapConfig?a("el-tag",{attrs:{closable:"","disable-transitions":""},on:{click:e.handleFormat,close:e.handleRemoveFormat}},[e._v("重新配置格式化")]):a("el-button",{on:{click:e.handleFormat}},[e._v("格式化")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("span",{attrs:{slot:"content"},slot:"content"},[e._v("非必填，支持对当前步骤的出参进行数值、文本或布尔等类型的格式化操作")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("div",{staticClass:"res-bottom"},[a("div",{staticClass:"response-text"},[a("el-popover",{attrs:{placement:"bottom",title:"",width:e.popoverWidth,trigger:"click"}},[a("div",{staticClass:"body"},[a("vue-json-pretty",{directives:[{name:"show",rawName:"v-show",value:e.response,expression:"response"}],staticClass:"json-pretty",attrs:{data:e.response,virtual:!0,itemHeight:32}}),e._v(" "),e.response?e._e():a("div",{staticClass:"empty-text"},[e._v("暂无数据，请点击测试")])],1),e._v(" "),a("el-select",{staticStyle:{width:"100%"},attrs:{slot:"reference","popper-class":"tree-select-popper-trigger",placeholder:"{ }"},on:{focus:e.handleUpdateResponse},slot:"reference"})],1)],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"23px","margin-right":"21px","margin-top":"10px"},attrs:{type:"primary"},on:{click:e.handleMock}},[e._v("测试")])],1)])])]),e._v(" "),a("ActionConfig",{ref:"actionConfig",on:{confirm:e.handleSaveAction}}),e._v(" "),a("StepMock",{ref:"stepMock"}),e._v(" "),a("Formatter",{ref:"formatter",on:{confirm:e.handleFormatConfirm}})],1)},i=[]},qihi:function(e,t,a){"use strict";a.r(t);var n=a("yINx"),i=a("5PXa");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("yFiB"),a("k6MW");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"978f516c",null);t.default=r.exports},qsS1:function(e,t,a){"use strict";a("3tqg")},r8Az:function(e,t,a){},rCLk:function(e,t,a){"use strict";a.r(t);var n=a("9yPJ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},rChg:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("rePB")),o=n(a("ODXe")),s=n(a("YLtl")),r=n(a("KAmc")),l=n(a("cBEb")),c=n(a("/Vzg")),u=n(a("2o9+")),d=n(a("bbu0")),p=n(a("Qn9X")),f=n(a("PHku")),v=a("a+hW"),m=a("fZI4");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={mode:"STANDARD",standardMapConfig:{children:[],type:"Object"}},y={name:"Formatter",components:{TreeChange:l.default,JsonView:c.default,JsCode:u.default,GroovyCode:d.default,PythonCode:p.default},mixins:[f.default],data:function(){return{loading:!1,dialogVisible:!1,mapConfig:void 0,stepData:null,editorFocus:!1,isShowLog:!1,logList:[]}},computed:{title:function(){var e;return"STANDARD"===(null===(e=this.mapConfig)||void 0===e?void 0:e.mode)?"出参格式化标准模式":"出参格式化专业模式"},templateText:function(){var e,t;return null!==(e=this.mapConfig)&&void 0!==e&&null!==(t=e.professionalMapConfig)&&void 0!==t&&t.script||this.editorFocus||this.isShowLog?"":this.templateContent},templateContent:function(){var e,t;switch(null===(e=this.mapConfig)||void 0===e||null===(t=e.professionalMapConfig)||void 0===t?void 0:t.scriptType){case"JAVASCRIPT":return"支持JS原生语法，使用“参数名”进行取值, 使用return返回结果，示例JS：<br>\nvar age = in_param.age; <br>\nreturn age + 1;";case"GROOVY":return"支持Groovy语法，使用“参数名”进行取值，示例Groovy：<br>\ndef age = in_param.age; <br>\nreturn age + 1;";case"PYTHON":return"支持Python语法，使用“参数名”进行取值，示例Python：<br>\nage = in_param['age'] <br>\nout_param= age + 1"}},paramsData:function(){return this.params.map((function(e){return{key:e.key,value:e.value,test:e.mockValue}}))},params:function(){var e,t;return(null===(e=this.mapConfig)||void 0===e||null===(t=e.professionalMapConfig)||void 0===t?void 0:t.params)||[]},paramsSource:{get:function(){return{params:Object.fromEntries(this.params.map((function(e){return[[e.key],e.value]})))}},set:function(e){this.mapConfig.professionalMapConfig.params=Object.entries(e).map((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];return{key:a,value:n,mockValue:n}}))}}},methods:{handleClose:function(e){this.dialogVisible=!1,e()},handleConfirm:function(){this.mapConfig.professionalMapConfig&&(this.mapConfig.professionalMapConfig.script=(0,m.encryptByDES)(this.mapConfig.professionalMapConfig.script),this.mapConfig.professionalMapConfig.params=this.mapConfig.professionalMapConfig.params.filter((function(e){return e.key}))),this.$emit("confirm",this.mapConfig),this.dialogVisible=!1},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stepData;this.stepData=s.default.cloneDeep(t),this.mapConfig=this.stepData.mapConfig||s.default.cloneDeep(b),this.mapConfig.standardMapConfig.children=this.mapConfig.standardMapConfig.children.length?this.mapConfig.standardMapConfig.children:[{key:"",type:"String"}],this.mapConfig.professionalMapConfig&&(this.mapConfig.professionalMapConfig.script=(0,m.decryptByDES)(this.mapConfig.professionalMapConfig.script),this.mapConfig.professionalMapConfig.params=this.mapConfig.professionalMapConfig.params.length?this.mapConfig.professionalMapConfig.params:[{key:"",value:void 0,mockValue:void 0}]),this.dialogVisible=!0},changeMode:function(){this.mapConfig.mode="STANDARD"===this.mapConfig.mode?"PROFESSIONAL":"STANDARD","PROFESSIONAL"===this.mapConfig.mode&&(this.mapConfig.professionalMapConfig||this.$set(this.mapConfig,"professionalMapConfig",{script:"",scriptType:"GROOVY",params:[{key:"",value:void 0,mockValue:void 0}]}))},handleShowTree:function(){this.$refs.jsonView.open({treeData:this.mapConfig.standardMapConfig.children})},handleShowTreeChange:function(){this.$refs.treeChange.open({stepData:this.stepData})},handleTreeChangeConfirm:function(e){var t=(0,v.getMapTree)(e,"$".concat(this.stepData.code));this.mapConfig.standardMapConfig.children=t.length?t:[{key:"",type:"String"}]},focusChange:function(e){this.editorFocus=e,e&&(this.isShowLog=!1)},changeScriptType:function(e){e!==this.mapConfig.professionalMapConfig.scriptType&&(this.mapConfig.professionalMapConfig.scriptType=e)},handleAddParams:function(){this.mapConfig.professionalMapConfig.params.push({key:"",value:void 0,mockValue:void 0})},handleDeleteParams:function(e){var t=this.mapConfig.professionalMapConfig.params;if(1===t.length)return t[0].key="",t[0].value=void 0,void(t[0].mockValue=void 0);t.splice(e,1)},handleMockScript:function(){var e=this;this.loading=!0,this.$http({url:r.default.apiDesignMockEvalScript,data:g(g({},this.mapConfig.professionalMapConfig),{},{params:this.mapConfig.professionalMapConfig.params.filter((function(e){return e.key})),script:(0,m.encryptByDES)(this.mapConfig.professionalMapConfig.script)})}).then((function(t){e.logList.push(t.data),e.isShowLog=!0})).finally((function(){e.loading=!1}))},handleClearLog:function(){this.logList=[]}}};t.default=y},rJQu:function(e,t,a){"use strict";a.r(t);var n=a("+G4H"),i=a("MqYS");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("9LRD"),a("Pw7p");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"46bf5383",null);t.default=r.exports},rcpd:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"condition-panel-inner"},[e.condition.conditionItems.length?e._e():[a("div",{staticClass:"condition-item"},[a("div",{staticClass:"setting"},[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddCondition}},[e._v("\n            +\n          ")])])])])],e._v(" "),e._l(e.condition.conditionItems,(function(t,n){return a("div",{key:t,staticClass:"condition-item"},[a("n-table",{attrs:{data:t.items,border:"","header-cell-class-name":"header-cell"}},[e.isShowLeft?a("n-table-column",{attrs:{label:"条件配置内容"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"value-input"},[void 0!==t.row.left.value||t.row.left.source.name?a("el-tooltip",{attrs:{effect:"dark",content:e.formatCTip(t.row.left),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getCTagType(t.row.left)},on:{click:function(a){return e.handleCTagClick(t.row.left)},close:function(a){return e.handleClearValue(t.row.left)}}},[e._v("\n              "+e._s(e.formatCTag(t.row.left))+"\n            ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("text",t.row.left,"value",t.row.left)}}},[e._v("文本\n              ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("number",t.row.left,"value",t.row.left)}}},[e._v("数值\n              ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("object",t.row.left,"value",t.row.left)}}},[e._v("对象\n              ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleShowVariableSelect(t.row.left.source,"name",(function(){t.row.left.value=void 0}))}}},[e._v("选择出参\n              ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.left.value=e}}})],1)],1)}}],null,!0)}):e._e(),e._v(" "),a("n-table-column",{attrs:{label:"规则",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini"},model:{value:t.row.op,callback:function(a){e.$set(t.row,"op",a)},expression:"scope.row.op"}},e._l(e.ruleOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!0)}),e._v(" "),a("n-table-column",{attrs:{label:"值"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"value-input"},[void 0!==t.row.right.value||t.row.right.source.name?a("el-tooltip",{attrs:{effect:"dark",content:e.formatCTip(t.row.right),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getCTagType(t.row.right)},on:{click:function(a){return e.handleCTagClick(t.row.right)},close:function(a){return e.handleClearValue(t.row.right)}}},[e._v("\n              "+e._s(e.formatCTag(t.row.right))+"\n            ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[e.isShowLeft?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("text",t.row.right,"value",t.row.right)}}},[e._v("文本\n              ")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("number",t.row.right,"value",t.row.right)}}},[e._v("数值\n              ")]),e._v(" "),e.isShowLeft?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showInputDialog("object",t.row.right,"value",t.row.right)}}},[e._v("对象\n              ")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleShowVariableSelect(t.row.right.source,"name",(function(e){t.row.right.value=void 0}))}}},[e._v("选择出参\n              ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.right.value=e}}})],1)],1)}}],null,!0)}),e._v(" "),a("n-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(n){return[a("div",{staticClass:"control-col"},[n.$index!==t.items.length-1?a("el-switch",{attrs:{"active-value":"or","inactive-value":"and","active-text":"或","inactive-text":"且"},model:{value:n.row.logic,callback:function(t){e.$set(n.row,"logic",t)},expression:"scope.row.logic"}}):e._e(),e._v(" "),a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:function(a){return e.handleAddConditionChild(n.$index,t.items)}}},[e._v("\n                +\n              ")]),e._v(" "),a("div",{staticClass:"add-btn-primary",on:{click:function(a){return e.handleDeleteConditionChild(n.$index,t.items)}}},[e._v("\n                -\n              ")])])],1)]}}],null,!0)})],1),e._v(" "),a("div",{staticClass:"setting"},[n!==e.condition.conditionItems.length-1?a("el-switch",{attrs:{"active-value":"or","inactive-value":"and","active-text":"或","inactive-text":"且"},model:{value:t.logic,callback:function(a){e.$set(t,"logic",a)},expression:"c.logic"}}):e._e(),e._v(" "),a("div",{staticClass:"btns"},[n===e.condition.conditionItems.length-1?a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddCondition}},[e._v("\n          +\n        ")]):e._e(),e._v(" "),e.condition.conditionItems.length>1?a("div",{staticClass:"add-btn-primary",on:{click:function(t){return e.handleDeleteCondition(n)}}},[e._v("\n          -\n        ")]):e._e()])],1)],1)})),e._v(" "),a("input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}}),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",attrs:{showSelf:e.showSelf},on:{confirm:e.handleVariableConfirm}})],2)},i=[]},reC4:function(e,t,a){"use strict";a.r(t);var n=a("oipZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},rulp:function(e,t,a){"use strict";a("0tbR")},rwbg:function(e,t,a){var n=a("Il8n");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("b72b56f6",n,!0,{})},sOD7:function(e,t,a){"use strict";var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("o0o1")),s=n(a("HaE+")),r=n(a("rePB")),l=n(a("KQm4")),c=n(a("slWK")),u=a("cCei"),d=a("S5C5"),p=a("7Qib"),f=a("WIBD"),v=n(a("/S23")),m=n(a("Nxdt")),h=n(a("Ut2/")),g=n(a("g9be")),b=n(a("Y3Tp")),y=n(a("ayh6")),_=n(a("AZVa")),C=a("CDKT"),w=n(a("OFET")),k=a("0O+R"),S=a("ZDQs"),x=a("oYx3"),D=a("inkn"),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var a=V(t);if(a&&a.has(e))return a.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var r=o?Object.getOwnPropertyDescriptor(e,s):null;r&&(r.get||r.set)?Object.defineProperty(n,s,r):n[s]=e[s]}n.default=e,a&&a.set(e,n);return n}(a("ZQwl")),P=a("vu0G"),T=n(a("JJ33")),I=n(a("F4BC")),N=n(a("qihi")),A=a("7C5+");function V(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(V=function(e){return e?a:t})(e)}function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,r.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $={name:"PageHeader",components:{DataModel:m.default,DataSource:h.default,AppVariables:g.default,DataSetManage:b.default,KeyTip:y.default,CustomApi:_.default,SourceManage:T.default,settingsManage:I.default,PageHistoryManage:N.default},inject:["dndOptions"].concat((0,l.default)(A.pageInject)),computed:{pageId:function(){return this.getStore().layoutData.pageDesignId},layoutData:function(){return this.getStore().layoutData},dynamicProps:function(){return this.getStore().dynamicProps}},data:function(){return{redoLength:0,undoLength:0,info:{},statusMap:{1:{name:"未上架",type:"info"},2:{name:"已上架",type:"success"},3:{name:"已下架",type:"danger"}},clipboard:{elementId:void 0,type:"copy"}}},created:function(){this.getAppInfo()},methods:M(M(M({},(0,f.mapMutations)({setVersionInfo:v.default.VERSION_INFO})),(0,f.mapActions)({judgeVersion:v.default.VERSION_JUDGE})),{},{handleGoBack:function(){(0,D.goBack)(this)},handleGoForward:function(){(0,D.goForward)(this)},getAppInfo:function(){var e=this;this.$http({url:c.default.appDesignDetail,data:{id:this.$route.query.vid}}).then((function(t){e.info=t.data,e.setVersionInfo(e.info),e.judgeVersion({message:"当前版本".concat({2:"已上架",3:"已下架"}[e.info.status],"，无法编辑，是否生成新版本？")})}))},goBack:function(){var e=this;return(0,s.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._storeDispatch(u.CONFIRM_SAVE_CONFIG);case 2:history.length>2?rootApp.$router.back():rootApp.$router.replace({name:x.authKey.AppDetail,query:{id:e.$route.query.id}});case 3:case"end":return t.stop()}}),t)})))()},ctlrSave:function(e){var t=this;null==e||e.preventDefault(),(0,p.dialogOpend)()||(this.$refs.saveBtn&&this.$refs.saveBtn.$el.focus(),this.$nextTick((function(){t.handleSave()})))},handleSave:function(e){this._storeDispatch(u.SAVE_PAGE_CONFIG)},openPreview:function(e){var t=this;return(0,s.default)(o.default.mark((function a(){var n,i,s,r;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:null==e||e.preventDefault(),n=t.$route.query,i=n.vid,s=n.id,r={appVersionId:i,appId:s,pageId:t.pageId},(0,d.jumpPreview)(r);case 4:case"end":return a.stop()}}),a)})))()},handleScreen:function(){(0,p.fullScreen)()},handleMoreClick:function(e){switch(e){case"app":this.handleShowAppVariables();break;case"dataset":this.handleShowDataSetManage();break;case"events":this.handleShowEventManage();break;case"source":this.$refs.sourceManage.open();break;case"settings":this.$refs.settingsManage.open();break;case"dataModel":this.$refs.dataModel.open()}},handleShowAppVariables:function(){this.$refs.appVariables.open()},handleShowDataSetManage:function(){this.$refs.dataSetManage.open()},handleShowEventManage:function(){this.$refs.eventSelect.open({isManage:!0})},handleUpdateLength:function(e){var t=e.detail,a=t.redoLength,n=t.undoLength;this.redoLength=a,this.undoLength=n},isInDynamicContainer:function(e){var t=(0,k.getParentNodeByElementId)(this.layoutData.children,e);return t&&["dynamic-container"].includes(t.elementType)},isInSlot:function(e){var t=(0,k.getParentNodeByElementId)(this.layoutData,e);return t&&["slot"].includes(t.elementType)},isInGrid:function(e){var t=(0,k.getParentNodeByElementId)(this.layoutData,e);return t&&["grid-dnd"].includes(t.elementType)},isInForm:function(e){var t=(0,k.getParentNodeListByElementId)(this.layoutData,e);return t&&t.some((function(e){return["form-container"].includes(e.elementType)}))},getPlacement:function(e){var t=this,a=e.currentElement,n=e.draggingWidget,i=e.parentElement,o=this.getElementPropsById(a.elementId);if(a.elementId===this.layoutData.elementId)return"center";var s=i&&["slot"].includes(i.elementType),r=i&&["dynamic-container"].includes(i.elementType),l=a.elementType;switch(!0){case o.canDropInsideTypes&&!o.canDropInsideTypes.includes(n.elementType)&&!["slot"].includes(a.elementType):case o.ignoreDropInsideTypes&&o.ignoreDropInsideTypes.includes(n.elementType)&&!["slot"].includes(a.elementType):return"bottom";case s&&this.getElementPropsById(i.elementId).canDropInsideTypes&&!this.getElementPropsById(i.elementId).canDropInsideTypes.includes(n.elementType):return;case r:return["layout","grid-dnd","dynamic-container"].includes(l)&&!a.children.filter((function(e){return!1!==t.getElementPropsById(e.elementId).isVisible})).length?"center":void 0;case S.canDropInsideTypes.includes(l)&&!a.children.filter((function(e){return!1!==t.getElementPropsById(e.elementId).isVisible&&!["dialog-container"].includes(e.elementType)})).length:return["layout"].includes(l)?["layout"].includes(n.elementType)&&["layout-container","form-container"].includes(i.elementType)?"bottom":["layout-container","form-container"].includes(i.elementType)?"center":"bottom":["grid-dnd"].includes(l)?"bottom":["dynamic-container"].includes(l)?(["dynamic-container"].includes(n.elementType),"bottom"):"center";case S.canDropInsideTypes.includes(l)&&a.children.length&&a.children.some((function(e){return!1!==t.getElementPropsById(e.elementId).isVisible&&!["dialog-container"].includes(e.elementType)})):return["layout"].includes(l)?["layout"].includes(n.elementType)&&["layout-container","form-container"].includes(i.elementType)?"bottom":["layout-container","form-container"].includes(i.elementType)?void 0:"bottom":["grid-dnd","dynamic-container"].includes(l)||["layout-container","form-container"].includes(l)?"bottom":void 0}return"bottom"},handleDelete:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a,n=(0,k.getNodeByElementId)(this.layoutData||[],t);if(n&&!S.ignoreDeleteTypes.includes(n.elementType))k.removeLayoutElement.call(this,t,null===(a=this.layoutData)||void 0===a?void 0:a.elementId)}}},handleUndo:function(e){e.target!==document.body||(0,p.dialogOpend)()||(e.preventDefault(),0!==this.redoLength&&this.handleGoBack())},handleRedo:function(e){e.target!==document.body||(0,p.dialogOpend)()||(e.preventDefault(),0!==this.undoLength&&this.handleGoForward())},handleCopy:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a=(0,k.getNodeByElementId)(this.layoutData||[],t);!a||S.ignoreCopyTypes.includes(a.elementType)||this.isInDynamicContainer(a.elementId)?(this.clipboard.elementId=void 0,this.clipboard.type="copy"):(this.clipboard.elementId=a.elementId,this.clipboard.type="copy")}}},handleCut:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a=(0,k.getNodeByElementId)(this.layoutData||[],t);!a||S.ignoreCopyTypes.includes(a.elementType)||this.isInDynamicContainer(a.elementId)?(this.clipboard.elementId=void 0,this.clipboard.type="cut"):(this.clipboard.elementId=a.elementId,this.clipboard.type="cut")}}},handlePaste:function(e){var t=this;return(0,s.default)(o.default.mark((function a(){var n,i,s,l,c,d,f,v,m,h,g,b,y,_,C,w,x,T,I,N,A;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.target===document.body&&!(0,p.dialogOpend)()){a.next=2;break}return a.abrupt("return");case 2:if(e.preventDefault(),n=t.clipboard,i=n.elementId,s=n.type,!i){a.next=52;break}if(!(d=(0,k.getNodeByElementId)(t.layoutData||[],i))||S.ignoreCopyTypes.includes(d.elementType)||t.isInDynamicContainer(d.elementId)){a.next=52;break}if(f=t.dndOptions.selectedId,v=(0,k.getNodeByElementId)(t.layoutData,f),m=(0,k.getParentNodeByElementId)(t.layoutData,f),S.dialogTypes.includes(i)||!S.dialogTypes.includes(v.elementType)){a.next=12;break}return a.abrupt("return");case 12:if("timer"===s||"timer"!==v.elementType){a.next=14;break}return a.abrupt("return");case 14:if(h=t.getPlacement({currentElement:v,draggingWidget:d,parentElement:m})){a.next=17;break}return a.abrupt("return");case 17:if("cut"!==s){a.next=24;break}if(i!==f){a.next=20;break}return a.abrupt("return");case 20:if(!(0,k.isIncludes)(d,f)){a.next=22;break}return a.abrupt("return");case 22:a.next=30;break;case 24:if("copy"!==s){a.next=30;break}return l=D.getGlobalConfig.call(t),c=d.elementId,a.next=29,t._storeDispatch(u.HANDLE_COPY,{elementId:d.elementId});case 29:d=a.sent;case 30:if(S.dialogTypes.includes(d.elementType)&&(f="dialog-container",h="center",k.treeUtil.forEach(t.layoutData.children,(function(e){!S.dialogTypes.includes(e.elementType)&&"timer"!==e.elementType||e.elementId===d.elementId||O.globalEmit.call(t,P.PROPS,{elementId:e.elementId,data:{isVisible:!1}})}))),"timer"===d.elementType&&(f="timer-container",h="center",k.treeUtil.forEach(t.layoutData.children,(function(e){!S.dialogTypes.includes(e.elementType)&&"timer"!==e.elementType||e.elementId===d.elementId||O.globalEmit.call(t,P.PROPS,{elementId:e.elementId,data:{isVisible:!1}})}))),"center"!==h&&t.isInSlot(f)&&["data"].includes(t.getElementPropsById(m.elementId).slotType)&&t._storeCommit(u.UPDATE_DYNAMIC_PROPS,{dynamicProps:(0,r.default)({},d.elementId,{prop:t.getElementPropsById(m.elementId).slotName,useSlotProps:!0})}),S.formTypes.includes(d.elementType)&&t.isInForm(f)&&t._storeCommit(u.UPDATE_DYNAMIC_PROPS,{dynamicProps:(0,r.default)({},d.elementId,{useSlotProps:!0})}),!t.isInGrid(f)&&!["grid-dnd"].includes(v.elementType)){a.next=48;break}["grid-dnd"].includes(v.elementType)?(w=t.getElementPropsById(v.elementId),x=w.colNum,w.rowHeight,C=x):(T=t.getElementPropsById(m.elementId),I=T.colNum,T.rowHeight,C=I),N=t.getElementPropsById(v.elementId).layout||{},a.t0=h,a.next="bottom"===a.t0?40:"center"===a.t0?43:46;break;case 40:return y=N.x,_=N.y+N.h,a.abrupt("break",46);case 43:return y=0,_=0,a.abrupt("break",46);case 46:O.globalEmit.call(t,P.PROPS,{elementId:d.elementId,data:{layout:{i:d.elementId,x:y,y:_,w:(null===(g=t.getElementPropsById(d.elementId).layout)||void 0===g?void 0:g.w)||C,h:(null===(b=t.getElementPropsById(d.elementId).layout)||void 0===b?void 0:b.h)||6}},pushHistory:!1}),(t.isInGrid(f)&&"center"!==h||["grid-dnd"].includes(v.elementType)&&"center"===h)&&t._storeCommit(u.UPDATE_DYNAMIC_PROPS,{dynamicProps:(0,r.default)({},d.elementId,{styleConfigList:[{name:"根元素",query:"",styles:{overflowX:"auto",overflowY:"auto"},className:[],animation:[]}]})});case 48:A="copy"===s,k.insertElement.call(t,{rootTree:t.layoutData,targetId:f,placement:h,newNode:d,oldSelectedId:t.dndOptions.selectedId,pushHistory:!A}),A&&(0,D.update)({oldVal:c,val:d.elementId,extra:{oldVal:l,val:D.getGlobalConfig.call(t)},callback:function(e){O.default.$emit(P.HIGH_LIGHT,e)}}),setTimeout((function(){t.dndOptions.selectedId=d.elementId}));case 52:case"end":return a.stop()}}),a)})))()},handleUp:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a=(0,k.getParentNodeByElementId)(this.layoutData,t);if(a){if(["dialog-container"].includes(a.elementType))return;if(["page"].includes(a.elementType)){var n=a.children.findIndex((function(e){return e.elementId===t}))-1,i=a.children[n];return void(i&&!["dialog-container"].includes(i.elementType)&&(this.dndOptions.selectedId=i.elementId))}this.dndOptions.selectedId=a.elementId}}}},handleDown:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a,n=(0,k.getNodeByElementId)(this.layoutData,t),i=(0,k.getParentNodeByElementId)(this.layoutData,t);if(n.children.length)return["page"].includes(n.elementType)?void(this.dndOptions.selectedId=null===(a=n.children[1])||void 0===a?void 0:a.elementId):void(this.dndOptions.selectedId=n.children[0].elementId);if(i){var o=i.children.findIndex((function(e){return e.elementId===t}))+1,s=i.children[o];s&&(this.dndOptions.selectedId=s.elementId)}}}},handleLeft:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a=(0,k.getParentNodeByElementId)(this.layoutData,t);if(a){var n=a.children.findIndex((function(e){return e.elementId===t}))-1,i=a.children[n];i&&!["dialog-container"].concat((0,l.default)(S.dialogTypes)).includes(i.elementType)&&(this.dndOptions.selectedId=i.elementId)}}}},handleRight:function(e){if(e.target===document.body&&!(0,p.dialogOpend)()){e.preventDefault();var t=this.dndOptions.selectedId;if(t){var a=(0,k.getParentNodeByElementId)(this.layoutData,t);if(a){var n=a.children.findIndex((function(e){return e.elementId===t}))+1,i=a.children[n];i&&!["dialog-container"].concat((0,l.default)(S.dialogTypes)).includes(i.elementType)&&(this.dndOptions.selectedId=i.elementId)}}}},initKeyEvents:function(){w.default.bind("delete",this.handleDelete),w.default.bind("ctrl + z",this.handleUndo),w.default.bind("ctrl + shift > z",this.handleRedo),w.default.bind("ctrl + s",this.ctlrSave),w.default.bind("ctrl + p",this.openPreview),w.default.bind("ctrl + c",this.handleCopy),w.default.bind("ctrl + x",this.handleCut),w.default.bind("ctrl + v",this.handlePaste),w.default.bind("up",this.handleUp),w.default.bind("down",this.handleDown),w.default.bind("left",this.handleLeft),w.default.bind("right",this.handleRight)},handleunbindKeys:function(){w.default.unbind("delete",this.handleDelete),w.default.unbind("ctrl + z",this.handleUndo),w.default.unbind("ctrl + shift > z",this.handleRedo),w.default.unbind("ctrl + s",this.ctlrSave),w.default.unbind("ctrl + p",this.openPreview),w.default.unbind("ctrl + c",this.handleCopy),w.default.unbind("ctrl + x",this.handleCut),w.default.unbind("ctrl + v",this.handlePaste),w.default.unbind("up",this.handleUp),w.default.unbind("down",this.handleDown),w.default.unbind("left",this.handleLeft),w.default.unbind("right",this.handleRight)},showKeyTip:function(){this.$refs.keyTip.open()},handleOpenApi:function(){this.$refs.customApi.open()},getElementPropsById:function(e){var t="app"===e?this.getStore().layoutData.elementId:e;return this.getStore().dynamicProps[t]||{}},handleShowHistory:function(){this.$refs.pageHistoryManage.open()}}),mounted:function(){var e=this;window.addEventListener(C.UPDATE_HISTORY_LENGTH,this.handleUpdateLength),this.$nextTick((function(){e.initKeyEvents()}))},beforeDestroy:function(){this.handleunbindKeys(),window.removeEventListener(C.UPDATE_HISTORY_LENGTH,this.handleUpdateLength)}};t.default=$},sV6C:function(e,t,a){},spK8:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"block_content"},[e._l(e.value,(function(t,n){return a("div",{key:""+t.type+n,class:["block","clearfix",{"hide-block":!0===e.hideMyBlock[n]}]},[a("span",{staticClass:"json-key"},[["object","array"].includes(t.type)?a("i",{staticClass:"collapse-down el-icon-arrow-down",on:{click:function(t){return e.closeBlock(n,t)}}}):e._e(),e._v(" "),"string"==typeof t.name?a("el-input",{staticClass:"key-input",attrs:{title:e.formatTip(t.name),type:"text"},on:{blur:function(a){return e.keyInputBlur(t,a)}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}}):e._e()],1),e._v(" "),a("span",{staticClass:"json-val"},["object"===t.type?[a("json-view",{attrs:{showVariable:e.showVariable,valueLabel:e.valueLabel},model:{value:t.childParams,callback:function(a){e.$set(t,"childParams",a)},expression:"item.childParams"}})]:e._e(),e._v(" "),"array"===t.type?[a("array-view",{attrs:{showVariable:e.showVariable,valueLabel:e.valueLabel},model:{value:t.childParams,callback:function(a){e.$set(t,"childParams",a)},expression:"item.childParams"}})]:e._e(),e._v(" "),["object","array"].includes(t.type)?e._e():[a("span",{staticClass:"val"},["variable"===t.type||e.isValidateVariableParams(t.remark)?[t.remark&&"$global.__"!==t.remark?a("el-tag",{staticClass:"value-tag",attrs:{title:e.formatTip(t.remark),closable:"","disable-transitions":""},on:{click:function(a){return e.handleShowVariableSelect(t,"remark")},close:function(e){t.remark="$global.__"}}},[e._v("\n              "+e._s(e.formatTag(t.remark))+"\n            ")]):a("el-button",{on:{click:function(a){return e.handleShowVariableSelect(t,"remark")}}},[e._v("选择参数\n            ")]),e._v(" "),"$global.__"!==t.remark&&e.getElementName(t.remark)?a("el-tag",{staticClass:"value-tag",staticStyle:{"margin-left":"10px"},attrs:{title:e.getElementName(t.remark),type:e.getTagType(t.remark)}},[e._v(e._s(e.formatTag(e.getElementName(t.remark),12)))]):e._e()]:e._e(),e._v(" "),"string"!==t.type||e.isValidateVariableParams(t.remark)?e._e():a("el-input",{staticClass:"val-input",attrs:{title:e.formatTip(e.valueLabel+t.remark),type:"text"},model:{value:t.remark,callback:function(a){e.$set(t,"remark",a)},expression:"item.remark"}}),e._v(" "),"number"===t.type?a("el-input",{staticClass:"val-input",attrs:{title:e.formatTip(e.valueLabel+t.remark),type:"number"},on:{input:function(a){return e.numberInputChange(t)}},model:{value:t.remark,callback:function(a){e.$set(t,"remark",e._n(a))},expression:"item.remark"}}):e._e(),e._v(" "),"boolean"===t.type?a("el-select",{staticClass:"val-input",attrs:{title:e.formatTip(e.valueLabel+t.remark),name:"value"},model:{value:t.remark,callback:function(a){e.$set(t,"remark",a)},expression:"item.remark"}},[a("el-option",{attrs:{value:!0,label:"true"}}),e._v(" "),a("el-option",{attrs:{value:!1,label:"false"}})],1):e._e()],2)]],2),e._v(" "),a("div",{staticClass:"tools"},["object"===t.type?a("i",{staticClass:"i-type"},[e._v(e._s("{"+t.childParams.length+"}"))]):e._e(),e._v(" "),"array"===t.type?a("i",{staticClass:"i-type"},[e._v(e._s("["+t.childParams.length+"]"))]):e._e(),e._v(" "),a("el-select",{staticClass:"tools-types",on:{change:function(a){return e.itemTypeChange(t)}},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"item.type"}},e._l(e.formats,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label,disabled:"variable"===t.value&&!e.showVariable}})})),1),e._v(" "),e.editorProvide.showButtons?a("i",{staticClass:"del-btn",attrs:{title:"新增同级节点"},on:{click:e.addItem}},[a("i",{staticClass:"add-btn-primary"},[e._v("+")])]):e._e(),e._v(" "),e.editorProvide.showButtons?a("i",{staticClass:"del-btn",on:{click:function(a){return e.delItem(e.value,t,n)}}},[a("i",{staticClass:"add-btn-primary"},[e._v("-")])]):e._e()],1)])})),e._v(" "),!e.value.length&&e.editorProvide.showButtons?a("div",{staticClass:"block add-key",on:{click:e.addItem}},[a("i",{staticClass:"add-btn-primary",attrs:{title:"新增子节点"}},[e._v("+")])]):e._e()],2)},i=[]},t6MG:function(e,t,a){var n=a("0sKM");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("8bb4d5b2",n,!0,{})},t7PT:function(e,t,a){"use strict";a("v5Dq")},tASM:function(e,t,a){var n=a("c8t2");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("7a305b1b",n,!0,{})},tJX9:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("KAmc")),o=a("8SHQ"),s=a("E0s0");a("uD/U");var r={name:"StepMock",components:{VueJsonPretty:new s.Factory({virtualLines:50})},inject:["customApiProvide"],data:function(){return{dialogVisible:!1,loading:!1,stepData:{},logData:null,selectedAction:null,responseHeight:0,isShowResponse:!1,response:null,actionLogList:[]}},computed:{time:function(){return this.logData?this.logData.executeResult.endTime-this.logData.executeResult.beginTime:0},status:function(){var e,t;return null!==(e=this.logData)&&void 0!==e&&null!==(t=e.executeResult)&&void 0!==t&&t.success?"执行成功":"执行失败"},successCount:function(){var e,t;return(null===(e=this.logData)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.successCount)||0},failedCount:function(){var e,t;return(null===(e=this.logData)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.failedCount)||0},inputMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.input;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},outputMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.output;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},errorMsg:function(){var e,t,a=null===(e=this.selectedAction)||void 0===e||null===(t=e.executeResult)||void 0===t?void 0:t.errorReason;return a},sourceMsg:function(){var e,t,a=null===(e=this.logData)||void 0===e||null===(t=e.stepOutput)||void 0===t?void 0:t.output;return a?JSON.stringify(a,(function(e,t){return void 0===t?null:t}),2):"无数据"},formatMsg:function(){var e,t,a,n,i=null!==(e=this.logData)&&void 0!==e&&null!==(t=e.stepOutput)&&void 0!==t&&t.hasMapped?null===(a=this.logData)||void 0===a||null===(n=a.stepOutput)||void 0===n?void 0:n.mappedOutput:"";return i?JSON.stringify(i,(function(e,t){return void 0===t?null:t}),2):"无数据"}},methods:{handleClose:function(e){this.stepData={},this.logData=null,this.selectedAction=null,this.responseHeight=0,this.isShowResponse=!1,this.response=null,this.actionLogList=[],this.dialogVisible=!1,e()},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stepData;this.stepData=t,this.handleMock(),this.dialogVisible=!0},handleMock:function(){var e=this;this.loading=!0,this.$http({url:i.default.apiDesignMockRunStep,data:{appId:Number(this.$route.query.id),sessionId:window[o.CUSTOM_API_SESSION_ID],requestBody:this.customApiProvide.apiDetail.requestBody,step:this.stepData}}).then((function(t){window[o.CUSTOM_API_RESPONSE_MAP][e.stepData.code]=t.data.mappedOutput,window[o.CUSTOM_API_RESPONSE_MAP]["".concat(e.stepData.code,"_source")]=t.data.output,e.response=t.data.hasMapped?t.data.mappedOutput:t.data.output})).finally((function(){e.handleGetLog()}))},handleExport:function(){},handleGetLog:function(){var e=this;this.$http({url:i.default.apiDesignGetRunStepDetail,data:{sessionId:window[o.CUSTOM_API_SESSION_ID],stepCode:this.stepData.code}}).then((function(t){e.logData=t.data,e.selectedAction=e.logData.actionResults[0],e.handleGetActionListLog()})).finally((function(){e.loading=!1}))},handleGetActionListLog:function(){var e=this;this.loading=!0,this.$http({url:i.default.apiDesignGetListRunActionLog,data:{sessionId:window[o.CUSTOM_API_SESSION_ID],actionCode:this.selectedAction.actionInfo.code}}).then((function(t){e.actionLogList=t.data.map((function(e){return{showDetail:0!==e.indexOf("[JSON_FORMAT"),detail:e}}))})).finally((function(){e.loading=!1}))},updateHeight:function(){var e=this.$refs.dialog.$el.firstChild;this.responseHeight=null==e?void 0:e.getBoundingClientRect().height},handleChangeAction:function(e){var t=this;this.selectedAction=e,this.handleGetActionListLog(),this.$nextTick((function(){t.updateHeight()}))},handleToggleShowResponse:function(){var e=this;this.isShowResponse?this.isShowResponse=!1:(this.updateHeight(),this.$nextTick((function(){e.isShowResponse=!0})))}}};t.default=r},tQ29:function(e,t,a){"use strict";a.r(t);var n=a("brNU"),i=a("hAVY");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("PCZw");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"4ba500c9",null);t.default=r.exports},tWPJ:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.apiRequest?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"api-config"},[a("n-form",{ref:"apiRequest",staticClass:"data-select-form",attrs:{"label-position":"top",model:e.apiRequest,rules:e.rules,size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-button-group",{staticClass:"api-button-group",staticStyle:{"margin-left":"10px"}}),e._v(" "),a("div",{staticClass:"form-item-wrapper"},[a("div",{staticClass:"url-title"},[e._v("\n        URL\n        "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("1.动态路径参数需要在url路径前加冒号表示，动态参数在params中配置，如/user/:id/:name"),a("br"),e._v("2.测试阶段url的参数由所填的测试值决定"),a("br"),e._v("3.运行阶段url的参数由所填写的参数值决定")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-select",{staticClass:"method-select",attrs:{size:"mini"},model:{value:e.apiRequest.method,callback:function(t){e.$set(e.apiRequest,"method",t)},expression:"apiRequest.method"}},e._l(e.methods,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),a("n-form-item",{staticClass:"no-border",attrs:{prop:"url"}},[a("div",{staticClass:"inline-form-item",staticStyle:{padding:"0"}},[[6].includes(e.apiRequest.type)?[a("el-checkbox",{staticStyle:{margin:"0 10px"},on:{change:e.handleUseDynamicOriginChange},model:{value:e.apiRequest.useDynamicOrigin,callback:function(t){e.$set(e.apiRequest,"useDynamicOrigin",t)},expression:"apiRequest.useDynamicOrigin"}},[e._v("动态协议域名端口")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("启用动态协议域名端口，则允许选取一个宏变量作为协议域名端口，系统会自动过滤掉填写的协议域名端口")]),e._v(" "),a("i",{staticClass:"el-icon-question",staticStyle:{"margin-right":"5px"}})]),e._v(" "),e.apiRequest.useDynamicOrigin?[void 0!==e.apiRequest.dynamicOrigin?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(e.apiRequest.dynamicOrigin),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(e.apiRequest.dynamicOrigin)},on:{click:function(t){return e.handleTagClick(e.apiRequest,"dynamicOrigin")},close:function(t){e.apiRequest.dynamicOrigin=void 0}}},[e._v("\n                  "+e._s(e.formatTag(e.getElementName(e.apiRequest.dynamicOrigin),12))+"\n                ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button",{on:{click:function(t){return e.handleShowMacroVariableSelect(e.apiRequest,"dynamicOrigin")}}},[e._v("选择协议域名端口\n                  ")])],1),e._v(" "),a("el-input",{attrs:{placeholder:"请输入path"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})]:e._e()]:e._e(),e._v(" "),![6].includes(e.apiRequest.type)||[6].includes(e.apiRequest.type)&&!e.apiRequest.useDynamicOrigin?a("el-input",{attrs:{disabled:[4,5].includes(e.apiRequest.type),placeholder:"请输入URL"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}):e._e(),e._v(" "),4===e.apiRequest.type?a("el-button",{attrs:{type:"primary"},on:{click:e.handleShowGatewayDataSelect}},[e._v("选择")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleMock}},[e._v("测试 ")])],2)])],1),e._v(" "),4===e.apiRequest.type&&e.apiRequest.desc?a("div",{staticClass:"sql-desc"},[a("div",{staticClass:"desc-item"},[e._v("描述："+e._s(e.apiRequest.desc))])]):e._e(),e._v(" "),a("n-form-item",{attrs:{label:""}},[a("div",{staticClass:"params-config"},[a("el-button",{staticClass:"source-edit-button",attrs:{type:"primary"},on:{click:function(t){return e.showInputDialog("object",e.paramsSource,e.activeParamsName,"paramsSource")}}},[e._v("转换器")]),e._v(" "),a("el-button-group",{staticClass:"api-button-group"},[a("el-button",{staticClass:"api-button",attrs:{type:"body"===e.activeParamsName?"primary":""},on:{click:function(t){e.activeParamsName="body"}}},[e._v("Body（"+e._s(e.bodyLength)+"）\n          ")]),e._v(" "),a("el-button",{staticClass:"api-button",attrs:{type:"params"===e.activeParamsName?"primary":""},on:{click:function(t){e.activeParamsName="params"}}},[e._v("Params（"+e._s(e.paramsLength)+"）\n          ")]),e._v(" "),a("el-button",{staticClass:"api-button",attrs:{type:"headers"===e.activeParamsName?"primary":""},on:{click:function(t){e.activeParamsName="headers"}}},[e._v("Headers（"+e._s(e.headersLength)+"）\n          ")])],1),e._v(" "),a("n-table",{staticStyle:{width:"100%"},attrs:{data:e.currentParamsData,border:"","header-cell-class-name":"header-cell"}},[a("n-table-column",{attrs:{prop:"key",label:"参数名"},scopedSlots:e._u([{key:"default",fn:function(t){return["headers"===e.activeParamsName?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}},e._l(e.headersOptions,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})})),1):a("el-input",{attrs:{disabled:e.paramsInputDisabled(t.row.key)},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}],null,!1,2299372278)}),e._v(" "),a("n-table-column",{attrs:{prop:"value",label:"参数值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0!==t.row.value?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.value),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(t.row.value)},on:{click:function(a){return e.handleTagClick(t.row,"value")},close:function(e){t.row.value=void 0}}},[e._v("\n                    "+e._s(e.formatTag(e.getElementName(t.row.value),12))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},["headers"!==e.activeParamsName?a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{on:{click:function(a){return e.showInputDialog("text",t.row,"value")}}},[e._v("文本\n                    ")]),e._v(" "),a("el-button",{attrs:{disabled:["params","headers"].includes(e.activeParamsName)},on:{click:function(a){return e.showInputDialog("number",t.row,"value")}}},[e._v("数值\n                    ")]),e._v(" "),a("el-button",{attrs:{disabled:["params","headers"].includes(e.activeParamsName)},on:{click:function(a){return e.showInputDialog("object",t.row,"value")}}},[e._v("对象\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.handleShowVariableSelect(t.row,"value")}}},[e._v("参数\n                    ")])],1):a("div",{staticClass:"headers-input"},["Content-Type"===t.row.key?a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}},e._l(e.contentTypeOptions,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})})),1):a("el-input",{attrs:{disabled:!t.row.key,clearable:""},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}}),e._v(" "),a("el-button",{on:{click:function(a){return e.handleShowVariableSelect(t.row,"value")}}},[e._v("参数\n                    ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.value=e}}})],1)],1)]}}],null,!1,541611739)}),e._v(" "),a("n-table-column",{attrs:{prop:"mockValue",label:"测试值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0===t.row.mockValue||["params","headers"].includes(e.activeParamsName)?a("div",{staticClass:"value-input-content"},[["params","headers"].includes(e.activeParamsName)?["Content-Type"===t.row.key&&"headers"===e.activeParamsName?a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:t.row.mockValue,callback:function(a){e.$set(t.row,"mockValue",a)},expression:"scope.row.mockValue"}},e._l(e.contentTypeOptions,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})})),1):a("el-input",{attrs:{disabled:!t.row.key,clearable:""},model:{value:t.row.mockValue,callback:function(a){e.$set(t.row,"mockValue",a)},expression:"scope.row.mockValue"}})]:a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{on:{click:function(a){return e.showInputDialog("text",t.row,"mockValue")}}},[e._v("文本\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.showInputDialog("number",t.row,"mockValue")}}},[e._v("数值\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.showInputDialog("object",t.row,"mockValue")}}},[e._v("对象\n                    ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.mockValue=e}}})],2):a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.mockValue),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":""},on:{click:function(a){return e.handleTagClick(t.row,"mockValue")},close:function(e){t.row.mockValue=void 0}}},[e._v("\n                    "+e._s(e.formatTag(t.row.mockValue))+"\n                  ")])],1)],1)]}}],null,!1,261760049)}),e._v(" "),a("n-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddParams}},[e._v("\n                  +\n                ")]),e._v(" "),e.paramsInputDisabled(t.row.key)?e._e():a("div",{staticClass:"add-btn-primary",on:{click:function(a){return e.handleDeleteParams(t.$index)}}},[e._v("\n                  -\n                ")])])]}}],null,!1,2290147109)})],1)],1)])],1),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",on:{confirm:e.handleVariableConfirm}}),e._v(" "),a("MacroVariableSelect",{ref:"macroVariableSelect",on:{confirm:e.handleVariableConfirm}}),e._v(" "),a("gateway-data-select",{ref:"gatewayDataSelect",on:{confirm:e.handleGatewayDataConfirm}}),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}})],1):e._e()},i=[]},tevo:function(e,t,a){"use strict";a.r(t);var n=a("m3y+"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},ugZR:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-item"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"api-detail"},[a("div",{staticClass:"title"},[a("span",{staticClass:"t"},[e._v("自定义API")]),e._v(" "),a("el-tag",{attrs:{type:e.statusMap.type}},[e._v(e._s(e.statusMap.title))])],1),e._v(" "),a("div",{staticClass:"content"},[a("n-tabs",{staticClass:"content-tabs",attrs:{stretch:!0,type:"border-card","tab-position":"left"},model:{value:e.activeMenu,callback:function(t){e.activeMenu=t},expression:"activeMenu"}},[a("n-tab-pane",{attrs:{label:"API定义",name:"apiDefine"}},[a("n-form",{ref:"apiDefineForm",attrs:{model:e.formData,rules:e.rules,"label-position":"right","label-width":"70px",size:"medium"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("n-form-item",{attrs:{label:"API名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1),e._v(" "),a("el-col",{staticStyle:{padding:"0 0 0 20px"},attrs:{span:12}},[a("n-form-item",{attrs:{label:"分组",prop:"groupId"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.formData.groupId,callback:function(t){e.$set(e.formData,"groupId",t)},expression:"formData.groupId"}},e._l(e.apiGroupList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),e._v(" "),a("el-row",[a("n-form-item",{attrs:{label:"API路径",prop:"path"}},[a("el-col",{attrs:{span:24}},[a("el-input",{staticClass:"url-input",attrs:{placeholder:"请输入API路径"},model:{value:e.formData.path,callback:function(t){e.$set(e.formData,"path",t)},expression:"formData.path"}},[a("div",{staticClass:"input-group",attrs:{slot:"prepend"},slot:"prepend"},[a("el-input",{staticClass:"pre",staticStyle:{width:"100px","margin-right":"10px","border-right":"1px solid #E4E7ED"},attrs:{value:"POST",disabled:""}}),e._v(" "),a("el-input",{staticClass:"next",staticStyle:{width:"100px"},attrs:{value:e.pathPrepend,disabled:""}})],1),e._v(" "),void 0===e.formData.status?a("api-list",{attrs:{slot:"append",tree:e.apiGroupList},on:{change:e.handleApiChange},slot:"append"},[a("el-button",[e._v("选择")])],1):e._e()],1)],1)],1)],1),e._v(" "),a("el-row",[a("n-form-item",{attrs:{label:"API描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"  请完善自定义API的描述，便于团队后续维护"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1)],1)],1),e._v(" "),a("n-tab-pane",{staticClass:"params-define",attrs:{lazy:"",label:"入参定义",name:"paramsDefine"}},[a("n-tabs",{attrs:{type:"card"},model:{value:e.activeJsonType,callback:function(t){e.activeJsonType=t},expression:"activeJsonType"}},[a("n-tab-pane",{attrs:{label:"树形结构",name:"tree"}},["tree"===e.activeJsonType?a("JsonEditor",{staticClass:"json-editor",attrs:{showVariable:!1,valueLabel:"测试值："},model:{value:e.formData.requestBody,callback:function(t){e.$set(e.formData,"requestBody",t)},expression:"formData.requestBody"}}):e._e()],1),e._v(" "),a("n-tab-pane",{attrs:{name:"json"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                  JSON\n                  "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\nJSON文件都是被包裹在一个大括号{}或者方括号[]中，通过key-value的方式来表达数据。JSON的Key必须包裹在一个双引号中，在实践中，编写 JSON 的时候，忘了给 Key 值加双引号或者是把双引号写成单引号是常见错误。\n\nJSON的值只能是以下几种数据格式，其他任何格式都会触发报错，例如 JavaScript 中的 undefined。\n\n1.数字，包含浮点数和整数\n2.字符串，需要包裹在双引号中\n3.Bool值，true 或者 false\n4.数组，需要包裹在方括号中 []\n5.对象，需要包裹在大括号中 {}\n6.Null\n\n还需要注意的是 JSON 文件中无法使用注释，试图添加注释将会引发报错\n                    ")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),"json"===e.activeJsonType?a("json-code",{staticClass:"json-code-editor",attrs:{isObject:!0},model:{value:e.formData.requestBody,callback:function(t){e.$set(e.formData,"requestBody",t)},expression:"formData.requestBody"}}):e._e()],1)],1)],1)],1)],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"api-content"},[a("div",{staticClass:"title"},[a("div",{staticClass:"left"},[a("span",{staticClass:"t"},[e._v("业务逻辑定义")]),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("步骤之间为串行关系")]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("div",{staticClass:"right"},[e._v("专业模式\n         "),a("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:e.formData.useScript,callback:function(t){e.$set(e.formData,"useScript",t)},expression:"formData.useScript"}})],1)]),e._v(" "),e.formData.useScript?a("div",{staticClass:"config"},[a("div",{staticClass:"config-title"},[a("span",{staticClass:"t"},[e._v("专业模式")]),e._v(" "),a("div",[a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"left"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.templateContent)},slot:"content"}),e._v(" "),a("i",{staticClass:"el-icon-question test-btn tooltip"})]),e._v(" "),a("el-button-group",{staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{size:"mini",type:"GROOVY"===e.formData.scriptConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("GROOVY")}}},[e._v("Groovy")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"JAVASCRIPT"===e.formData.scriptConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("JAVASCRIPT")}}},[e._v("JavaScript")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"PYTHON"===e.formData.scriptConfig.scriptType?"primary":""},on:{click:function(t){return e.changeScriptType("PYTHON")}}},[e._v("Python")])],1)],1)]),e._v(" "),a("div",{staticClass:"code-wrapper"},[a("div",{staticClass:"empty-code",domProps:{innerHTML:e._s(e.templateText)}}),e._v(" "),"JAVASCRIPT"===e.formData.scriptConfig.scriptType?a("js-code",{ref:"jsCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.scriptCode,callback:function(t){e.scriptCode=t},expression:"scriptCode"}}):e._e(),e._v(" "),"GROOVY"===e.formData.scriptConfig.scriptType?a("groovy-code",{ref:"groovyCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.scriptCode,callback:function(t){e.scriptCode=t},expression:"scriptCode"}}):e._e(),e._v(" "),"PYTHON"===e.formData.scriptConfig.scriptType?a("python-code",{ref:"pythonCode",staticClass:"js-code",attrs:{"params-data":e.paramsData,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.scriptCode,callback:function(t){e.scriptCode=t},expression:"scriptCode"}}):e._e()],1),e._v(" "),a("div",{staticClass:"params-config"},[a("vxe-table",{ref:"xTable",staticClass:"x-table",attrs:{size:"mini",data:e.innerParams,border:"","header-cell-class-name":"header-cell"}},[a("vxe-table-column",{attrs:{field:"name",title:"参数名词",width:"140"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"key",title:"参数编码"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tag",[e._v(e._s(n.key))])]}}])}),e._v(" "),a("vxe-table-column",{attrs:{field:"desc",type:"html",title:"参数描述"}})],1)],1)]):[e.formData.steps?e._l(e.formData.steps,(function(t,n){return a("StepItem",{key:t.code,attrs:{stepData:t,order:n+1},on:{remove:function(t){return e.formData.steps.splice(n,1)}}})})):e._e(),e._v(" "),a("div",{staticClass:"api-step-plus",on:{click:e.handleAddStep}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"}},[e._v("新增步骤")])],1)]],2),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"api-btn-group"},[void 0!==this.formData.status?a("el-button",{attrs:{type:"primary"},on:{click:e.handleMock}},[e._v("API测试")]):e._e(),e._v(" "),[0,3].includes(this.formData.status)?a("el-button",{attrs:{type:"danger"},on:{click:e.handleRemove}},[e._v("删除")]):e._e(),e._v(" "),2!==this.formData.status?a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")]):e._e(),e._v(" "),2!==this.formData.status?a("el-button",{attrs:{type:"primary"},on:{click:e.handlePublish}},[e._v("发布")]):e._e(),e._v(" "),2===this.formData.status?a("el-button",{attrs:{type:"primary"},on:{click:e.handleUnpublish}},[e._v("下线")]):e._e()],1),e._v(" "),a("Publish",{ref:"publish",attrs:{apiGroupList:e.apiGroupList},on:{success:function(t){return e.$emit("refresh")}}}),e._v(" "),a("ApiMock",{ref:"apiMock"}),e._v(" "),a("ApiScriptMock",{ref:"apiScriptMock"})],1)},i=[]},v5Dq:function(e,t,a){var n=a("wcx4");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("b60b3568",n,!0,{})},vPsv:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("KQm4")),s=n(a("ODXe")),r=n(a("HaE+")),l=n(a("YLtl")),c={name:"PythonCode",components:{ChangeHeight:n(a("ZoP3")).default},props:{value:{type:String},paramsData:{type:Array,default:function(){return[]}},resizable:{type:Boolean,default:!1}},data:function(){return{loading:!1,hints:[],monacoInstance:null,provider:null,logList:[],code:""}},computed:{dynamicHints:function(){return this.paramsData.map((function(e){return e.key})).filter((function(e){return e}))}},watch:{paramsData:{handler:function(e,t){e.length&&this.initHints()},deep:!0,immediate:!0},value:{handler:function(e,t){var a;l.default.isEqual(e,t)||(this.code=e,null===(a=this.monacoInstance)||void 0===a||a.setValue(e))},immediate:!0}},methods:{initHints:function(){this.hints=Array.from(new Set(this.dynamicHints)).sort()},dispose:function(){this.monacoInstance&&(this.monacoInstance.getModel()&&this.monacoInstance.getModel().dispose(),this.monacoInstance.dispose(),this.monacoInstance=null,this.provider&&(this.provider.dispose(),this.provider=null))},init:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,r,l,c,u,d,p;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$refs.codeEditor){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,e.code=e.value,r=[Promise.all([a.e(0),a.e(1)]).then(a.t.bind(null,"M/lh",7)),Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"iLY9"))],t.next=8,Promise.all(r);case 8:l=t.sent,c=(0,s.default)(l,1),u=c[0],d=e,e.dispose(),p=function(e){var t=e.replace(/[\*\[\]@\$\(\)]/g,"").replace(/(\s+|\.)/g," ").split(" "),a=t[t.length-1],n=a.length,i=new RegExp("([^\\w]|^)"+a+"\\w*","gim"),s=d.value.match(i),r=s?s.map((function(e){var t=new RegExp(a,"gim"),n=e.search(t);return e.substr(n)})):[],l=Array.from(new Set([].concat((0,o.default)(d.hints),(0,o.default)(r)))).sort().filter((function(e){var t=new RegExp(e.substr(0,n),"gim");return!(s&&1===s.length&&e===a||1===e.length)&&a.match(t)}));return l.map((function(e){return{label:e,kind:d.hints.indexOf(e)>-1?u.languages.CompletionItemKind.Keyword:u.languages.CompletionItemKind.Text,documentation:e,insertText:e}}))},e.provider=u.languages.registerCompletionItemProvider("python",{provideCompletionItems:function(e,t){var a=e.getValueInRange({startLineNumber:t.lineNumber,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column});return{suggestions:p(a)}}}),e.monacoInstance=u.editor.create(n,{value:e.code,language:"python",theme:"vs",folding:!1,foldingHighlight:!0,foldingStrategy:"indentation",showFoldingControls:"always",disableLayerHinting:!0,emptySelectionClipboard:!1,selectionClipboard:!1,automaticLayout:!0,codeLens:!1,scrollBeyondLastLine:!1,colorDecorators:!0,accessibilitySupport:"off",lineNumbers:"on",lineNumbersMinChars:5,enableSplitViewResizing:!1,roundedSelection:!1,overviewRulerBorder:!1,minimap:{enabled:!1},autoIndent:"full",readOnly:!1,tabSize:2}),e.monacoInstance.onDidFocusEditorText((function(){e.$emit("focus-change",!0)})),e.monacoInstance.onDidBlurEditorText((function(){e.monacoInstance&&(e.code=e.monacoInstance.getValue(),e.$emit("input",e.code),e.$emit("focus-change",!1))})),e.loading=!1;case 19:case"end":return t.stop()}}),t)})))()},handleHeightChange:l.default.throttle((function(e){var t=e.height,a=this.$el.clientHeight+t,n=this.$el.clientWidth;this.monacoInstance.layout({width:n,height:a<244?224:a})}),60)},created:function(){this.initHints()},mounted:function(){var e=this;this.$nextTick((function(){e.init()}))},beforeDestroy:function(){this.dispose()}};t.default=c},vRL6:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1")),o=n(a("U8pU")),s=n(a("HaE+")),r=n(a("lrFb")),l=n(a("Xcjf")),c=n(a("WOyx")),u=a("xBdn"),d={name:"InputDialog",components:{JsonCode:r.default,JsonEditor:c.default,JsConfig:l.default},data:function(){return{dialogVisible:!1,activeName:"tree",type:"",reference:null,value:void 0,key:"",from:""}},computed:{title:function(){switch(this.type){case"text":return"文本编辑";case"number":return"数值编辑";case"object":return"JSON编辑";case"js":return"JS脚本编辑";case"css":return"CSS样式编辑";default:return"编辑"}}},methods:{open:function(e){var t=e.type,a=e.data,n=e.key,i=e.from;this.type=t,this.reference=a||{},this.key=n,this.from=i,this.value=this.getValue(this.type,a[n]),this.dialogVisible=!0},getValue:function(e,t){switch(e){case"text":return t||"";case"number":return t||0;case"object":return t||{};default:return t}},cancel:function(){this.dialogVisible=!1},handleClose:function(e){this.dialogVisible=!1,e()},confirm:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("object"===e.type){if("object"===(0,o.default)(e.value))a=e.value;else if((0,u.isValidJsonString)(e.value))try{a=JSON.parse(e.value)}catch(e){console.log(e)}}else a=e.value;if(void 0!==a||void 0===e.value){t.next=5;break}return t.next=4,e.$confirm("JSON格式不正确","提示",{showCancelButton:!1});case 4:return t.abrupt("return");case 5:e.reference[e.key]=a,e.$emit("confirm",a,e.from),e.dialogVisible=!1;case 8:case"end":return t.stop()}}),t)})))()},handleAttrInput:function(e){this.value=e}}};t.default=d},vkiJ:function(e,t,a){},vofx:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"body-no-padding-dialog no-margin-dialog low-code-dialog",fullscreen:!1,"close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,title:"自定义API管理",visible:e.dialogVisible,"before-close":e.handleClose,width:"90%",top:"0"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content"},[a("div",{staticClass:"left-panel"},[a("GroupPanel",{ref:"groupPanel",attrs:{defaultSelectId:e.defaultSelectId},on:{create:e.handleCreate,select:function(t){return e.selectedApi=t},update:function(t){return e.apiGroupList=t}}})],1),e._v(" "),a("div",{staticClass:"right-content"},[e.selectedApi?a("ApiItem",{attrs:{"api-data":e.selectedApi,apiGroupList:e.apiGroupList},on:{update:e.handleUpdate,refresh:e.handleRefresh}}):a("n-empty",{staticClass:"right-content-empty",attrs:{description:"暂无数据，请在左侧分组栏新增自定义API"}})],1)])])},i=[]},vsCC:function(e,t,a){},wFyv:function(e,t,a){"use strict";a.r(t);var n=a("bPPv"),i=a("LDYN");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("kY7n");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"6f8767d2",null);t.default=r.exports},"wKF/":function(e,t,a){var n=a("Kfku");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("bdce8570",n,!0,{})},wcx4:function(e,t,a){},wdmC:function(e,t,a){"use strict";a("D0lE")},ws0p:function(e,t,a){var n=a("nUOe");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("7f0f84a0",n,!0,{})},wwYs:function(e,t,a){"use strict";a.r(t);var n=a("9Tsg"),i=a("EQOX");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("HH6s");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"b2e0a90c",null);t.default=r.exports},wxxj:function(e,t,a){"use strict";a.r(t);var n=a("8Rwu"),i=a("/ZDK");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("KtNt");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"7be2298f",null);t.default=r.exports},xRjl:function(e,t,a){"use strict";a.r(t);var n=a("bc0g"),i=a("2Odn");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("t7PT");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"735aee4d",null);t.default=r.exports},xc0H:function(e,t,a){var n=a("XCVn");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("1993c04a",n,!0,{})},xmx0:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.sqlRequest?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"sql-config"},[a("n-form",{ref:"sqlRequest",staticClass:"data-select-form",attrs:{"label-position":"top",model:e.sqlRequest,rules:e.rules,size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("n-form-item",{staticClass:"sql-form-item",attrs:{label:""}},[a("div",{staticClass:"inline-form-item"},[a("div",{staticClass:"form-item-label"},[e._v("数据源")]),e._v(" "),a("div",{staticClass:"sql-data-select-wrapper"},[a("div",{staticClass:"left-buttons"},[e.sqlRequest.sqlData?a("el-input",{staticClass:"sql-name",attrs:{value:e.sqlRequest.sqlData.name}}):a("el-input",{staticClass:"sql-name",attrs:{readonly:""}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleShowSqlDataSelect}},[e._v("选择")])],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleMock}},[e._v("测试")])],1)]),e._v(" "),e.sqlRequest.sqlData?a("div",{staticClass:"sql-desc"},[a("div",{staticClass:"desc-item"},[e._v("\n          类型：\n          "),a("el-tag",[e._v(e._s(e.sqlRequest.sqlData.type))])],1),e._v(" "),a("div",{staticClass:"desc-item"},[e._v("\n          数据库："+e._s(e.sqlRequest.sqlData.databaseName)+"\n        ")]),e._v(" "),a("div",{staticClass:"desc-item"},[e._v("\n          描述："+e._s(e.sqlRequest.sqlData.description)+"\n        ")])]):e._e()]),e._v(" "),a("n-form-item",{staticClass:"sql-form-item",attrs:{label:"SQL",prop:"sql"}},[a("el-button-group",{staticClass:"sql-type-buttons"},[a("el-button",{attrs:{type:1===e.sqlRequest.sqlType?"primary":""},on:{click:function(t){e.sqlRequest.sqlType=1}}},[e._v("动态SQL")]),e._v(" "),a("el-button",{attrs:{type:2===e.sqlRequest.sqlType?"primary":""},on:{click:function(t){e.sqlRequest.sqlType=2}}},[e._v("模板SQL")])],1),e._v(" "),a("el-tooltip",{attrs:{"popper-class":"tooltip-question",placement:"left"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(1===e.sqlRequest.sqlType?e.sqlTemplate1:e.sqlTemplate2)},slot:"content"}),e._v(" "),a("i",{staticClass:"el-icon-question sql-type-buttons tooltip"})]),e._v(" "),a("div",{staticClass:"empty-code",domProps:{innerHTML:e._s(e.sqlTemplate)}}),e._v(" "),a("sql-code",{staticClass:"sql-code",attrs:{"dynamic-hints":e.dynamicHints,resizable:!0},on:{"focus-change":e.focusChange},model:{value:e.sqlRequest.sql,callback:function(t){e.$set(e.sqlRequest,"sql",t)},expression:"sqlRequest.sql"}})],1),e._v(" "),a("n-form-item",{attrs:{label:""}},[a("div",{staticClass:"params-config"},[a("el-button",{staticClass:"source-edit-button",attrs:{type:"primary"},on:{click:function(t){return e.showInputDialog("object",e.paramsSource,"params","paramsSource")}}},[e._v("转换器")]),e._v(" "),a("n-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.params,border:""}},[a("n-table-column",{attrs:{prop:"key",label:"参数名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}],null,!1,3453451902)}),e._v(" "),a("n-table-column",{attrs:{prop:"value",label:"参数值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0!==t.row.value?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.value),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":"",type:e.getTagType(t.row.value)},on:{click:function(a){return e.handleTagClick(t.row,"value")},close:function(e){t.row.value=void 0}}},[e._v("\n                    "+e._s(e.formatTag(e.getElementName(t.row.value),12))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{on:{click:function(a){return e.showInputDialog("text",t.row,"value")}}},[e._v("文本\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.showInputDialog("number",t.row,"value")}}},[e._v("数值\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.handleShowVariableSelect(t.row,"value")}}},[e._v("参数\n                    ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.value=e}}})],1)],1)]}}],null,!1,383059463)}),e._v(" "),a("n-table-column",{attrs:{prop:"mockValue",label:"测试值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"value-input"},[void 0!==t.row.mockValue?a("el-tooltip",{attrs:{effect:"dark",content:e.formatTip(t.row.mockValue),placement:"top"}},[a("el-tag",{staticClass:"value-tag",attrs:{closable:"","disable-transitions":""},on:{click:function(a){return e.handleTagClick(t.row,"mockValue")},close:function(e){t.row.mockValue=void 0}}},[e._v("\n                    "+e._s(e.formatTag(t.row.mockValue))+"\n                  ")])],1):a("div",{staticClass:"value-input-content"},[a("el-button-group",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-right":"4px"}},[a("el-button",{on:{click:function(a){return e.showInputDialog("text",t.row,"mockValue")}}},[e._v("文本\n                    ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.showInputDialog("number",t.row,"mockValue")}}},[e._v("数值\n                    ")])],1),e._v(" "),a("MoreTypeDropdown",{on:{change:function(e){return t.row.mockValue=e}}})],1)],1)]}}],null,!1,957267696)}),e._v(" "),a("n-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"btns"},[a("div",{staticClass:"add-btn-primary",on:{click:e.handleAddParams}},[e._v("+")]),e._v(" "),a("div",{staticClass:"add-btn-primary",on:{click:function(a){return e.handleDeleteParams(t.$index)}}},[e._v("\n                  -\n                ")])])]}}],null,!1,17254359)})],1)],1)])],1),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",on:{confirm:e.handleVariableConfirm}}),e._v(" "),a("sql-data-select",{ref:"sqlDataSelect",on:{confirm:e.handleSqlDataConfirm}}),e._v(" "),a("custom-input-dialog",{ref:"inputDialog",on:{confirm:e.handleUpdateValue}})],1):e._e()},i=[]},yFiB:function(e,t,a){"use strict";a("UqOf")},yINx:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"page-history-manage",title:"",visible:e.dialogVisible,"close-on-click-modal":!0,"modal-append-to-body":!0,"append-to-body":!0,"before-close":e.beforeClose,width:"290px",top:"0"}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"dialog-header"},[a("div",{staticClass:"title"},[e._v("快照记录")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleSaveClick}},[e._v("快照备份")])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-body"},[e.historyDetail?[e.historyDetail.records.length?a("div",{staticClass:"history-list"},e._l(e.historyDetail.records,(function(t){return a("div",{key:t.id,staticClass:"history-item",on:{click:function(a){return e.handleSelectHistory(t)}}},[a("div",{staticClass:"left"},[a("div",{staticClass:"time"},[e._v(e._s(e.formatTime(t.createdTime)))]),e._v(" "),a("div",{staticClass:"user"},[e._v(e._s(t.createdBy))]),e._v(" "),a("div",{staticClass:"desc",attrs:{title:t.description}},[e._v(e._s(t.description))])]),e._v(" "),a("div",{staticClass:"right"},[a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.id)}}},[e._v("删除")])],1)])})),0):a("n-empty",{attrs:{description:"暂无数据"}}),e._v(" "),e.historyDetail.rowCount>10*e.pageCount&&e.historyDetail.records.length<=10*e.pageCount?a("el-button",{staticClass:"load-more",attrs:{type:"text"},on:{click:e.handleShowMore}},[e._v("显示更多")]):a("div",{staticClass:"load-more"},[e._v("已经没有更多数据了")])]:e._e()],2),e._v(" "),a("el-dialog",{attrs:{title:"快照备份",visible:e.showSaveDialog,"close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,"before-close":e.beforeSaveClose,width:"500px",top:"15vh"}},[a("div",{staticClass:"history-save-dialog-content"},[a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-label"},[e._v("创建时间")]),e._v(" "),a("div",{staticClass:"form-value"},[e._v(e._s(e.formData.createTime))])]),e._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-label"},[e._v("创建人")]),e._v(" "),a("div",{staticClass:"form-value"},[e._v(e._s(e.formData.user))])]),e._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-label"},[e._v("快照描述")]),e._v(" "),a("div",{staticClass:"form-value"},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容",maxlength:"30","show-word-limit":""},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showSaveDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)])],1)])},i=[]},yJIN:function(e,t,a){},yURZ:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("PHku")),o={name:"Condition",components:{CustomApiVariableSelect:n(a("IFH0")).default},mixins:[i.default],props:{condition:{type:Object},isShowLeft:{type:Boolean,default:!0},showSelf:{type:Boolean,default:!1}},data:function(){return{ruleOptions:[{label:"等于",value:"EQ"},{label:"大于",value:"GT"},{label:"小于",value:"LT"},{label:"大于等于",value:"GE"},{label:"小于等于",value:"LE"},{label:"不等于",value:"NE"},{label:"包含",value:"INCL"},{label:"不包含",value:"NON_INCL"},{label:"正则匹配",value:"REGEX"}]}},methods:{handleAddConditionChild:function(e,t){t.push({left:{source:{name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{name:""},type:void 0,value:void 0}})},handleDeleteConditionChild:function(e,t){t.splice(e,1),t.length||(this.condition.conditionItems=this.condition.conditionItems.filter((function(e){return e.items.length})))},handleAddCondition:function(){this.condition.conditionItems.push({items:[{left:{source:{name:""},type:void 0,value:void 0},logic:"or",op:"EQ",right:{source:{name:""},type:void 0,value:void 0}}],logic:"or"})},handleDeleteCondition:function(e){this.condition.conditionItems.splice(e,1)},formatCTip:function(e){return e.source.name?this.getElementName(e.source.name,this.showSelf):"".concat(e.value)},formatCTag:function(e){return e.source.name?this.getElementName(e.source.name,this.showSelf):"".concat(e.value)},handleCTagClick:function(e){e.source.name?this.handleShowVariableSelect(e.source,"name"):this.handleTagClick(e,"value")},handleClearValue:function(e){e.source.name="",e.value=void 0},getCTagType:function(e){return e.source.name?this.getTagType(e.source.name):""},handleUpdateValue:function(e,t){t&&(t.source.name="")}}};t.default=o},ydOG:function(e,t,a){},ydmR:function(e,t,a){"use strict";a.r(t);var n=a("iC/w"),i=a("kZNv");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("PwvG");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"d5f02118",null);t.default=r.exports},yqXf:function(e,t,a){var n=a("cELa");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("5d8ebb1d",n,!0,{})},z7BS:function(e,t,a){"use strict";a("NbdW")},z9WI:function(e,t,a){var n=a("7buB");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("SZ7m").default)("677ac1bd",n,!0,{})},zUJO:function(e,t,a){"use strict";a.r(t);var n=a("tWPJ"),i=a("ZthT");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("lJrv");var s=a("KHd+"),r=Object(s.a)(i.default,n.a,n.b,!1,null,"2ccb6382",null);t.default=r.exports},zx9K:function(e,t,a){"use strict";a.r(t);var n=a("tJX9"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},zz4O:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"json-editor"},[a("div",{staticClass:"edit-mode"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editorProvide.showButtons=!e.editorProvide.showButtons}}},[e._v("编辑")])],1),e._v(" "),e.loading?e._e():a("json-view",{attrs:{showVariable:e.showVariable,valueLabel:e.valueLabel},model:{value:e.parsedData,callback:function(t){e.parsedData=t},expression:"parsedData"}}),e._v(" "),a("CustomApiVariableSelect",{ref:"variableSelect",on:{confirm:e.handleVariableConfirm}}),e._v(" "),a("item-add-form",{ref:"popover",attrs:{showVariable:e.currentContext.showVariable,needName:e.currentContext.needName},on:{confirm:e.newItem}})],1)},i=[]}}]);
//# sourceMappingURL=/@project/web_code/69-941c78b42fca4defe959.js.map