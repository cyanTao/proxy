(window["webpackJsonp_/@project/web_code"]=window["webpackJsonp_/@project/web_code"]||[]).push([[61],{"+o2V":function(e,t,n){"use strict";var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("o0o1")),r=a(n("HaE+")),o=a(n("slWK")),s=n("7Qib"),u=a(n("UeeE")),c=n("cCei"),l=a(n("YLtl")),d=n("8SHQ"),p=u.default.createInstance({id:"id",children:"pages"}),f=u.default.createInstance({id:"elementId",children:"children",pid:"parentId"}),g={inject:["id","vid","pageId","isPreview"],components:{},props:{appInfo:{type:Object}},data:function(){return{isCollapse:!1,loading:!1,menuOptions:[],pagesObj:{},expand:!1,large:!1}},mounted:function(){},methods:{getImageUrl:s.getImageUrl,getLeftMenuOptions:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,a,r,s,u,g,h;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,n=e.id,a=e.vid,!(0,e.isPreview)()){t.next=8;break}return t.next=5,e.$http({url:o.default.pageDesignMenus,data:{appDesignId:a}});case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,e.$http({url:o.default.getMenuInfo,data:{appId:n,source:d.INSTALLED}});case 10:r=t.sent;case 11:s=r.data,u=(s=void 0===s?{groupPages:[],homePageId:""}:s).groupPages,g=s.homePageId,h=u.map((function(t){return e.treeMap(t,0)})),e.$store.commit(c.UPDATE_PAGE_DATA,{pageData:l.default.cloneDeep(f.toList(h))}),e.menuOptions=e.filterData(u),p.forEach(u,(function(t){e.pagesObj[t.id]=t})),!e.pageId()&&e.handlePageSelect(g),e.$emit("init",e.menuOptions),e.loading=!1;case 21:case"end":return t.stop()}}),t)})))()},treeMap:function(e,t){var n=this,a=e.pages&&e.pages.length>0;return{elementId:"".concat(e.code),pageDesignId:"".concat(e.id),elementType:2===e.type?"page-group":"page",hidden:e.hidden,sort:e.sort,elementName:e.name,parentId:t,code:e.code?e.code:"",children:a?e.pages.map((function(t){return n.treeMap(t,e.id)})):[],type:e.type}},filterData:function(e){return e.filter((function(e){return!e.hidden})).map((function(e){return e.pages&&e.pages.length&&(e.pages=e.pages.filter((function(e){return!e.hidden}))),e}))},handlePageSelect:function(e){this.expand&&(this.expand=!1),this.$emit("select",this.pagesObj[e])}},computed:{settings:function(){return this.appInfo.settings||{}},horizontal:function(){return"top"===this.settings.navigatePosition},largeWatcher:function(){return this.horizontal&&this.menuOptions.length}},watch:{largeWatcher:function(e){var t=this;e?this.$nextTick((function(){var e=t.$refs.leftMenu.$el,n=Array.from(e.querySelectorAll("li.el-menu-item")).reduce((function(e,t){return e+t.offsetWidth}),0);t.large=n>=e.offsetWidth})):this.large=!1}},created:function(){this.getLeftMenuOptions()}};t.default=g},"+qWY":function(e,t,n){},"/G0y":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.settings.navigateShow,expression:"settings.navigateShow"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"preview-aside",class:{"is-collapse":e.isCollapse,horizontal:e.horizontal}},[n("div",{staticClass:"app-logo",style:e.horizontal?"width: 160px; height: 40px;":""},[n("img",{staticClass:"app-logo-img",attrs:{src:e.getImageUrl(e.appInfo.appIcon)}}),e._v(" "),e.isCollapse?e._e():n("span",{staticClass:"app-logo-title",attrs:{title:e.appInfo.appName}},[e._v(e._s(e.appInfo.appName))])]),e._v(" "),e.settings.navigateShow?n("el-menu",{ref:"leftMenu",staticClass:"left-menu",class:{expand:e.expand,large:e.large},attrs:{"default-active":e.pageId(),mode:e.horizontal?"horizontal":"vertical",collapse:e.isCollapse,"background-color":"#181C26","text-color":"#ACACAC","active-text-color":"#FFFFFF"}},[e.large?n("div",{staticClass:"expand-icon",class:{expand:e.expand},on:{click:function(t){e.expand=!e.expand}}},[n("span"),e._v(" "),n("span"),e._v(" "),n("span")]):e._e(),e._v(" "),e._l(e.menuOptions,(function(t){return[t.pages.length?n("el-submenu",{key:t.id,attrs:{"popper-class":"preview-aside-menu-popper",index:t.id}},[n("template",{slot:"title"},[e.horizontal?e._e():n("i",{staticClass:"el-icon-folder-opened page-icon"}),e._v(" "),n("span",{staticClass:"page-text",attrs:{title:t.name}},[e._v(e._s(t.name))])]),e._v(" "),e._l(t.pages,(function(t){return n("el-menu-item",{key:t.id,attrs:{index:t.id},on:{click:function(n){return e.handlePageSelect(t.id)}}},[e.horizontal?e._e():n("img",{staticClass:"page-icon el-icon-tickets"}),e._v(" "),n("span",{staticClass:"page-text",attrs:{title:t.name}},[e._v(e._s(t.name))])])}))],2):2==t.type?n("el-submenu",{key:t.id,attrs:{"popper-class":"preview-aside-menu-popper",index:t.id}},[n("template",{slot:"title"},[e.horizontal?e._e():n("i",{staticClass:"el-icon-folder-opened page-icon"}),e._v(" "),n("span",{staticClass:"page-text",attrs:{title:t.name}},[e._v(e._s(t.name))])])],2):1==t.type?n("el-menu-item",{key:t.id,attrs:{index:t.id},on:{click:function(n){return e.handlePageSelect(t.id)}}},[e.horizontal?e._e():n("i",{staticClass:"page-icon el-icon-tickets"}),e._v(" "),n("span",{staticClass:"page-text",attrs:{title:t.name}},[e._v(e._s(t.name))])]):e._e()]}))],2):e._e(),e._v(" "),e.horizontal?e._e():n("div",{staticClass:"aside-bottom"},[n("img",{staticClass:"collapse-btn",class:{"is-collapse":e.isCollapse},attrs:{src:e.$getImgPrefix("/design/svg/collapse-icon.svg"),alt:""},on:{click:function(t){e.isCollapse=!e.isCollapse}}})]),e._v(" "),e.expand?n("div",{staticClass:"menu-mask",on:{click:function(t){e.expand=!1}}}):e._e()],1)},i=[]},"1H+5":function(e,t,n){"use strict";n.r(t);var a=n("caZD"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t.default=i.a},"9URH":function(e,t,n){"use strict";n.r(t);var a=n("/G0y"),i=n("AjU9");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("hUuT"),n("z1SN");var o=n("KHd+"),s=Object(o.a)(i.default,a.a,a.b,!1,null,"77ca51d2",null);t.default=s.exports},"AG+8":function(e,t,n){"use strict";n.r(t);var a=n("TDIz"),i=n("nWVA");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("ErRY");var o=n("KHd+"),s=Object(o.a)(i.default,a.a,a.b,!1,null,"62e20967",null);t.default=s.exports},AZFv:function(e,t,n){var a=n("ocHk");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("e04136fc",a,!0,{})},AjU9:function(e,t,n){"use strict";n.r(t);var a=n("+o2V"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t.default=i.a},D5PW:function(e,t,n){},DWo8:function(e,t,n){var a=n("D5PW");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("164d552c",a,!0,{})},ErRY:function(e,t,n){"use strict";n("ialC")},TDIz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"preview-page-content"},[e.pageLoading?e._e():[e.getShareInfoError?n("div",{staticClass:"empty-page"},[e._v("该页面未开启分享")]):n("n-form",{staticStyle:{width:"100%",height:"100%"},nativeOn:{submit:function(e){e.preventDefault()}}},[e.currentElement?n(e.currentElement,e._b({key:e.layoutData.elementId,ref:e.layoutData.elementId,tag:"component",staticClass:"page-content",attrs:{id:"page_"+e.layoutData.elementId}},"component",e.layoutData,!1)):e._e()],1)]],2)},i=[]},a0DT:function(e,t,n){var a=n("x//1");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("48318012",a,!0,{})},bQgG:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-container",class:{"padding-bottom":e.errorLogVisible,column:e.settings.navigateShow&&"top"===e.settings.navigatePosition}},[e.LeftMenuLoading?e._e():n("left-menu",{attrs:{appInfo:e.appInfo},on:{select:e.handlePageSelect,init:e.menuInited}}),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"main"},[e.pageId?[e.settings.headerShow?n("app-header",{attrs:{pageId:e.pageId,menu:e.menuOptions},on:{refresh:e.refresh}}):e._e(),e._v(" "),e.pageAlive?n("comp-content"):e._e()]:n("div",{staticClass:"empty-page"},[e._v(e._s("请选择页面"))])],2),e._v(" "),e.errorLogVisible?n("error-capture",{attrs:{top:""}}):e._e()],1)},i=[]},caZD:function(e,t,n){"use strict";var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("o0o1")),r=a(n("HaE+")),o=a(n("rePB")),s=n("WIBD"),u=n("cCei"),c=a(n("slWK")),l=n("8SHQ"),d=a(n("/S23")),p=a(n("9URH")),f=a(n("YLtl")),g=a(n("2VVP")),h=n("7Qib"),v=a(n("0hJt")),m=n("Zct0");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={mixins:[a(n("7C5+")).default],components:{LeftMenu:p.default,AppHeader:function(){return n.e(85).then(n.bind(null,"vpXl"))},CompContent:function(){return Promise.resolve().then(n.bind(null,"AG+8"))},errorCapture:function(){return Promise.all([n.e(3),n.e(86)]).then(n.bind(null,"sJ5m"))}},provide:function(){var e=this;return{id:this.id,vid:this.vid,pageId:function(){return e.pageId},isPreview:function(){return e.isPreview}}},name:"Page",data:function(){return{id:"",vid:"",pageId:"",pageLoading:!1,LeftMenuLoading:!0,menuOptions:[],appInfo:{settings:{}},activePageData:{},pageAlive:!1}},computed:{isPreview:function(){return!!this.vid},pageData:function(){return this.$store.state.CODE.lowCodeStore.pageData},errorLogVisible:function(){return this.settings.preview},settings:function(){return this.appInfo.settings||{}}},methods:_(_({},(0,s.mapMutations)({setVersionInfo:d.default.VERSION_INFO})),{},{menuInited:function(e){this.menuOptions=e,this.getPageData()},handlePageSelect:function(e){var t=e.id,n=this.$route.query.pageId;this.activePageData=e;var a=n?"push":"replace";t!=n&&rootApp.$router[a]({query:_(_({},this.$route.query),{},{pageId:t})})},getPageData:f.default.debounce((0,r.default)(i.default.mark((function e(){var t,n,a=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pageAlive=!1,this.pageLoading=!0,n=this.pageId&&(null===(t=this.pageData.find((function(e){return Number(e.pageDesignId)===Number(a.pageId)})))||void 0===t?void 0:t.elementId),e.prev=3,e.next=6,this._storeDispatch(u.UPDATE_PAGE_CONFIG,{elementId:n,pageDesignId:this.pageId,cache:!this.isPreview,instanceId:this.id,appDesignId:this.vid,isPageShare:!1});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log("页面数据为空");case 11:this.pageAlive=!0,this.pageLoading=!1;case 13:case"end":return e.stop()}}),e,this,[[3,8]])}))),100),treeMap:function(e,t){var n=this,a=e.pages&&e.pages.length>0;return{elementId:"".concat(e.code),pageDesignId:"".concat(e.id),elementType:2===e.type?"page-group":"page",hidden:e.hidden,sort:e.sort,elementName:e.name,parentId:t,code:e.code?e.code:"",children:a?e.pages.map((function(t){return n.treeMap(t,e.id)})):[],type:e.type}},refresh:function(){var e=this;return(0,r.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getPageData();case 2:case"end":return t.stop()}}),t)})))()},initQuery:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,a,r,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.$route.query,a=n.id,r=n.vid,o=n.pageId,e.id=a,e.vid=r,e.pageId=o;case 4:case"end":return t.stop()}}),t)})))()},getAppInfo:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n,a,r,o,s;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.id,a=e.vid,e.isPreview){t.next=9;break}return t.next=4,e.$http({url:c.default.getAppDisplayInfo,data:{appId:n,source:l.INSTALLED}});case 4:o=t.sent,(r=o.data).appIcon=r.icon,t.next=13;break;case 9:return t.next=11,e.$http({url:c.default.appDesignDetail,data:{id:a}});case 11:s=t.sent,r=s.data;case 13:e.setVersionInfo(r),e.appInfo=_(_({},r),{},{settings:(0,m.formatSetting)(r.settings)}),e.LeftMenuLoading=!1;case 16:case"end":return t.stop()}}),t)})))()}}),watch:{$route:{immediate:!0,handler:function(e,t){this.initQuery(),e&&t&&e.fullPath!==t.fullPath&&this.getPageData()}}},mounted:function(){},created:function(){(0,h.loadCustomIconfont)(),g.default.init(),this.getAppInfo()},destroyed:function(){},errorCaptured:function(e,t){return v.default.recordBug({target:t,message:e,error:e}),!1}};t.default=P},enDc:function(e,t,n){"use strict";n("DWo8")},hUuT:function(e,t,n){"use strict";n("xPmL")},ialC:function(e,t,n){var a=n("+qWY");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("885db4b2",a,!0,{})},j3lx:function(e,t,n){"use strict";n("a0DT")},jpb5:function(e,t,n){"use strict";n.r(t);var a=n("bQgG"),i=n("1H+5");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("enDc"),n("j3lx");var o=n("KHd+"),s=Object(o.a)(i.default,a.a,a.b,!1,null,"e18dbc74",null);t.default=s.exports},nWVA:function(e,t,n){"use strict";n.r(t);var a=n("omFD"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t.default=i.a},ocHk:function(e,t,n){},omFD:function(e,t,n){"use strict";var a=n("TqRt"),i=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("KQm4")),o=(a(n("YLtl")),n("tgb1")),s=n("cCei"),u=n("7Qib"),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=e[o]}a.default=e,n&&n.set(e,a);return a}(n("7C5+")),l=a(n("slWK"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}var p={inject:(0,r.default)(c.pageInject),mixins:(0,u.getSharePageParams)().code?[c.default]:[],provide:function(){return{isPageShare:this.isPageShare}},components:{},props:{isPageShare:{type:Boolean}},data:function(){return{pageLoading:this.isPageShare,getShareInfoError:!1}},computed:{layoutData:function(){return(0,u.getSharePageParams)().code?this.storeData.layoutData:this.getStore().layoutData},currentElement:function(){var e;if(null===(e=this.layoutData)||void 0===e||!e.elementType)return"";var t=this.layoutData,n=t.elementType,a=t.elementVersion;return(0,o.getComponent)(n,a)}},methods:{getPageInfo:function(){var e=this;if(this.isPageShare){var t=(0,u.getSharePageParams)(),n=t.code,a=t.appId,i=this.$route.query.code;this.pageLoading=!0,this._storeDispatch(s.UPDATE_PAGE_CONFIG,{elementId:i||n,cache:!1,instanceId:a,isPageShare:!0}).then((function(){e.getShareInfoError=!1})).catch((function(){e.getShareInfoError=!0})).finally((function(){e.pageLoading=!1}))}},getPageSharingSettings:function(){var e=this,t=(0,u.getSharePageParams)(),n=t.code,a=t.appId;this.$http({url:l.default.pageSharingSettings,data:{appId:a,pageCode:n}}).then((function(t){var n={};t.data&&(n=JSON.parse(t.data)),e.$store.commit("setShowBreadcrumb",!!n.showBreadcrumb)}))}},created:function(){var e=this;this.isPageShare&&this.getPageSharingSettings(),this.getPageInfo(),this.$store.state.isNeedTab||this.$watch("$route",(function(t,n){t.path,t.query,n.path,n.query;e.getPageInfo()}))},destroyed:function(){this.isPageShare&&this.$store.commit("setShowBreadcrumb",!0)},watch:{}};t.default=p},"x//1":function(e,t,n){},xPmL:function(e,t,n){var a=n("zEfc");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("5968d9aa",a,!0,{})},z1SN:function(e,t,n){"use strict";n("AZFv")},zEfc:function(e,t,n){}}]);
//# sourceMappingURL=/@project/web_code/appInstance-941c78b42fca4defe959.js.map