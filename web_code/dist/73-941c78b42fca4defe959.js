(window["webpackJsonp_/@project/web_code"]=window["webpackJsonp_/@project/web_code"]||[]).push([[73],{"+1Fb":function(e,t,i){var a=i("UKb+");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("SZ7m").default)("af112206",a,!0,{})},"/Q7G":function(e,t,i){"use strict";i.r(t);var a=i("EHxA"),s=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(n);t.default=s.a},"3Og5":function(e,t,i){"use strict";i.r(t);var a=i("BMZr"),s=i("/Q7G");for(var n in s)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(n);i("RCtI");var l=i("KHd+"),o=Object(l.a)(s.default,a.a,a.b,!1,null,"99ba4830",null);t.default=o.exports},"8FAB":function(e,t,i){"use strict";i.r(t);var a=i("mPKX"),s=i("S1/M");for(var n in s)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(n);i("CwuA");var l=i("KHd+"),o=Object(l.a)(s.default,a.a,a.b,!1,null,"a7686e04",null);t.default=o.exports},BMZr:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"data-select-dialog",attrs:{"custom-class":"low-code-dialog",title:"模板管理",visible:e.dialogVisible,"close-on-click-modal":!1,"modal-append-to-body":!0,"append-to-body":!0,width:"1200px",top:"15vh","before-close":e.handleClose}},[e.detail?i("div",{staticClass:"widget-detail"},[i("div",{staticClass:"top"},[i("div",{staticClass:"left"},[i("el-button",{staticStyle:{color:"#444444","font-size":"14px","font-weight":"700","margin-right":"18px"},attrs:{size:"mini",type:"text",icon:"el-icon-back"},on:{click:function(t){e.detail=null}}},[e._v("返回")]),e._v(" "),i("n-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.pathList,(function(t,a){return i("n-breadcrumb-item",{key:t,staticClass:"breadcrumb-item",class:{last:a===e.pathList.length-1}},[e._v("\n            "+e._s(t)+"\n          ")])})),1)],1),e._v(" "),i("div",{staticClass:"right"},[i("div",{staticClass:"widget-tool"},["publish"!==e.type||e.detail.favorite?e._e():i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAddToPrivate(e.detail)}}},[e._v("安装")]),e._v(" "),"private"===e.type?i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(e.detail)}}},[e._v("编辑")]):e._e(),e._v(" "),"publish"!==e.type||"publish"===e.type&&e.detail.favorite?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleRemove(e.detail)}}},[e._v(e._s("private"===e.type?"删除":"卸载"))]):e._e()],1)])]),e._v(" "),i("div",{staticClass:"bottom"},[i("div",{staticClass:"widget-item"},[i("div",{staticClass:"widget-icon",style:"background-image: url("+e.getImageUrl(e.detail.icon)+")"}),e._v(" "),i("div",{staticClass:"widget-name"},[i("div",{staticClass:"name"},[e._v(e._s(e.detail.name))]),e._v(" "),i("div",{staticClass:"desc"},[e._v(e._s(e.detail.description))])])]),e._v(" "),i("el-image",{staticClass:"thumb",attrs:{src:e.getImageUrl(e.detail.thumb),"preview-src-list":[e.getImageUrl(e.detail.thumb)],fit:"contain"}})],1)]):i("div",{staticClass:"dialog-content"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"widgets-list"},e._l(e.widgetList,(function(t){return i("div",{key:t.id,staticClass:"widget-item",on:{click:function(i){return e.handleShowDetail(t)}}},[i("div",{staticClass:"widget-icon",style:"background-image: url("+e.getImageUrl(t.icon)+")"}),e._v(" "),i("div",{staticClass:"widget-name"},[i("div",{staticClass:"name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"desc"},[e._v(e._s(t.description))])])])})),0),e._v(" "),e.widgetList.length?e._e():i("div",{staticClass:"empty-text"},[e._v("暂无数据")])]),e._v(" "),i("FavoriteDialog",{ref:"favoriteDialog",on:{success:e.handleEditSuccess}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{loading:e.loading},on:{click:e.close}},[e._v("关 闭")])],1)],1)},s=[]},CwuA:function(e,t,i){"use strict";i("MkdV")},EHxA:function(e,t,i){"use strict";var a=i("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(i("o0o1")),n=a(i("HaE+")),l=a(i("x/Cv")),o=a(i("mr7X")),r=a(i("slWK")),c=i("7Qib"),d={components:{Upload:l.default,FavoriteDialog:o.default},data:function(){return{dialogVisible:!1,loading:!1,widgetList:[],type:"private",pathList:[],detail:null}},watch:{type:{immediate:!0,handler:function(e){this.handleGetWidgetList()}}},methods:{getImageUrl:c.getImageUrl,open:function(){this.type="private",this.dialogVisible=!0,this.handleGetWidgetList()},close:function(){this.clear()},handleClose:function(e){this.clear(),e()},clear:function(){this.detail=null,this.loading=!1,this.dialogVisible=!1},handleGetWidgetList:function(){var e=this;this.loading=!0,this.$http({url:"private"===this.type?r.default.componentTemplatePrivateList:r.default.componentTemplatePublishList}).then((function(t){var i=t.data;e.widgetList=i})).finally((function(){e.$nextTick((function(){e.loading=!1}))}))},handleAddToPrivate:function(e){var t=this;this.loading=!0,this.$http({url:r.default.componentTemplatePublishFavor,data:{componentTemplateId:e.id}}).then((function(i){i.data;e.favorite=!0,t.$emit("refresh")})).finally((function(){t.$nextTick((function(){t.loading=!1}))}))},handleEdit:function(e){var t=this;this.loading=!0,this.$http({url:r.default.componentTemplatePrivateDetail,data:{id:Number(e.id)}}).then((function(e){var i=e.data;t.$refs.favoriteDialog.open({data:i})})).finally((function(){t.loading=!1}))},handleRemove:function(e){var t=this;return(0,n.default)(s.default.mark((function i(){var a;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.$confirm("确认将此模板[".concat(e.name,"]从个人模板中移除吗？"));case 2:a="private"===t.type?{id:e.id}:{componentTemplateId:e.id},t.loading=!0,t.$http({url:"private"===t.type?r.default.componentTemplatePrivateRemove:r.default.componentTemplatePublishUnfavor,data:a}).then((function(i){i.data;"private"===t.type?(t.widgetList=t.widgetList.filter((function(t){return t.id!==e.id})),t.detail=null):e.favorite=!1,t.$emit("refresh")})).finally((function(){t.$nextTick((function(){t.loading=!1}))}));case 5:case"end":return i.stop()}}),i)})))()},handleEditSuccess:function(e){var t=this.widgetList.find((function(t){return t.id===e.id}));t.name=e.name,t.icon=e.icon,t.description=e.description,this.$emit("refresh")},handleShowDetail:function(e){this.detail=e,this.pathList=["private"===this.type?"个人模板":"公共模板",e.name]}}};t.default=d},MkdV:function(e,t,i){var a=i("PxJZ");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("SZ7m").default)("669a620a",a,!0,{})},PxJZ:function(e,t,i){},RCtI:function(e,t,i){"use strict";i("+1Fb")},"S1/M":function(e,t,i){"use strict";i.r(t);var a=i("eyBe"),s=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(n);t.default=s.a},"UKb+":function(e,t,i){},eyBe:function(e,t,i){"use strict";var a=i("TqRt"),s=i("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(i("rePB")),l=a(i("KQm4")),o=a(i("YLtl")),r=i("mtVH"),c=a(i("WJ+c")),d=a(i("3Og5")),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var i=m(t);if(i&&i.has(e))return i.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=n?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(a,l,o):a[l]=e[l]}a.default=e,i&&i.set(e,a);return a}(i("ZDQs")),u=a(i("slWK")),f=i("7Qib");function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(m=function(e){return e?i:t})(e)}function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){(0,n.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var h={name:"WidgetPanel",components:{TemplateListDialog:d.default},inject:["dndOptions"],data:function(){return{iconMap:p.iconMap,versionList:r.versionList,widgetTypeList:p.widgetTypeList,loading:!1,selectedWidget:{elementName:""},selectedTemplate:{name:""},version:o.default.last(r.versionList),widgetType:"base",widgets:[],templateList:[],collapses:[{name:"layoutTypes",title:"布局组件",widgets:[]},{name:"baseTypes",title:"基础组件",widgets:[]},{name:"formTypes",title:"表单组件",widgets:[]},{name:"dataTypes",title:"高级组件",widgets:[]},{name:"dialogTypes",title:"窗体组件",widgets:[]},{name:"chartTypes",title:"图表组件",widgets:[]}],templateCollapses:[{name:"public",title:"公共模板",widgets:[]},{name:"persional",title:"个人模板",widgets:[]}],activeCollapses:["layoutTypes","baseTypes","formTypes","dataTypes","dialogTypes","chartTypes"],activeTemplateCollapses:["public","persional"]}},methods:{getImageUrl:f.getImageUrl,handleGetTemplateList:function(){var e=this;"template"===this.widgetType&&(this.loading=!0,this.$http({url:u.default.componentTemplatePrivateList}).then((function(t){var i,a=(i=t.data||[]).concat.apply(i,(0,l.default)(c.default));e.templateList=a.map((function(e){return g(g({},e),{},{isVisible:!0})})),e.handleUpdateTemplateCollapses(e.templateList),e.selectedTemplate={name:""}})).finally((function(){e.$nextTick((function(){e.loading=!1}))})))},pageSearch:function(e,t){var i=e?this.widgets.filter(function(e){return function(t){return-1!==t.elementName.toLowerCase().indexOf(e.toLowerCase())}}(e)):this.widgets;this.handleUpdateCollapses(i),t(i)},templateSearch:function(e,t){var i=e?this.templateList.filter(function(e){return function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}}(e)):this.templateList;this.handleUpdateTemplateList(i),t(i)},handleUpdateTemplateList:function(e){var t=e.map((function(e){return e.id}));this.templateList=this.templateList.map((function(e){return g(g({},e),{},{isVisible:t.includes(e.id)})})),this.handleUpdateTemplateCollapses(this.templateList)},handleSelect:function(e){e?(this.selectedWidget=o.default.cloneDeep(e),this.handleUpdateCollapses([e])):(this.selectedWidget={elementName:""},this.handleUpdateCollapses(this.widgets))},handleSelectTemplate:function(e){e?(this.selectedTemplate=o.default.cloneDeep(e),this.templateList=this.templateList.map((function(t){return g(g({},t),{},{isVisible:e.id===t.id})}))):(this.selectedTemplate={name:""},this.templateList=this.templateList.map((function(e){return g(g({},e),{},{isVisible:!0})})))},handleUpdateWidgets:function(){if(this.widgets=(0,r.getWidgetList)("base",this.version),"template"===this.widgetType)this.handleGetTemplateList();this.dndOptions.widgets=this.widgets,this.handleUpdateCollapses(this.widgets)},handleUpdateCollapses:function(e){this.collapses=this.collapses.map((function(t){return g(g({},t),{},{widgets:e.filter((function(e){var i;return null===(i=p[t.name])||void 0===i?void 0:i.includes(e.elementType)}))})}))},handleUpdateTemplateCollapses:function(e){this.templateCollapses=this.templateCollapses.map((function(t){return g(g({},t),{},{widgets:e.filter((function(e){return e.isVisible&&("public"===t.name&&e.public||"persional"===t.name&&!e.public)}))})}))},handleShowTemplateList:function(){this.$refs.templateListDialog.open()}},mounted:function(){var e=this;this.$nextTick((function(){e.handleUpdateWidgets()}))}};t.default=h},mPKX:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("n-tabs",{staticClass:"widget-tabs",on:{"tab-click":e.handleUpdateWidgets},model:{value:e.widgetType,callback:function(t){e.widgetType=t},expression:"widgetType"}},[i("n-tab-pane",{attrs:{label:"UI组件",name:"base"}},[i("div",{staticClass:"widget-panel"},[i("div",{staticClass:"title"},[i("div",{staticClass:"top"},[i("el-autocomplete",{staticClass:"autocomplete-select",attrs:{size:"mini","popper-class":"my-autocomplete","fetch-suggestions":e.pageSearch,placeholder:"请输入组件名筛选",clearable:""},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[i("div",{staticClass:"name"},[e._v(e._s(a.elementName))])]}}]),model:{value:e.selectedWidget.elementName,callback:function(t){e.$set(e.selectedWidget,"elementName",t)},expression:"selectedWidget.elementName"}},[i("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v(" "),i("el-select",{staticClass:"version-select",attrs:{size:"mini"},on:{change:e.handleUpdateWidgets},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}},e._l(e.versionList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)]),e._v(" "),i("el-collapse",{model:{value:e.activeCollapses,callback:function(t){e.activeCollapses=t},expression:"activeCollapses"}},[e._l(e.collapses,(function(t){return[t.widgets.length?i("el-collapse-item",{key:t.name,attrs:{title:t.title,name:t.name}},[i("ul",{staticClass:"widget-list"},e._l(t.widgets,(function(t){return i("li",{key:t.elementType,staticClass:"widget is-accept-drag no-hover",attrs:{"data-zone":"_"+t.elementType}},[i("div",{staticClass:"icon_wrapper",style:"background-image: url("+e.$getImgPrefix(e.iconMap[t.elementType])+")"}),e._v(" "),i("div",{staticClass:"name"},[e._v(e._s(t.elementName))])])})),0)]):e._e()]}))],2)],1)]),e._v(" "),i("n-tab-pane",{attrs:{label:"组件模板",name:"template"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"widget-panel"},[i("div",{staticClass:"title"},[i("div",{staticClass:"top"},[i("el-autocomplete",{staticClass:"autocomplete-select",attrs:{size:"mini","popper-class":"my-autocomplete","fetch-suggestions":e.templateSearch,placeholder:"请输入模板名筛选",clearable:""},on:{select:e.handleSelectTemplate},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[i("div",{staticClass:"name"},[e._v(e._s(a.name))])]}}]),model:{value:e.selectedTemplate.name,callback:function(t){e.$set(e.selectedTemplate,"name",t)},expression:"selectedTemplate.name"}},[i("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"5px",padding:"7px"},attrs:{size:"mini",type:"primary",icon:"el-icon-s-tools"},on:{click:e.handleShowTemplateList}})],1)]),e._v(" "),i("el-collapse",{model:{value:e.activeTemplateCollapses,callback:function(t){e.activeTemplateCollapses=t},expression:"activeTemplateCollapses"}},[e._l(e.templateCollapses,(function(t){return[i("el-collapse-item",{key:t.name,attrs:{title:t.title,name:t.name}},[t.widgets.length?i("ul",{staticClass:"widget-list"},e._l(t.widgets,(function(t){return i("el-tooltip",{key:t.id,attrs:{"popper-class":"widget-list-tooltip",placement:"right","visible-arrow":!1}},[i("div",{staticClass:"preview-widget",staticStyle:{"border-radius":"5px"},attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"widget-name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"preview-image",style:"background-image: url("+(t.public?t.thumb:e.getImageUrl(t.thumb))+");"})]),e._v(" "),i("li",{staticClass:"widget is-accept-drag no-hover",attrs:{"data-zone":"_"+t.type+"_"+t.id+"_"+t.name}},[i("div",{staticClass:"icon_wrapper",style:"background-image: url("+(t.public?t.icon:e.getImageUrl(t.icon))+");border-radius: 5px;"}),e._v(" "),i("div",{staticClass:"name",staticStyle:{"margin-top":"4px"}},[e._v("\n                    "+e._s(t.name)+"\n                  ")])])])})),1):i("div",{staticClass:"empty-text"},[e._v("暂无数据")])])]}))],2)],1),e._v(" "),i("template-list-dialog",{ref:"templateListDialog",on:{refresh:e.handleGetTemplateList}})],1)],1)},s=[]}}]);
//# sourceMappingURL=/@project/web_code/73-941c78b42fca4defe959.js.map