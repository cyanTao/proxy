(window["webpackJsonp_/@project/web_code"]=window["webpackJsonp_/@project/web_code"]||[]).push([[59],{"/MT1":function(t,e,a){"use strict";a("63L9")},"/nEO":function(t,e,a){},"3hae":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"element-screen",rawName:"v-element-screen"}],staticClass:"share-page",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,title:"页面分享",visible:t.visible,width:"800px",top:"5vh"},on:{"update:visible":function(e){t.visible=e},close:t.close}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticClass:"share-container"},[a("div",{staticClass:"share-header"},[a("div",{staticClass:"info-item",staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"label label-title"},[t._v("应用版本")]),t._v(" "),a("span",{staticClass:"val"},[t._v(t._s(t.info.version))])]),t._v(" "),a("div",{staticClass:"info-item"},[a("span",{staticClass:"label label-title"},[t._v("应用状态")]),t._v(" "),a("span",{staticClass:"val"},[t._v("已上架")])]),t._v(" "),a("div",{staticClass:"info-item",staticStyle:{flex:"100px"}},[a("span",{staticClass:"label label-title"},[t._v("上架时间")]),t._v(" "),a("span",{staticClass:"val"},[t._v(t._s(t.$format("yyyy年MM月dd日 hh:mm:ss",t.info.publishTime)))])]),t._v(" "),a("div",{staticClass:"info-item"},[a("span",{staticClass:"label label-title"},[t._v("上架者")]),t._v(" "),a("span",{staticClass:"val"},[t._v(t._s(t.info.publishUserAlias))])])]),t._v(" "),a("div",{staticClass:"label-title",staticStyle:{"margin-top":"30px"}},[t._v("分享链接")]),t._v(" "),a("el-table",{staticClass:"table",attrs:{data:t.data,border:""}},[a("el-table-column",{attrs:{label:"页面",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{on:{change:function(a){return t.switchChange(e.row,a)}},model:{value:e.row.shared,callback:function(a){t.$set(e.row,"shared",a)},expression:"scoped.row.shared"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"面包屑",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{on:{change:function(a){return t.breadcrumbChange(e.row,a)}},model:{value:e.row.settings.showBreadcrumb,callback:function(a){t.$set(e.row.settings,"showBreadcrumb",a)},expression:"scoped.row.settings.showBreadcrumb"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"link-column"},[a("el-input",{staticClass:"link-input",attrs:{size:"mini",disabled:""},model:{value:e.row.path,callback:function(a){t.$set(e.row,"path",a)},expression:"scoped.row.path"}},[a("el-button",{staticClass:"copy-btn",attrs:{slot:"append",icon:"el-icon-document-copy"},on:{click:function(a){return t.copyText(e.row.path)}},slot:"append"})],1),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"default"},on:{click:function(a){return t.openTab(e.row.link)}}},[t._v("访问")])],1)]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.loading},on:{click:t.close}},[t._v("关闭")])],1)])},s=[]},"63L9":function(t,e,a){var i=a("S66S");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("SZ7m").default)("4a5a4a50",i,!0,{})},"6pDJ":function(t,e,a){"use strict";a("6tkz")},"6tkz":function(t,e,a){var i=a("Zp4R");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("SZ7m").default)("2fc364ea",i,!0,{})},"8AlF":function(t,e,a){"use strict";var i=a("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a("rePB")),n=a("7Qib"),o=a("xBdn"),r=i(a("slWK"));function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={props:{id:{type:Number,required:!0},versionText:{type:String,required:!0}},data:function(){return{getImageUrl:n.getImageUrl,visible:!1,loading:!1,appInfo:{categoryCode:"",name:"",icon:""},form:{note:""},rules:{note:(0,o.getValidators)([{message:"请输入下架说明",include:o.required,required:!0,trigger:"change"}])}}},methods:{getInfo:function(){var t=this;this.loading=!0,this.$http({url:r.default.appInfoDetail,data:{id:this.id}}).then((function(e){var a=e.data,i=a.categoryCode,s=a.name,n=a.icon;t.appInfo={categoryCode:i,name:s,icon:n}})).finally((function(){t.loading=!1}))},handlePublishSubmit:function(){var t=this;this.$refs.dataForm.validate((function(e){if(e){var a=c(c({},t.form),{},{appId:t.id});t.loading=!0,t.$http({url:r.default.appInfoUnpublish,data:a}).then((function(e){200==e.msgCode&&(t.close(),t.$emit("success"),t.$message.success("下架成功"))})).finally((function(){t.loading=!1}))}}))},handleResetForm:function(){this.$refs.dataForm.resetFields()},show:function(){this.id&&this.getInfo(),this.visible=!0},close:function(){this.visible=!1}},computed:{},watch:{}};e.default=d},"9MNQ":function(t,e,a){"use strict";a.r(e);var i=a("STaf"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e.default=s.a},AyeH:function(t,e,a){"use strict";a.r(e);var i=a("QLkI"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e.default=s.a},FR7z:function(t,e,a){"use strict";a.r(e);var i=a("ltj9"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e.default=s.a},PUZx:function(t,e,a){"use strict";a.r(e);var i=a("3hae"),s=a("9MNQ");for(var n in s)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(n);a("/MT1");var o=a("KHd+"),r=Object(o.a)(s.default,i.a,i.b,!1,null,"6322a5b4",null);e.default=r.exports},QLkI:function(t,e,a){"use strict";var i=a("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a("rePB")),n=i(a("Ff2n")),o=a("7Qib"),r=a("xBdn"),l=i(a("slWK")),c=i(a("x/Cv")),d=["name"];function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f={components:{Upload:c.default},props:{id:{type:Number,required:!0},versionId:{type:Number,required:!0},versionText:{type:String,required:!0}},data:function(){return{getImageUrl:o.getImageUrl,visible:!1,loading:!1,appInfo:{categoryCode:"",name:"",icon:""},form:{screenshot:[],note:"",name:""},rules:{name:(0,r.getValidators)([{message:"请输入上架名称",include:r.required,required:!0,trigger:"change"}]),screenshot:{validator:function(t,e,a){e.length?e.length<=1||e.length>5?a(new Error("请上传2-5张应用配图")):a():a(new Error("请上传应用配图"))},trigger:"blur",required:!1},note:(0,r.getValidators)([{message:"请输入上架说明",include:r.required,required:!0,trigger:"change"}])}}},methods:{getInfo:function(){var t=this;this.loading=!0,this.$http({url:l.default.appInfoDetail,data:{id:this.id}}).then((function(e){var a=e.data,i=a.categoryCode,s=a.name,n=a.icon;t.appInfo={categoryCode:i,name:s,icon:n},t.form.name=s})).finally((function(){t.loading=!1}))},handleUploadSuccess:function(t){this.form.screenshot.push(t)},handleDeleteScreenshotByIndex:function(t){this.form.screenshot.splice(t,1)},handlePublishSubmit:function(){var t=this;this.$refs.dataForm.validate((function(e){if(e){var a=t.form,i=a.name,s=p(p({},(0,n.default)(a,d)),{},{appId:t.id,appDesignId:t.versionId,appName:i});t.loading=!0,t.$http({url:l.default.appInfoPublish,data:s}).then((function(e){200==e.msgCode&&(t.close(),t.$emit("success"),t.$message.success("上架成功"))})).finally((function(){t.loading=!1}))}}))},handleResetForm:function(){this.$refs.dataForm.resetFields()},show:function(){this.id&&this.getInfo(),this.visible=!0},close:function(){this.visible=!1}},computed:{},watch:{}};e.default=f},Qjms:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"unpublish-modal",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,title:"下架",visible:t.visible,width:"800px",top:"5vh"},on:{"update:visible":function(e){t.visible=e},close:t.handleResetForm}},[a("n-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"dataForm",staticClass:"unpublish-form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("n-form-item",{attrs:{label:"应用名称"}},[a("span",[t._v(t._s(t.appInfo.name))])]),t._v(" "),a("n-form-item",{attrs:{label:"应用分类"}},[a("span",[t._v(t._s(t.appInfo.categoryCode))])]),t._v(" "),a("n-form-item",{attrs:{label:"应用图标"}},[a("img",{staticClass:"app-icon",attrs:{src:t.getImageUrl(t.appInfo.icon)||t.$getImgPrefix("/application/app.png")}})]),t._v(" "),a("n-form-item",{attrs:{label:"版本"}},[a("span",[t._v(t._s(t.versionText))])]),t._v(" "),a("n-form-item",{attrs:{label:"下架记录",prop:"note"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入更新记录",autosize:{minRows:3}},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handlePublishSubmit}},[t._v("确 认\n    ")]),t._v(" "),a("el-button",{attrs:{loading:t.loading},on:{click:t.close}},[t._v("取 消")])],1)],1)},s=[]},S66S:function(t,e,a){},STaf:function(t,e,a){"use strict";var i=a("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a("7Qib"),n=i(a("slWK")),o=a("uzoN"),r={components:{},props:{id:{type:Number,required:!0},isPublish:{type:Boolean,required:!0}},data:function(){return{visible:!1,loading:!1,info:{},data:[]}},mounted:function(){},methods:{switchChange:function(t,e){var a=t.appId,i=t.code;this.$http({url:e?n.default.pageSharingSave:n.default.pageSharingRemove,data:{appId:a,pageCode:i}})},breadcrumbChange:function(t,e){var a=t.appId,i=t.code;this.$http({url:n.default.pageSharingUpdate,data:{appId:a,pageCode:i,settings:JSON.stringify({showBreadcrumb:e})}})},getInfo:function(){var t=this;this.loading=!0,this.$http({url:n.default.pageSharingPageList,data:{appId:this.id}}).then((function(e){t.data=e.data.map((function(t,e){var a=t.appId,i=t.code;return t.path="".concat(o.instancePathPrefix).concat(a,"_").concat(i,"_").concat(e),t.link="/front".concat(o.previewRoutePath,"?id=").concat(a,"&code=").concat(i),t.settings=t.settings?JSON.parse(t.settings):{},t})),t.$http({url:n.default.pageSharingAppInfo,data:{appId:t.id}}).then((function(e){t.info=e.data}))})).catch((function(e){t.data=[]})).finally((function(){t.loading=!1}))},open:function(){if(this.isPublish)this.visible=!0,this.getInfo();else{var t=this.$createElement;this.$msgbox({title:"提示",message:t("div",{class:"no-public"},[t("i",{class:"el-icon-warning tips-icon"}),t("div",{style:"color: teal"},[t("span",{class:"title"},"应用未上架"),t("span",{class:"desc"},"应用需上架后才能进行页面分享")])]),showCancelButton:!0,showConfirmButton:!1,cancelButtonText:"关闭"})}},close:function(){this.visible=!1},copyText:function(t){(0,s.copyText)(t)},openTab:function(t){window.open(t)}},computed:{},watch:{}};e.default=r},U6Y9:function(t,e,a){"use strict";a.r(e);var i=a("m4Jy"),s=a("FR7z");for(var n in s)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(n);a("q1zy");var o=a("KHd+"),r=Object(o.a)(s.default,i.a,i.b,!1,null,"16ec47c4",null);e.default=r.exports},XqYY:function(t,e,a){"use strict";a.r(e);var i=a("Qjms"),s=a("o9C3");for(var n in s)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(n);a("6pDJ");var o=a("KHd+"),r=Object(o.a)(s.default,i.a,i.b,!1,null,"0fb36b7c",null);e.default=r.exports},YC3r:function(t,e,a){"use strict";a("bMbu")},Zp4R:function(t,e,a){},bFau:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"publish-modal",attrs:{"custom-class":"low-code-dialog","close-on-click-modal":!1,title:"上架",visible:t.visible,width:"800px",top:"5vh"},on:{"update:visible":function(e){t.visible=e},close:t.handleResetForm}},[a("n-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"dataForm",staticClass:"publish-form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("n-form-item",{attrs:{label:"应用名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"输入应用名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("n-form-item",{attrs:{label:"应用分类"}},[a("span",[t._v(t._s(t.appInfo.categoryCode))])]),t._v(" "),a("n-form-item",{attrs:{label:"应用图标"}},[a("img",{staticClass:"app-icon",attrs:{src:t.getImageUrl(t.appInfo.icon)||t.$getImgPrefix("/application/app.png")}})]),t._v(" "),a("n-form-item",{attrs:{label:"应用配图"}},[a("div",{staticClass:"gray-tip-text"},[t._v("\n        上传2-5张应用代表性图片（尺寸保持一致），尺寸不小于x*y像素，支持格式为jpg、png、jpeg、gif、bmp等，单张图片大小不能超过1M\n      ")]),t._v(" "),a("div",{staticClass:"screenshot-container"},[a("div",{staticClass:"screenshot-list"},t._l(t.form.screenshot,(function(e,i){return a("div",{key:i,staticClass:"screenshot-item"},[a("img",{attrs:{src:t.getImageUrl(e)}}),t._v(" "),a("i",{staticClass:"el-icon-circle-cross",on:{click:function(e){return t.handleDeleteScreenshotByIndex(i)}}})])})),0),t._v(" "),t.form.screenshot.length<5?a("Upload",{ref:"upload",staticClass:"app-icon",on:{change:t.handleUploadSuccess}}):t._e()],1)]),t._v(" "),a("n-form-item",{attrs:{label:"版本"}},[a("span",[t._v(t._s(t.versionText))])]),t._v(" "),a("n-form-item",{attrs:{label:"更新记录",prop:"note"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入更新记录",autosize:{minRows:3}},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handlePublishSubmit}},[t._v("确 认\n    ")]),t._v(" "),a("el-button",{attrs:{loading:t.loading},on:{click:t.close}},[t._v("取 消")])],1)],1)},s=[]},bMbu:function(t,e,a){var i=a("/nEO");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("SZ7m").default)("b19f9d2c",i,!0,{})},fc4E:function(t,e,a){},ltj9:function(t,e,a){"use strict";var i=a("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a("o0o1")),n=i(a("HaE+")),o=i(a("slWK")),r=a("7Qib"),l=a("S5C5"),c=i(a("/S23")),d=i(a("Mz3J")),u=i(a("JJ33")),p=i(a("u7ST")),f=i(a("XqYY")),v=i(a("KNmT")),h=i(a("PUZx")),m=a("oYx3"),g=a("29fP"),b={1:"未上架",2:"已上架",3:"已下架"},_={name:"AppDetail",components:{Pagination:d.default,CreateApp:v.default,PublishModal:p.default,UnpublishModal:f.default,SharePage:h.default,SourceManage:u.default},data:function(){return{getImageUrl:r.getImageUrl,VERSION_STATUS:b,id:this.$route.query.id,versionId:0,versionText:"",loading:!1,info:{},versionList:[],tableLoading:!1,queryForm:{pageIndex:1,pageSize:100},total:0,moreButtons:[{title:"基础配置",key:"edit"},{title:"资源管理",key:"source"},{title:"页面分享",key:"share"},{title:"应用导出",key:"export"},{title:"删除",key:"delete"}],versionMoreButtons:[{title:"预览",key:"preview"},{title:"编辑",key:"edit"},{title:"复制",key:"copy"}],exportDialogVisible:!1,exportMode:"CREATION",exportDataSource:!0,exportTips:{CREATION:"默认导出应用的所有版本信息和配置内容，但不包括版本的上下架状态；\n导入结果为新增一个全新应用",COVER:"全量导出应用的所有版本信息、版本状态、配置内容和数据源信息；\n导入结果为覆盖更新已存在的应用版本，或者导入一个全新应用"}}},methods:{preview:function(){(0,l.jumpPreview)({appVersionId:this.info.latestAppDesignId,appId:this.info.id})},createAppConfirm:function(){this.getInfo()},getInfo:function(){var t=this;this.loading=!0,this.$http({url:o.default.appInfoDetail,data:{id:this.id}}).then((function(e){t.info=e.data})).finally((function(){t.loading=!1}))},getVersionList:function(){var t=this;this.$http({url:o.default.appDesignList,data:{appId:this.id}}).then((function(e){var a=e.data;a.some((function(t){t.showVersionDesc=!1})),t.versionList=a,t.isPublish=a.some((function(t){return 2===t.status}))}))},handleCommand:function(t){switch(t){case"edit":this.$refs.createApp.show();break;case"share":this.$refs.sharePage.open();break;case"export":this.exportDialogVisible=!0;break;case"delete":this.handleDeleteApp();break;case"source":this.$refs.sourceManage.open();break;default:console.log("key is in the default")}},handleDeleteApp:function(){var t=this;return(0,n.default)(s.default.mark((function e(){var a,i,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.info,i=a.name,n=a.id,e.next=3,t.$confirm("确认删除".concat(i,"吗？"));case 3:t.loading=!0,t.$http({url:o.default.appInfoRemove,data:{id:n}}).then((function(){t.$message.success("删除成功"),t.goToAppList()})).finally((function(){t.loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},goToAppList:function(){history.length>2?rootApp.$router.back():rootApp.$router.replace({name:m.authKey.Application})},handlePageChange:function(t){var e=t.page,a=t.size;this.queryForm.pageIndex=e,this.queryForm.pageSize=a},handleOpenDesignPage:function(){var t=this;return(0,n.default)(s.default.mark((function e(){var a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getVersionData({data:t.versionList[0]}),e.next=3,g.store.dispatch(c.default.VERSION_JUDGE,{data:a,reload:!1,createCallBack:t.createVersionCallback});case 3:rootApp.$router.push({name:m.authKey.AppDesign,query:{id:t.info.id,vid:a.id,appId:t.info.id}});case 4:case"end":return e.stop()}}),e)})))()},createVersionCallback:function(){this.$message.success("新建成功!"),this.getInfo(),this.getVersionList()},getVersionData:function(t){var e=t.vid,a=t.data;if(!e&&!a)return console.error("数据源为空"),{};var i=a||this.versionList.find((function(t){return t.id==e})),s=i.id,n=i.status,o=i.version;return{status:n,appId:this.id,id:s,version:o}},handleOnOrOffShelf:function(t){switch(t.status){case 1:case 3:if(this.versionList.some((function(t){return 2===t.status})))return this.$message.error("需先下架已上线的应用版本");this.versionId=t.id,this.versionText=t.version,this.$refs.publishModal.show();break;case 2:this.versionText=t.version,this.$refs.unpublishModal.show()}},handleVersionCommand:function(t,e){switch(t){case"preview":this.handlePreviewByVersion(e);break;case"edit":this.handleEditAppByVersion(e);break;case"copy":var a=this.getVersionData({data:e});g.store.dispatch(c.default.VERSION_JUDGE,{data:a,message:"输入新的版本号",reload:!1,isCopy:!0,createCallBack:this.createVersionCallback});break;case"createMod":this.handleCreateModByVersion(e);break;case"delete":this.handleDeleteAppByVersion(e);break;case"source":this.$refs.sourceManage.open();break;default:console.log("key is in the default")}},handlePreviewByVersion:function(t){console.log(t),(0,l.jumpPreview)({appVersionId:t.id,appId:this.$route.query.id})},handleEditAppByVersion:function(t){var e=this;return(0,n.default)(s.default.mark((function a(){var i;return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=e.getVersionData({data:t}),a.next=3,g.store.dispatch(c.default.VERSION_JUDGE,{data:i,reload:!1,createCallBack:e.createVersionCallback});case 3:rootApp.$router.push({name:m.authKey.AppDesign,query:{id:e.info.id,vid:t.id,appId:e.info.id}});case 4:case"end":return a.stop()}}),a)})))()},handleCreateModByVersion:function(t){},handleDeleteAppByVersion:function(t){var e=this;return(0,n.default)(s.default.mark((function a(){var i,n;return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=t.version,n=t.id,a.next=3,e.$confirm("确认删除版本".concat(i,"吗？"));case 3:e.$http({url:o.default.appDesignRemove,data:{id:n}}).then((function(){e.getInfo(),e.getVersionList()}));case 4:case"end":return a.stop()}}),a)})))()},exportApp:function(){(0,r.exportFile)({url:o.default.appInfoExport,data:{params:{appId:this.info.id,exportDataSource:this.exportDataSource,operation:this.exportMode}}})}},created:function(){(0,r.loadCustomIconfont)(),this.getInfo(),this.getVersionList()}};e.default=_},m4Jy:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-detail-page"},[a("header",{staticClass:"header"},[a("div",{staticClass:"app-info"},[a("div",{staticClass:"app-icon"},[a("img",{attrs:{src:t.getImageUrl(t.info.icon)||t.$getImgPrefix("/application/app.png")}})]),t._v(" "),a("div",{staticClass:"app-content"},[a("div",{staticClass:"app-name"},[t._v(t._s(t.info.name))]),t._v(" "),a("div",{staticClass:"app-content-bottom"},[a("div",{staticClass:"app-tag"},[t._v(t._s(t.info.category))])]),t._v(" "),a("div",{staticClass:"app-content-bottom"},[a("div",{staticClass:"app-desc"},[t._v(t._s(t.info.description))])])]),t._v(" "),a("div",{staticClass:"app-button-group"},[a("el-button",{on:{click:t.goToAppList}},[a("i",{staticClass:"el-icon-arrow-left"}),t._v("返回")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleOpenDesignPage}},[t._v("可视化编辑")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.preview}},[t._v("预览")]),t._v(" "),a("el-dropdown",{staticStyle:{"margin-right":"30px"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"more-button"},[t._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.moreButtons,(function(e){return a("el-dropdown-item",{key:e.key,staticClass:"drop-down-item",attrs:{command:e.key}},[t._v(t._s(e.title)+"\n            ")])})),1)],1)],1)])]),t._v(" "),a("main",{staticClass:"main"},[a("div",{staticClass:"version-list-title"},[t._v("版本记录")]),t._v(" "),a("div",{staticClass:"version-list"},t._l(t.versionList,(function(e){return a("div",{key:e.id,staticClass:"version-item"},[a("div",{staticClass:"version-content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"version-name"},[t._v("\n              "+t._s(e.version)+"\n            ")]),t._v(" "),a("div",{staticClass:"publish-name"},[t._v("\n              "+t._s(e.publishAppName)+"\n            ")]),t._v(" "),a("div",{class:{"version-status":!0,"version-is-publish":2==e.status,"version-is-unpublish":3==e.status}},[t._v("\n              "+t._s(t.VERSION_STATUS[e.status])+"\n            ")])]),t._v(" "),a("div",{staticClass:"center"},[a("div",{staticClass:"info-row"},[a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("创建于：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.createdTime?t.$format("yyyy/MM/dd",e.createdTime):"-")+"\n                ")])]),t._v(" "),a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("上架于：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.publishTime?t.$format("yyyy/MM/dd",e.publishTime):"-")+"\n                ")])]),t._v(" "),a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("下架于：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.unpublishTime?t.$format("yyyy/MM/dd",e.unpublishTime):"-")+"\n                ")])])]),t._v(" "),a("div",{staticClass:"info-row"},[a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("创建者：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.createdUserAlias||"-")+"\n                ")])]),t._v(" "),a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("上架者：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.publishUserAlias||"-")+"\n                ")])]),t._v(" "),a("div",{staticClass:"info-col"},[a("div",{staticClass:"label"},[t._v("下架者：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("\n                  "+t._s(e.unpublishUserAlias||"-")+"\n                ")])])])]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"app-button-group"},[3!==e.status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleOnOrOffShelf(e)}}},[t._v(t._s(2===e.status?"下架":"上架"))]):t._e(),t._v(" "),1!=e.status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.showVersionDesc=!e.showVersionDesc}}},[t._v("版本说明\n                "),a("i",{class:{"el-icon--right":!0,"el-icon-arrow-down":!e.showVersionDesc,"el-icon-arrow-up":e.showVersionDesc}})]):t._e(),t._v(" "),a("el-dropdown",{on:{command:function(a){return t.handleVersionCommand(a,e)}}},[a("el-button",{staticClass:"more-button",attrs:{size:"mini"}},[t._v("\n                  更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.versionMoreButtons,(function(e){return a("el-dropdown-item",{key:e.title,staticClass:"drop-down-item",attrs:{command:e.key}},[t._v(t._s(e.title)+"\n                  ")])})),t._v(" "),a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:1==e.status,expression:"versionItem.status == 1"}],key:"删除",staticClass:"drop-down-item",attrs:{command:"delete"}},[t._v("删除\n                  ")])],2)],1)],1)])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showVersionDesc,expression:"versionItem.showVersionDesc"}],staticClass:"version-desc"},[a("div",{staticClass:"publish-desc"},[a("div",{staticClass:"title"},[t._v("版本说明：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(e.publishNote||"-"))])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.unpublishNote,expression:"versionItem.unpublishNote"}],staticClass:"unpublish-desc"},[a("div",{staticClass:"title"},[t._v("下架说明：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(e.unpublishNote||"-"))])])])])})),0)]),t._v(" "),a("create-app",{ref:"createApp",attrs:{id:t.id},on:{success:t.createAppConfirm}}),t._v(" "),a("share-page",{ref:"sharePage",attrs:{id:t.id,isPublish:t.isPublish}}),t._v(" "),a("publish-modal",{ref:"publishModal",attrs:{id:t.id,versionId:t.versionId,versionText:t.versionText},on:{success:t.getVersionList}}),t._v(" "),a("unpublish-modal",{ref:"unpublishModal",attrs:{id:t.id,versionText:t.versionText},on:{success:t.getVersionList}}),t._v(" "),a("SourceManage",{ref:"sourceManage"}),t._v(" "),a("el-dialog",{staticClass:"app-export",attrs:{title:"应用导出",visible:t.exportDialogVisible}},[a("el-form",{attrs:{"label-width":"120px","label-position":"left"}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"导出模式"}},[a("el-row",[a("el-radio-group",{attrs:{size:"mini"},model:{value:t.exportMode,callback:function(e){t.exportMode=e},expression:"exportMode"}},[a("el-radio-button",{attrs:{label:"CREATION"}},[t._v("默认模式")]),t._v(" "),a("el-radio-button",{attrs:{label:"COVER"}},[t._v("全量模式")])],1)],1),t._v(" "),a("el-row",{staticClass:"export-mode-tips",domProps:{innerHTML:t._s(t.exportTips[t.exportMode])}})],1),t._v(" "),"CREATION"===t.exportMode?a("el-form-item",{attrs:{label:"导出数据源"}},[a("el-radio",{attrs:{value:t.exportDataSource,label:!0},nativeOn:{click:function(e){e.preventDefault(),t.exportDataSource=!t.exportDataSource}}},[t._v("导出该应用中使用的数据源配置和调用信息")])],1):t._e()],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.exportDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.exportApp}},[t._v("导 出")])],1)],1)],1)},s=[]},mElg:function(t,e,a){var i=a("fc4E");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("SZ7m").default)("32387d01",i,!0,{})},o9C3:function(t,e,a){"use strict";a.r(e);var i=a("8AlF"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e.default=s.a},q1zy:function(t,e,a){"use strict";a("mElg")},u7ST:function(t,e,a){"use strict";a.r(e);var i=a("bFau"),s=a("AyeH");for(var n in s)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(n);a("YC3r");var o=a("KHd+"),r=Object(o.a)(s.default,i.a,i.b,!1,null,"df4355a8",null);e.default=r.exports}}]);
//# sourceMappingURL=/@project/web_code/AppDetail-941c78b42fca4defe959.js.map