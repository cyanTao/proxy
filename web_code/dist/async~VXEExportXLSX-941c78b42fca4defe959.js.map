{"version":3,"sources":["webpack:///./node_modules/vxe-table-plugin-export-xlsx/dist/index.common.js"],"names":["Object","defineProperty","exports","value","VXETablePluginExportXLSX","_ctor","_interopRequireDefault","_xlsx","obj","__esModule","toBuffer","wbout","buf","ArrayBuffer","length","view","Uint8Array","index","charCodeAt","getValidColumn","column","childNodes","exportXLSX","params","msgKey","$table","options","columns","colgroups","datas","$vxe","modal","t","message","sheetName","isHeader","isFooter","isMerge","isColgroup","original","showMsg","mergeCells","getMergeCells","colList","footList","sheetCols","sheetMerges","colHead","forEach","id","property","getTitle","push","wpx","toInteger","renderWidth","cols","rIndex","groupHead","_colSpan","_rowSpan","validColumn","columnIndex","indexOf","s","r","c","e","mergeItem","mergeRowIndex","row","mergeRowspan","rowspan","mergeColIndex","col","mergeColspan","colspan","rowIndex","getVTRowIndex","_row","rowList","map","item","rest","cellValue","cellType","isNaN","Number","getCellLabel","footerData","getTableData","footers","opts","footerFilterMethod","filter","items","$rowIndex","getFooterData","rows","$getColumnIndex","getFooterCellValue","exportMethod","book","utils","book_new","list","concat","sheet","json_to_sheet","skipHeader","book_append_sheet","write","bookType","bookSST","type","blob","Blob","filename","window","navigator","msSaveBlob","linkElem","document","createElement","target","download","href","URL","createObjectURL","body","appendChild","click","removeChild","alert","status","downloadFile","close","duration","setTimeout","handleImportEvent","file","_importResolve","_importReject","fileReader","FileReader","onload","tableFields","field","workbook","read","result","sheet_to_json","first","Sheets","fields","keys","some","checkImportData","records","record","isUndefined","createData","then","data","mode","insertAt","reloadData","readAsBinaryString","importXLSX","handleExportEvent","install","vxetable","interceptor","setup","types","xlsx","mixin","VXETable","use","_default"],"mappings":"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","file":"async~VXEExportXLSX-941c78b42fca4defe959.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.VXETablePluginExportXLSX = void 0;\n\nvar _ctor = _interopRequireDefault(require(\"xe-utils/ctor\"));\n\nvar _xlsx = _interopRequireDefault(require(\"xlsx\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/* eslint-disable no-unused-vars */\n\n/* eslint-enable no-unused-vars */\nfunction getFooterCellValue($table, opts, rows, column) {\n  var cellValue = rows[$table.$getColumnIndex(column)];\n  return cellValue;\n}\n\nfunction getFooterData(opts, footerData) {\n  var footerFilterMethod = opts.footerFilterMethod;\n  return footerFilterMethod ? footerData.filter(function (items, index) {\n    return footerFilterMethod({\n      items: items,\n      $rowIndex: index\n    });\n  }) : footerData;\n}\n\nfunction toBuffer(wbout) {\n  var buf = new ArrayBuffer(wbout.length);\n  var view = new Uint8Array(buf);\n\n  for (var index = 0; index !== wbout.length; ++index) {\n    view[index] = wbout.charCodeAt(index) & 0xFF;\n  }\n\n  return buf;\n}\n\nfunction getCellLabel(column, cellValue) {\n  if (cellValue) {\n    switch (column.cellType) {\n      case 'string':\n        break;\n\n      case 'number':\n        if (!isNaN(cellValue)) {\n          return Number(cellValue);\n        }\n\n        break;\n\n      default:\n        if (cellValue.length < 12 && !isNaN(cellValue)) {\n          return Number(cellValue);\n        }\n\n        break;\n    }\n  }\n\n  return cellValue;\n}\n\nfunction getValidColumn(column) {\n  var childNodes = column.childNodes;\n  var isColGroup = childNodes && childNodes.length;\n\n  if (isColGroup) {\n    return getValidColumn(childNodes[0]);\n  }\n\n  return column;\n}\n\nfunction exportXLSX(params) {\n  var msgKey = 'xlsx';\n  var $table = params.$table,\n      options = params.options,\n      columns = params.columns,\n      colgroups = params.colgroups,\n      datas = params.datas;\n  var $vxe = $table.$vxe;\n  var modal = $vxe.modal,\n      t = $vxe.t;\n  var message = options.message,\n      sheetName = options.sheetName,\n      isHeader = options.isHeader,\n      isFooter = options.isFooter,\n      isMerge = options.isMerge,\n      isColgroup = options.isColgroup,\n      original = options.original;\n  var showMsg = message !== false;\n  var mergeCells = $table.getMergeCells();\n  var colList = [];\n  var footList = [];\n  var sheetCols = [];\n  var sheetMerges = []; // 处理表头\n\n  if (isHeader) {\n    var colHead = {};\n    columns.forEach(function (column) {\n      colHead[column.id] = original ? column.property : column.getTitle();\n      sheetCols.push({\n        wpx: _ctor[\"default\"].toInteger(column.renderWidth * 0.75)\n      });\n    });\n\n    if (isColgroup && !original && colgroups) {\n      colgroups.forEach(function (cols, rIndex) {\n        var groupHead = {};\n        columns.forEach(function (column) {\n          groupHead[column.id] = null;\n        });\n        cols.forEach(function (column) {\n          var _colSpan = column._colSpan,\n              _rowSpan = column._rowSpan;\n          var validColumn = getValidColumn(column);\n          var columnIndex = columns.indexOf(validColumn);\n          groupHead[validColumn.id] = original ? validColumn.property : column.getTitle();\n\n          if (_colSpan > 1 || _rowSpan > 1) {\n            sheetMerges.push({\n              s: {\n                r: rIndex,\n                c: columnIndex\n              },\n              e: {\n                r: rIndex + _rowSpan - 1,\n                c: columnIndex + _colSpan - 1\n              }\n            });\n          }\n        });\n        colList.push(groupHead);\n      });\n    } else {\n      colList.push(colHead);\n    }\n  } // 处理合并\n\n\n  if (isMerge && !original) {\n    mergeCells.forEach(function (mergeItem) {\n      var mergeRowIndex = mergeItem.row,\n          mergeRowspan = mergeItem.rowspan,\n          mergeColIndex = mergeItem.col,\n          mergeColspan = mergeItem.colspan;\n\n      for (var rIndex = 0; rIndex < datas.length; rIndex++) {\n        var rowIndex = $table.getVTRowIndex(datas[rIndex]._row);\n\n        if (rowIndex === mergeRowIndex) {\n          if (isHeader && colgroups) {\n            rowIndex = rIndex + colgroups.length;\n          }\n\n          sheetMerges.push({\n            s: {\n              r: rowIndex,\n              c: mergeColIndex\n            },\n            e: {\n              r: rowIndex + mergeRowspan - 1,\n              c: mergeColIndex + mergeColspan - 1\n            }\n          });\n          break;\n        }\n      }\n    });\n  }\n\n  var rowList = datas.map(function (item) {\n    var rest = {};\n    columns.forEach(function (column) {\n      rest[column.id] = getCellLabel(column, item[column.id]);\n    });\n    return rest;\n  }); // 处理表尾\n\n  if (isFooter) {\n    var _$table$getTableData = $table.getTableData(),\n        footerData = _$table$getTableData.footerData;\n\n    var footers = getFooterData(options, footerData);\n    footers.forEach(function (rows) {\n      var item = {};\n      columns.forEach(function (column) {\n        item[column.id] = getFooterCellValue($table, options, rows, column);\n      });\n      footList.push(item);\n    });\n  }\n\n  var exportMethod = function exportMethod() {\n    var book = _xlsx[\"default\"].utils.book_new();\n\n    var list = (isHeader ? colList : []).concat(rowList).concat(footList);\n\n    var sheet = _xlsx[\"default\"].utils.json_to_sheet(list.length ? list : [{}], {\n      skipHeader: true\n    });\n\n    sheet['!cols'] = sheetCols;\n    sheet['!merges'] = sheetMerges; // 转换数据\n\n    _xlsx[\"default\"].utils.book_append_sheet(book, sheet, sheetName);\n\n    var wbout = _xlsx[\"default\"].write(book, {\n      bookType: 'xlsx',\n      bookSST: false,\n      type: 'binary'\n    });\n\n    var blob = new Blob([toBuffer(wbout)], {\n      type: 'application/octet-stream'\n    }); // 导出 xlsx\n\n    downloadFile(params, blob, options);\n\n    if (showMsg) {\n      modal.close(msgKey);\n      modal.message({\n        message: t('vxe.table.expSuccess'),\n        status: 'success'\n      });\n    }\n  };\n\n  if (showMsg) {\n    modal.message({\n      id: msgKey,\n      message: t('vxe.table.expLoading'),\n      status: 'loading',\n      duration: -1\n    });\n    setTimeout(exportMethod, 1500);\n  } else {\n    exportMethod();\n  }\n}\n\nfunction downloadFile(params, blob, options) {\n  var $table = params.$table;\n  var $vxe = $table.$vxe;\n  var modal = $vxe.modal,\n      t = $vxe.t;\n  var message = options.message,\n      filename = options.filename,\n      type = options.type;\n  var showMsg = message !== false;\n\n  if (window.Blob) {\n    if (navigator.msSaveBlob) {\n      navigator.msSaveBlob(blob, \"\".concat(filename, \".\").concat(type));\n    } else {\n      var linkElem = document.createElement('a');\n      linkElem.target = '_blank';\n      linkElem.download = \"\".concat(filename, \".\").concat(type);\n      linkElem.href = URL.createObjectURL(blob);\n      document.body.appendChild(linkElem);\n      linkElem.click();\n      document.body.removeChild(linkElem);\n    }\n  } else {\n    if (showMsg) {\n      modal.alert({\n        message: t('vxe.error.notExp'),\n        status: 'error'\n      });\n    }\n  }\n}\n\nfunction checkImportData(tableFields, fields) {\n  return fields.some(function (field) {\n    return tableFields.indexOf(field) > -1;\n  });\n}\n\nfunction importXLSX(params) {\n  var $table = params.$table,\n      columns = params.columns,\n      options = params.options,\n      file = params.file;\n  var $vxe = $table.$vxe,\n      _importResolve = $table._importResolve,\n      _importReject = $table._importReject;\n  var modal = $vxe.modal,\n      t = $vxe.t;\n  var showMsg = options.message !== false;\n  var fileReader = new FileReader();\n\n  fileReader.onload = function (e) {\n    var tableFields = [];\n    columns.forEach(function (column) {\n      var field = column.property;\n\n      if (field) {\n        tableFields.push(field);\n      }\n    });\n\n    var workbook = _xlsx[\"default\"].read(e.target.result, {\n      type: 'binary'\n    });\n\n    var rest = _xlsx[\"default\"].utils.sheet_to_json(_ctor[\"default\"].first(workbook.Sheets));\n\n    var fields = rest ? _ctor[\"default\"].keys(rest[0]) : [];\n    var list = rest;\n    var status = checkImportData(tableFields, fields);\n\n    if (status) {\n      var records = list.map(function (item) {\n        var record = {};\n        tableFields.forEach(function (field) {\n          record[field] = _ctor[\"default\"].isUndefined(item[field]) ? null : item[field];\n        });\n        return record;\n      });\n      $table.createData(records).then(function (data) {\n        var loadRest;\n\n        if (options.mode === 'insert') {\n          loadRest = $table.insertAt(data, -1);\n        } else {\n          loadRest = $table.reloadData(data);\n        }\n\n        return loadRest.then(function () {\n          if (_importResolve) {\n            _importResolve({\n              status: true\n            });\n          }\n        });\n      });\n\n      if (showMsg) {\n        modal.message({\n          message: t('vxe.table.impSuccess', [records.length]),\n          status: 'success'\n        });\n      }\n    } else {\n      if (showMsg) {\n        modal.message({\n          message: t('vxe.error.impFields'),\n          status: 'error'\n        });\n      }\n\n      if (_importReject) {\n        _importReject({\n          status: false\n        });\n      }\n    }\n  };\n\n  fileReader.readAsBinaryString(file);\n}\n\nfunction handleImportEvent(params) {\n  if (params.options.type === 'xlsx') {\n    importXLSX(params);\n    return false;\n  }\n}\n\nfunction handleExportEvent(params) {\n  if (params.options.type === 'xlsx') {\n    exportXLSX(params);\n    return false;\n  }\n}\n/**\n * 基于 vxe-table 表格的增强插件，支持导出 xlsx 格式\n */\n\n\nvar VXETablePluginExportXLSX = {\n  install: function install(vxetable) {\n    var interceptor = vxetable.interceptor;\n    vxetable.setup({\n      \"export\": {\n        types: {\n          xlsx: 0\n        }\n      }\n    });\n    interceptor.mixin({\n      'event.import': handleImportEvent,\n      'event.export': handleExportEvent\n    });\n  }\n};\nexports.VXETablePluginExportXLSX = VXETablePluginExportXLSX;\n\nif (typeof window !== 'undefined' && window.VXETable) {\n  window.VXETable.use(VXETablePluginExportXLSX);\n}\n\nvar _default = VXETablePluginExportXLSX;\nexports[\"default\"] = _default;\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIiwiaW5kZXguanMiXSwibmFtZXMiOlsiZ2V0Rm9vdGVyQ2VsbFZhbHVlIiwiJHRhYmxlIiwib3B0cyIsInJvd3MiLCJjb2x1bW4iLCJjZWxsVmFsdWUiLCIkZ2V0Q29sdW1uSW5kZXgiLCJnZXRGb290ZXJEYXRhIiwiZm9vdGVyRGF0YSIsImZvb3RlckZpbHRlck1ldGhvZCIsImZpbHRlciIsIml0ZW1zIiwiaW5kZXgiLCIkcm93SW5kZXgiLCJ0b0J1ZmZlciIsIndib3V0IiwiYnVmIiwiQXJyYXlCdWZmZXIiLCJsZW5ndGgiLCJ2aWV3IiwiVWludDhBcnJheSIsImNoYXJDb2RlQXQiLCJnZXRDZWxsTGFiZWwiLCJjZWxsVHlwZSIsImlzTmFOIiwiTnVtYmVyIiwiZ2V0VmFsaWRDb2x1bW4iLCJjaGlsZE5vZGVzIiwiaXNDb2xHcm91cCIsImV4cG9ydFhMU1giLCJwYXJhbXMiLCJtc2dLZXkiLCJvcHRpb25zIiwiY29sdW1ucyIsImNvbGdyb3VwcyIsImRhdGFzIiwiJHZ4ZSIsIm1vZGFsIiwidCIsIm1lc3NhZ2UiLCJzaGVldE5hbWUiLCJpc0hlYWRlciIsImlzRm9vdGVyIiwiaXNNZXJnZSIsImlzQ29sZ3JvdXAiLCJvcmlnaW5hbCIsInNob3dNc2ciLCJtZXJnZUNlbGxzIiwiZ2V0TWVyZ2VDZWxscyIsImNvbExpc3QiLCJmb290TGlzdCIsInNoZWV0Q29scyIsInNoZWV0TWVyZ2VzIiwiY29sSGVhZCIsImZvckVhY2giLCJpZCIsInByb3BlcnR5IiwiZ2V0VGl0bGUiLCJwdXNoIiwid3B4IiwiWEVVdGlscyIsInRvSW50ZWdlciIsInJlbmRlcldpZHRoIiwiY29scyIsInJJbmRleCIsImdyb3VwSGVhZCIsIl9jb2xTcGFuIiwiX3Jvd1NwYW4iLCJ2YWxpZENvbHVtbiIsImNvbHVtbkluZGV4IiwiaW5kZXhPZiIsInMiLCJyIiwiYyIsImUiLCJtZXJnZUl0ZW0iLCJtZXJnZVJvd0luZGV4Iiwicm93IiwibWVyZ2VSb3dzcGFuIiwicm93c3BhbiIsIm1lcmdlQ29sSW5kZXgiLCJjb2wiLCJtZXJnZUNvbHNwYW4iLCJjb2xzcGFuIiwicm93SW5kZXgiLCJnZXRWVFJvd0luZGV4IiwiX3JvdyIsInJvd0xpc3QiLCJtYXAiLCJpdGVtIiwicmVzdCIsImdldFRhYmxlRGF0YSIsImZvb3RlcnMiLCJleHBvcnRNZXRob2QiLCJib29rIiwiWExTWCIsInV0aWxzIiwiYm9va19uZXciLCJsaXN0IiwiY29uY2F0Iiwic2hlZXQiLCJqc29uX3RvX3NoZWV0Iiwic2tpcEhlYWRlciIsImJvb2tfYXBwZW5kX3NoZWV0Iiwid3JpdGUiLCJib29rVHlwZSIsImJvb2tTU1QiLCJ0eXBlIiwiYmxvYiIsIkJsb2IiLCJkb3dubG9hZEZpbGUiLCJjbG9zZSIsInN0YXR1cyIsImR1cmF0aW9uIiwic2V0VGltZW91dCIsImZpbGVuYW1lIiwid2luZG93IiwibmF2aWdhdG9yIiwibXNTYXZlQmxvYiIsImxpbmtFbGVtIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwidGFyZ2V0IiwiZG93bmxvYWQiLCJocmVmIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJyZW1vdmVDaGlsZCIsImFsZXJ0IiwiY2hlY2tJbXBvcnREYXRhIiwidGFibGVGaWVsZHMiLCJmaWVsZHMiLCJzb21lIiwiZmllbGQiLCJpbXBvcnRYTFNYIiwiZmlsZSIsIl9pbXBvcnRSZXNvbHZlIiwiX2ltcG9ydFJlamVjdCIsImZpbGVSZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwid29ya2Jvb2siLCJyZWFkIiwicmVzdWx0Iiwic2hlZXRfdG9fanNvbiIsImZpcnN0IiwiU2hlZXRzIiwia2V5cyIsInJlY29yZHMiLCJyZWNvcmQiLCJpc1VuZGVmaW5lZCIsImNyZWF0ZURhdGEiLCJ0aGVuIiwiZGF0YSIsImxvYWRSZXN0IiwibW9kZSIsImluc2VydEF0IiwicmVsb2FkRGF0YSIsInJlYWRBc0JpbmFyeVN0cmluZyIsImhhbmRsZUltcG9ydEV2ZW50IiwiaGFuZGxlRXhwb3J0RXZlbnQiLCJWWEVUYWJsZVBsdWdpbkV4cG9ydFhMU1giLCJpbnN0YWxsIiwidnhldGFibGUiLCJpbnRlcmNlcHRvciIsInNldHVwIiwidHlwZXMiLCJ4bHN4IiwibWl4aW4iLCJWWEVUYWJsZSIsInVzZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOztBQVNBOzs7O0FBVkE7O0FBV0E7QUFFQSxTQUFTQSxrQkFBVCxDQUE2QkMsTUFBN0IsRUFBNENDLElBQTVDLEVBQXFFQyxJQUFyRSxFQUFrRkMsTUFBbEYsRUFBc0c7QUFDcEcsTUFBTUMsU0FBUyxHQUFHRixJQUFJLENBQUNGLE1BQU0sQ0FBQ0ssZUFBUCxDQUF1QkYsTUFBdkIsQ0FBRCxDQUF0QjtBQUNBLFNBQU9DLFNBQVA7QUFDRDs7QUFFRCxTQUFTRSxhQUFULENBQXdCTCxJQUF4QixFQUFpRE0sVUFBakQsRUFBb0U7QUFBQSxNQUMxREMsa0JBRDBELEdBQ25DUCxJQURtQyxDQUMxRE8sa0JBRDBEO0FBRWxFLFNBQU9BLGtCQUFrQixHQUFHRCxVQUFVLENBQUNFLE1BQVgsQ0FBa0IsVUFBQ0MsS0FBRCxFQUFRQyxLQUFSO0FBQUEsV0FBa0JILGtCQUFrQixDQUFDO0FBQUVFLE1BQUFBLEtBQUssRUFBTEEsS0FBRjtBQUFTRSxNQUFBQSxTQUFTLEVBQUVEO0FBQXBCLEtBQUQsQ0FBcEM7QUFBQSxHQUFsQixDQUFILEdBQTBGSixVQUFuSDtBQUNEOztBQUVELFNBQVNNLFFBQVQsQ0FBbUJDLEtBQW5CLEVBQTZCO0FBQzNCLE1BQU1DLEdBQUcsR0FBRyxJQUFJQyxXQUFKLENBQWdCRixLQUFLLENBQUNHLE1BQXRCLENBQVo7QUFDQSxNQUFNQyxJQUFJLEdBQUcsSUFBSUMsVUFBSixDQUFlSixHQUFmLENBQWI7O0FBQ0EsT0FBSyxJQUFJSixLQUFLLEdBQUcsQ0FBakIsRUFBb0JBLEtBQUssS0FBS0csS0FBSyxDQUFDRyxNQUFwQyxFQUE0QyxFQUFFTixLQUE5QztBQUFxRE8sSUFBQUEsSUFBSSxDQUFDUCxL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QUFVLENBQUMzRyxNQUFELENBQVY7QUFDQSxXQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVELFNBQVNxSSxpQkFBVCxDQUE0QnJJLE1BQTVCLEVBQTJEO0FBQ3pELE1BQUlBLE1BQU0sQ0FBQ0UsT0FBUCxDQUFlMkUsSUFBZixLQUF3QixNQUE1QixFQUFvQztBQUNsQzlFLElBQUFBLFVBQVUsQ0FBQ0MsTUFBRCxDQUFWO0FBQ0EsV0FBTyxLQUFQO0FBQ0Q7QUFDRjtBQUVEO0FDNUJBO0FBQ0E7OztBRDhCTyxJQUFNc0ksd0JBQXdCLEdBQUc7QUFDdENDLEVBQUFBLE9BRHNDLG1CQUM3QkMsUUFENkIsRUFDSjtBQUFBLFFBQ3hCQyxXQUR3QixHQUNSRCxRQURRLENBQ3hCQyxXQUR3QjtBQUVoQ0QsSUFBQUEsUUFBUSxDQUFDRSxLQUFULENBQWU7QUFDYixnQkFBUTtBQUNOQyxRQUFBQSxLQUFLLEVBQUU7QUFDTEMsVUFBQUEsSUFBSSxFQUFFO0FBREQ7QUFERDtBQURLLEtBQWY7QUFPQUgsSUFBQUEsV0FBVyxDQUFDSSxLQUFaLENBQWtCO0FBQ2hCLHNCQUFnQlQsaUJBREE7QUFFaEIsc0JBQWdCQztBQUZBLEtBQWxCO0FBSUQ7QUFkcUMsQ0FBakM7OztBQWlCUCxJQUFJLE9BQU8vQyxNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUN3RCxRQUE1QyxFQUFzRDtBQUNwRHhELEVBQUFBLE1BQU0sQ0FBQ3dELFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CVCx3QkFBcEI7QUFDRDs7ZUFFY0Esd0IiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cclxuaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvY3RvcidcclxuaW1wb3J0IHtcclxuICBWWEVUYWJsZSxcclxuICBUYWJsZSxcclxuICBJbnRlcmNlcHRvckV4cG9ydFBhcmFtcyxcclxuICBJbnRlcmNlcHRvckltcG9ydFBhcmFtcyxcclxuICBDb2x1bW5Db25maWcsXHJcbiAgVGFibGVFeHBvcnRDb25maWdcclxufSBmcm9tICd2eGUtdGFibGUvbGliL3Z4ZS10YWJsZSdcclxuaW1wb3J0IFhMU1ggZnJvbSAneGxzeCdcclxuLyogZXNsaW50LWVuYWJsZSBuby11bnVzZWQtdmFycyAqL1xyXG5cclxuZnVuY3Rpb24gZ2V0Rm9vdGVyQ2VsbFZhbHVlICgkdGFibGU6IFRhYmxlLCBvcHRzOiBUYWJsZUV4cG9ydENvbmZpZywgcm93czogYW55W10sIGNvbHVtbjogQ29sdW1uQ29uZmlnKSB7XHJcbiAgY29uc3QgY2VsbFZhbHVlID0gcm93c1skdGFibGUuJGdldENvbHVtbkluZGV4KGNvbHVtbildXHJcbiAgcmV0dXJuIGNlbGxWYWx1ZVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRGb290ZXJEYXRhIChvcHRzOiBUYWJsZUV4cG9ydENvbmZpZywgZm9vdGVyRGF0YTogYW55W11bXSkge1xyXG4gIGNvbnN0IHsgZm9vdGVyRmlsdGVyTWV0aG9kIH0gPSBvcHRzXHJcbiAgcmV0dXJuIGZvb3RlckZpbHRlck1ldGhvZCA/IGZvb3RlckRhdGEuZmlsdGVyKChpdGVtcywgaW5kZXgpID0+IGZvb3RlckZpbHRlck1ldGhvZCh7IGl0ZW1zLCAkcm93SW5kZXg6IGluZGV4IH0pKSA6IGZvb3RlckRhdGFcclxufVxyXG5cclxuZnVuY3Rpb24gdG9CdWZmZXIgKHdib3V0OiBhbnkpIHtcclxuICBjb25zdCBidWYgPSBuZXcgQXJyYXlCdWZmZXIod2JvdXQubGVuZ3RoKVxyXG4gIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShidWYpXHJcbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCAhPT0gd2JvdXQubGVuZ3RoOyArK2luZGV4KSB2aWV3W2luZGV4XSA9IHdib3V0LmNoYXJDb2RlQXQoaW5kZXgpICYgMHhGRlxyXG4gIHJldHVybiBidWZcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2VsbExhYmVsIChjb2x1bW46IENvbHVtbkNvbmZpZywgY2VsbFZhbHVlOiBhbnkpIHtcclxuICBpZiAoY2VsbFZhbHVlKSB7XHJcbiAgICBzd2l0Y2ggKGNvbHVtbi5jZWxsVHlwZSkge1xyXG4gICAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgaWYgKCFpc05hTihjZWxsVmFsdWUpKSB7XHJcbiAgICAgICAgICByZXR1cm4gTnVtYmVyKGNlbGxWYWx1ZSlcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBpZiAoY2VsbFZhbHVlLmxlbmd0aCA8IDEyICYmICFpc05hTihjZWxsVmFsdWUpKSB7XHJcbiAgICAgICAgICByZXR1cm4gTnVtYmVyKGNlbGxWYWx1ZSlcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIGNlbGxWYWx1ZVxyXG59XHJcblxyXG5kZWNsYXJlIG1vZHVsZSAndnhlLXRhYmxlL2xpYi92eGUtdGFibGUnIHtcclxuICBpbnRlcmZhY2UgQ29sdW1uSW5mbyB7XHJcbiAgICBfcm93OiBhbnk7XHJcbiAgICBfY29sU3BhbjogbnVtYmVyO1xyXG4gICAgX3Jvd1NwYW46IG51bWJlcjtcclxuICAgIGNoaWxkTm9kZXM6IENvbHVtbkNvbmZpZ1tdO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VmFsaWRDb2x1bW4gKGNvbHVtbjogQ29sdW1uQ29uZmlnKTogQ29sdW1uQ29uZmlnIHtcclxuICBjb25zdCB7IGNoaWxkTm9kZXMgfSA9IGNvbHVtblxyXG4gIGNvbnN0IGlzQ29sR3JvdXAgPSBjaGlsZE5vZGVzICYmIGNoaWxkTm9kZXMubGVuZ3RoXHJcbiAgaWYgKGlzQ29sR3JvdXApIHtcclxuICAgIHJldHVybiBnZXRWYWxpZENvbHVtbihjaGlsZE5vZGVzWzBdKVxyXG4gIH1cclxuICByZXR1cm4gY29sdW1uXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV4cG9ydFhMU1ggKHBhcmFtczogSW50ZXJjZXB0b3JFeHBvcnRQYXJhbXMpIHtcclxuICBjb25zdCBtc2dLZXkgPSAneGxzeCdcclxuICBjb25zdCB7ICR0YWJsZSwgb3B0aW9ucywgY29sdW1ucywgY29sZ3JvdXBzLCBkYXRhcyB9ID0gcGFyYW1zXHJcbiAgY29uc3QgeyAkdnhlIH0gPSAkdGFibGVcclxuICBjb25zdCB7IG1vZGFsLCB0IH0gPSAkdnhlXHJcbiAgY29uc3QgeyBtZXNzYWdlLCBzaGVldE5hbWUsIGlzSGVhZGVyLCBpc0Zvb3RlciwgaXNNZXJnZSwgaXNDb2xncm91cCwgb3JpZ2luYWwgfSA9IG9wdGlvbnNcclxuICBjb25zdCBzaG93TXNnID0gbWVzc2FnZSAhPT0gZmFsc2VcclxuICBjb25zdCBtZXJnZUNlbGxzID0gJHRhYmxlLmdldE1lcmdlQ2VsbHMoKVxyXG4gIGNvbnN0IGNvbExpc3Q6IGFueVtdID0gW11cclxuICBjb25zdCBmb290TGlzdDogYW55W10gPSBbXVxyXG4gIGNvbnN0IHNoZWV0Q29sczogeyB3cHg6IG51bWJlciB9W10gPSBbXVxyXG4gIGNvbnN0IHNoZWV0TWVyZ2VzOiB7IHM6IHsgcjogbnVtYmVyLCBjOiBudW1iZXIgfSwgZTogeyByOiBudW1iZXIsIGM6IG51bWJlciB9IH1bXSA9IFtdXHJcbiAgLy8g5aSE55CG6KGo5aS0XHJcbiAgaWYgKGlzSGVhZGVyKSB7XHJcbiAgICBjb25zdCBjb2xIZWFkOiBhbnkgPSB7fVxyXG4gICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgICAgY29sSGVhZFtjb2x1bW4uaWRdID0gb3JpZ2luYWwgPyBjb2x1bW4ucHJvcGVydHkgOiBjb2x1bW4uZ2V0VGl0bGUoKVxyXG4gICAgICBzaGVldENvbHMucHVzaCh7XHJcbiAgICAgICAgd3B4OiBYRVV0aWxzLnRvSW50ZWdlcihjb2x1bW4ucmVuZGVyV2lkdGggKiAwLjc1KVxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIGlmIChpc0NvbGdyb3VwICYmICFvcmlnaW5hbCAmJiBjb2xncm91cHMpIHtcclxuICAgICAgY29sZ3JvdXBzLmZvckVhY2goKGNvbHMsIHJJbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBncm91cEhlYWQ6IGFueSA9IHt9XHJcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgICAgICAgIGdyb3VwSGVhZFtjb2x1bW4uaWRdID0gbnVsbFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29scy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgICAgICAgIGNvbnN0IHsgX2NvbFNwYW4sIF9yb3dTcGFuIH0gPSBjb2x1bW5cclxuICAgICAgICAgIGNvbnN0IHZhbGlkQ29sdW1uID0gZ2V0VmFsaWRDb2x1bW4oY29sdW1uKVxyXG4gICAgICAgICAgY29uc3QgY29sdW1uSW5kZXggPSBjb2x1bW5zLmluZGV4T2YodmFsaWRDb2x1bW4pXHJcbiAgICAgICAgICBncm91cEhlYWRbdmFsaWRDb2x1bW4uaWRdID0gb3JpZ2luYWwgPyB2YWxpZENvbHVtbi5wcm9wZXJ0eSA6IGNvbHVtbi5nZXRUaXRsZSgpXHJcbiAgICAgICAgICBpZiAoX2NvbFNwYW4gPiAxIHx8IF9yb3dTcGFuID4gMSkge1xyXG4gICAgICAgICAgICBzaGVldE1lcmdlcy5wdXNoKHtcclxuICAgICAgICAgICAgICBzOiB7IHI6IHJJbmRleCwgYzogY29sdW1uSW5kZXggfSxcclxuICAgICAgICAgICAgICBlOiB7IHI6IHJJbmRleCArIF9yb3dTcGFuIC0gMSwgYzogY29sdW1uSW5kZXggKyBfY29sU3BhbiAtIDEgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29sTGlzdC5wdXNoKGdyb3VwSGVhZClcclxuICAgICAgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbExpc3QucHVzaChjb2xIZWFkKVxyXG4gICAgfVxyXG4gIH1cclxuICAvLyDlpITnkIblkIjlubZcclxuICBpZiAoaXNNZXJnZSAmJiAhb3JpZ2luYWwpIHtcclxuICAgIG1lcmdlQ2VsbHMuZm9yRWFjaChtZXJnZUl0ZW0gPT4ge1xyXG4gICAgICBsZXQgeyByb3c6IG1lcmdlUm93SW5kZXgsIHJvd3NwYW46IG1lcmdlUm93c3BhbiwgY29sOiBtZXJnZUNvbEluZGV4LCBjb2xzcGFuOiBtZXJnZUNvbHNwYW4gfSA9IG1lcmdlSXRlbVxyXG4gICAgICBmb3IgKGxldCBySW5kZXggPSAwOyBySW5kZXggPCBkYXRhcy5sZW5ndGg7IHJJbmRleCsrKSB7XHJcbiAgICAgICAgbGV0IHJvd0luZGV4ID0gJHRhYmxlLmdldFZUUm93SW5kZXgoZGF0YXNbckluZGV4XS5fcm93KVxyXG4gICAgICAgIGlmIChyb3dJbmRleCA9PT0gbWVyZ2VSb3dJbmRleCkge1xyXG4gICAgICAgICAgaWYgKGlzSGVhZGVyICYmIGNvbGdyb3Vwcykge1xyXG4gICAgICAgICAgICByb3dJbmRleCA9IHJJbmRleCArIGNvbGdyb3Vwcy5sZW5ndGhcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHNoZWV0TWVyZ2VzLnB1c2goe1xyXG4gICAgICAgICAgICBzOiB7IHI6IHJvd0luZGV4LCBjOiBtZXJnZUNvbEluZGV4IH0sXHJcbiAgICAgICAgICAgIGU6IHsgcjogcm93SW5kZXggKyBtZXJnZVJvd3NwYW4gLSAxLCBjOiBtZXJnZUNvbEluZGV4ICsgbWVyZ2VDb2xzcGFuIC0gMSB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG4gIGNvbnN0IHJvd0xpc3QgPSBkYXRhcy5tYXAoaXRlbSA9PiB7XHJcbiAgICBjb25zdCByZXN0OiBhbnkgPSB7fVxyXG4gICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgICAgcmVzdFtjb2x1bW4uaWRdID0gZ2V0Q2VsbExhYmVsKGNvbHVtbiwgaXRlbVtjb2x1bW4uaWRdKVxyXG4gICAgfSlcclxuICAgIHJldHVybiByZXN0XHJcbiAgfSlcclxuICAvLyDlpITnkIbooajlsL5cclxuICBpZiAoaXNGb290ZXIpIHtcclxuICAgIGNvbnN0IHsgZm9vdGVyRGF0YSB9ID0gJHRhYmxlLmdldFRhYmxlRGF0YSgpXHJcbiAgICBjb25zdCBmb290ZXJzID0gZ2V0Rm9vdGVyRGF0YShvcHRpb25zLCBmb290ZXJEYXRhKVxyXG4gICAgZm9vdGVycy5mb3JFYWNoKChyb3dzKSA9PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW06IGFueSA9IHt9XHJcbiAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XHJcbiAgICAgICAgaXRlbVtjb2x1bW4uaWRdID0gZ2V0Rm9vdGVyQ2VsbFZhbHVlKCR0YWJsZSwgb3B0aW9ucywgcm93cywgY29sdW1uKVxyXG4gICAgICB9KVxyXG4gICAgICBmb290TGlzdC5wdXNoKGl0ZW0pXHJcbiAgICB9KVxyXG4gIH1cclxuICBjb25zdCBleHBvcnRNZXRob2QgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBib29rID0gWExTWC51dGlscy5ib29rX25ldygpXHJcbiAgICBjb25zdCBsaXN0ID0gKGlzSGVhZGVyID8gY29sTGlzdCA6IFtdKS5jb25jYXQocm93TGlzdCkuY29uY2F0KGZvb3RMaXN0KVxyXG4gICAgY29uc3Qgc2hlZXQgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQobGlzdC5sZW5ndGggPyBsaXN0IDogW3t9XSwgeyBza2lwSGVhZGVyOiB0cnVlIH0pXHJcbiAgICBzaGVldFsnIWNvbHMnXSA9IHNoZWV0Q29sc1xyXG4gICAgc2hlZXRbJyFtZXJnZXMnXSA9IHNoZWV0TWVyZ2VzXHJcbiAgICAvLyDovazmjaLmlbDmja5cclxuICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQoYm9vaywgc2hlZXQsIHNoZWV0TmFtZSlcclxuICAgIGNvbnN0IHdib3V0ID0gWExTWC53cml0ZShib29rLCB7IGJvb2tUeXBlOiAneGxzeCcsIGJvb2tTU1Q6IGZhbHNlLCB0eXBlOiAnYmluYXJ5JyB9KVxyXG4gICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFt0b0J1ZmZlcih3Ym91dCldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pXHJcbiAgICAvLyDlr7zlh7ogeGxzeFxyXG4gICAgZG93bmxvYWRGaWxlKHBhcmFtcywgYmxvYiwgb3B0aW9ucylcclxuICAgIGlmIChzaG93TXNnKSB7XHJcbiAgICAgIG1vZGFsLmNsb3NlKG1zZ0tleSlcclxuICAgICAgbW9kYWwubWVzc2FnZSh7IG1lc3NhZ2U6IHQoJ3Z4ZS50YWJsZS5leHBTdWNjZXNzJyksIHN0YXR1czogJ3N1Y2Nlc3MnIH0pXHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChzaG93TXNnKSB7XHJcbiAgICBtb2RhbC5tZXNzYWdlKHsgaWQ6IG1zZ0tleSwgbWVzc2FnZTogdCgndnhlLnRhYmxlLmV4cExvYWRpbmcnKSwgc3RhdHVzOiAnbG9hZGluZycsIGR1cmF0aW9uOiAtMSB9KVxyXG4gICAgc2V0VGltZW91dChleHBvcnRNZXRob2QsIDE1MDApXHJcbiAgfSBlbHNlIHtcclxuICAgIGV4cG9ydE1ldGhvZCgpXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkb3dubG9hZEZpbGUgKHBhcmFtczogSW50ZXJjZXB0b3JFeHBvcnRQYXJhbXMsIGJsb2I6IEJsb2IsIG9wdGlvbnM6IFRhYmxlRXhwb3J0Q29uZmlnKSB7XHJcbiAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gIGNvbnN0IHsgJHZ4ZSB9ID0gJHRhYmxlXHJcbiAgY29uc3QgeyBtb2RhbCwgdCB9ID0gJHZ4ZVxyXG4gIGNvbnN0IHsgbWVzc2FnZSwgZmlsZW5hbWUsIHR5cGUgfSA9IG9wdGlvbnNcclxuICBjb25zdCBzaG93TXNnID0gbWVzc2FnZSAhPT0gZmFsc2VcclxuICBpZiAod2luZG93LkJsb2IpIHtcclxuICAgIGlmIChuYXZpZ2F0b3IubXNTYXZlQmxvYikge1xyXG4gICAgICBuYXZpZ2F0b3IubXNTYXZlQmxvYihibG9iLCBgJHtmaWxlbmFtZX0uJHt0eXBlfWApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBsaW5rRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxyXG4gICAgICBsaW5rRWxlbS50YXJnZXQgPSAnX2JsYW5rJ1xyXG4gICAgICBsaW5rRWxlbS5kb3dubG9hZCA9IGAke2ZpbGVuYW1lfS4ke3R5cGV9YFxyXG4gICAgICBsaW5rRWxlbS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKVxyXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmtFbGVtKVxyXG4gICAgICBsaW5rRWxlbS5jbGljaygpXHJcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGlua0VsZW0pXHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGlmIChzaG93TXNnKSB7XHJcbiAgICAgIG1vZGFsLmFsZXJ0KHsgbWVzc2FnZTogdCgndnhlLmVycm9yLm5vdEV4cCcpLCBzdGF0dXM6ICdlcnJvcicgfSlcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrSW1wb3J0RGF0YSAodGFibGVGaWVsZHM6IHN0cmluZ1tdLCBmaWVsZHM6IHN0cmluZ1tdKSB7XHJcbiAgcmV0dXJuIGZpZWxkcy5zb21lKGZpZWxkID0+IHRhYmxlRmllbGRzLmluZGV4T2YoZmllbGQpID4gLTEpXHJcbn1cclxuXHJcbmRlY2xhcmUgbW9kdWxlICd2eGUtdGFibGUvbGliL3Z4ZS10YWJsZScge1xyXG4gIGludGVyZmFjZSBUYWJsZSB7XHJcbiAgICBfaW1wb3J0UmVzb2x2ZT86IEZ1bmN0aW9uIHwgbnVsbDtcclxuICAgIF9pbXBvcnRSZWplY3Q/OiBGdW5jdGlvbiB8IG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbXBvcnRYTFNYIChwYXJhbXM6IEludGVyY2VwdG9ySW1wb3J0UGFyYW1zKSB7XHJcbiAgY29uc3QgeyAkdGFibGUsIGNvbHVtbnMsIG9wdGlvbnMsIGZpbGUgfSA9IHBhcmFtc1xyXG4gIGNvbnN0IHsgJHZ4ZSwgX2ltcG9ydFJlc29sdmUsIF9pbXBvcnRSZWplY3QgfSA9ICR0YWJsZVxyXG4gIGNvbnN0IHsgbW9kYWwsIHQgfSA9ICR2eGVcclxuICBjb25zdCBzaG93TXNnID0gb3B0aW9ucy5tZXNzYWdlICE9PSBmYWxzZVxyXG4gIGNvbnN0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXHJcbiAgZmlsZVJlYWRlci5vbmxvYWQgPSAoZTogYW55KSA9PiB7XHJcbiAgICBjb25zdCB0YWJsZUZpZWxkczogc3RyaW5nW10gPSBbXVxyXG4gICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgICAgY29uc3QgZmllbGQgPSBjb2x1bW4ucHJvcGVydHlcclxuICAgICAgaWYgKGZpZWxkKSB7XHJcbiAgICAgICAgdGFibGVGaWVsZHMucHVzaChmaWVsZClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGUudGFyZ2V0LnJlc3VsdCwgeyB0eXBlOiAnYmluYXJ5JyB9KVxyXG4gICAgY29uc3QgcmVzdCA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihYRVV0aWxzLmZpcnN0KHdvcmtib29rLlNoZWV0cykpIGFzIGFueVtdXHJcbiAgICBjb25zdCBmaWVsZHMgPSByZXN0ID8gWEVVdGlscy5rZXlzKHJlc3RbMF0pIDogW11cclxuICAgIGNvbnN0IGxpc3QgPSByZXN0XHJcbiAgICBjb25zdCBzdGF0dXMgPSBjaGVja0ltcG9ydERhdGEodGFibGVGaWVsZHMsIGZpZWxkcylcclxuICAgIGlmIChzdGF0dXMpIHtcclxuICAgICAgY29uc3QgcmVjb3JkczogYW55W10gPSBsaXN0Lm1hcChpdGVtID0+IHtcclxuICAgICAgICBjb25zdCByZWNvcmQ6IGFueSA9IHt9XHJcbiAgICAgICAgdGFibGVGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICAgICAgICByZWNvcmRbZmllbGRdID0gWEVVdGlscy5pc1VuZGVmaW5lZChpdGVtW2ZpZWxkXSkgPyBudWxsIDogaXRlbVtmaWVsZF1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiByZWNvcmRcclxuICAgICAgfSlcclxuICAgICAgJHRhYmxlLmNyZWF0ZURhdGEocmVjb3JkcylcclxuICAgICAgICAudGhlbigoZGF0YTogYW55W10pID0+IHtcclxuICAgICAgICAgIGxldCBsb2FkUmVzdDogUHJvbWlzZTxhbnk+XHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlID09PSAnaW5zZXJ0Jykge1xyXG4gICAgICAgICAgICBsb2FkUmVzdCA9ICR0YWJsZS5pbnNlcnRBdChkYXRhLCAtMSlcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxvYWRSZXN0ID0gJHRhYmxlLnJlbG9hZERhdGEoZGF0YSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBsb2FkUmVzdC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKF9pbXBvcnRSZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgX2ltcG9ydFJlc29sdmUoeyBzdGF0dXM6IHRydWUgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICBpZiAoc2hvd01zZykge1xyXG4gICAgICAgIG1vZGFsLm1lc3NhZ2UoeyBtZXNzYWdlOiB0KCd2eGUudGFibGUuaW1wU3VjY2VzcycsIFtyZWNvcmRzLmxlbmd0aF0pLCBzdGF0dXM6ICdzdWNjZXNzJyB9KVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoc2hvd01zZykge1xyXG4gICAgICAgIG1vZGFsLm1lc3NhZ2UoeyBtZXNzYWdlOiB0KCd2eGUuZXJyb3IuaW1wRmllbGRzJyksIHN0YXR1czogJ2Vycm9yJyB9KVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChfaW1wb3J0UmVqZWN0KSB7XHJcbiAgICAgICAgX2ltcG9ydFJlamVjdCh7IHN0YXR1czogZmFsc2UgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBmaWxlUmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyhmaWxlKVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbXBvcnRFdmVudCAocGFyYW1zOiBJbnRlcmNlcHRvckltcG9ydFBhcmFtcykge1xyXG4gIGlmIChwYXJhbXMub3B0aW9ucy50eXBlID09PSAneGxzeCcpIHtcclxuICAgIGltcG9ydFhMU1gocGFyYW1zKVxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFeHBvcnRFdmVudCAocGFyYW1zOiBJbnRlcmNlcHRvckV4cG9ydFBhcmFtcykge1xyXG4gIGlmIChwYXJhbXMub3B0aW9ucy50eXBlID09PSAneGxzeCcpIHtcclxuICAgIGV4cG9ydFhMU1gocGFyYW1zKVxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog5Z+65LqOIHZ4ZS10YWJsZSDooajmoLznmoTlop7lvLrmj5Lku7bvvIzmlK/mjIHlr7zlh7ogeGxzeCDmoLzlvI9cclxuICovXHJcbmV4cG9ydCBjb25zdCBWWEVUYWJsZVBsdWdpbkV4cG9ydFhMU1ggPSB7XHJcbiAgaW5zdGFsbCAodnhldGFibGU6IHR5cGVvZiBWWEVUYWJsZSkge1xyXG4gICAgY29uc3QgeyBpbnRlcmNlcHRvciB9ID0gdnhldGFibGVcclxuICAgIHZ4ZXRhYmxlLnNldHVwKHtcclxuICAgICAgZXhwb3J0OiB7XHJcbiAgICAgICAgdHlwZXM6IHtcclxuICAgICAgICAgIHhsc3g6IDBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICBpbnRlcmNlcHRvci5taXhpbih7XHJcbiAgICAgICdldmVudC5pbXBvcnQnOiBoYW5kbGVJbXBvcnRFdmVudCxcclxuICAgICAgJ2V2ZW50LmV4cG9ydCc6IGhhbmRsZUV4cG9ydEV2ZW50XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5FeHBvcnRYTFNYKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbkV4cG9ydFhMU1hcclxuIiwiLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cbmltcG9ydCBYRVV0aWxzIGZyb20gJ3hlLXV0aWxzL2N0b3InO1xuaW1wb3J0IFhMU1ggZnJvbSAneGxzeCc7XG4vKiBlc2xpbnQtZW5hYmxlIG5vLXVudXNlZC12YXJzICovXG5mdW5jdGlvbiBnZXRGb290ZXJDZWxsVmFsdWUoJHRhYmxlLCBvcHRzLCByb3dzLCBjb2x1bW4pIHtcbiAgICBjb25zdCBjZWxsVmFsdWUgPSByb3dzWyR0YWJsZS4kZ2V0Q29sdW1uSW5kZXgoY29sdW1uKV07XG4gICAgcmV0dXJuIGNlbGxWYWx1ZTtcbn1cbmZ1bmN0aW9uIGdldEZvb3RlckRhdGEob3B0cywgZm9vdGVyRGF0YSkge1xuICAgIGNvbnN0IHsgZm9vdGVyRmlsdGVyTWV0aG9kIH0gPSBvcHRzO1xuICAgIHJldHVybiBmb290ZXJGaWx0ZXJNZXRob2QgPyBmb290ZXJEYXRhLmZpbHRlcigoaXRlbXMsIGluZGV4KSA9PiBmb290ZXJGaWx0ZXJNZXRob2QoeyBpdGVtcywgJHJvd0luZGV4OiBpbmRleCB9KSkgOiBmb290ZXJEYXRhO1xufVxuZnVuY3Rpb24gdG9CdWZmZXIod2JvdXQpIHtcbiAgICBjb25zdCBidWYgPSBuZXcgQXJyYXlCdWZmZXIod2JvdXQubGVuZ3RoKTtcbiAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKTtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4ICE9PSB3Ym91dC5sZW5ndGg7ICsraW5kZXgpXG4gICAgICAgIHZpZXdbaW5kZXhdID0gd2JvdXQuY2hhckNvZGVBdChpbmRleCkgJiAweEZGO1xuICAgIHJldHVybiBidWY7XG59XG5mdW5jdGlvbiBnZXRDZWxsTGFiZWwoY29sdW1uLCBjZWxsVmFsdWUpIHtcbiAgICBpZiAoY2VsbFZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAoY29sdW1uLmNlbGxUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbGxWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcihjZWxsVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKGNlbGxWYWx1ZS5sZW5ndGggPCAxMiAmJiAhaXNOYU4oY2VsbFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKGNlbGxWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjZWxsVmFsdWU7XG59XG5mdW5jdGlvbiBnZXRWYWxpZENvbHVtbihjb2x1bW4pIHtcbiAgICBjb25zdCB7IGNoaWxkTm9kZXMgfSA9IGNvbHVtbjtcbiAgICBjb25zdCBpc0NvbEdyb3VwID0gY2hpbGROb2RlcyAmJiBjaGlsZE5vZGVzLmxlbmd0aDtcbiAgICBpZiAoaXNDb2xHcm91cCkge1xuICAgICAgICByZXR1cm4gZ2V0VmFsaWRDb2x1bW4oY2hpbGROb2Rlc1swXSk7XG4gICAgfVxuICAgIHJldHVybiBjb2x1bW47XG59XG5mdW5jdGlvbiBleHBvcnRYTFNYKHBhcmFtcykge1xuICAgIGNvbnN0IG1zZ0tleSA9ICd4bHN4JztcbiAgICBjb25zdCB7ICR0YWJsZSwgb3B0aW9ucywgY29sdW1ucywgY29sZ3JvdXBzLCBkYXRhcyB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IHsgJHZ4ZSB9ID0gJHRhYmxlO1xuICAgIGNvbnN0IHsgbW9kYWwsIHQgfSA9ICR2eGU7XG4gICAgY29uc3QgeyBtZXNzYWdlLCBzaGVldE5hbWUsIGlzSGVhZGVyLCBpc0Zvb3RlciwgaXNNZXJnZSwgaXNDb2xncm91cCwgb3JpZ2luYWwgfSA9IG9wdGlvbnM7XG4gICAgY29uc3Qgc2hvd01zZyA9IG1lc3NhZ2UgIT09IGZhbHNlO1xuICAgIGNvbnN0IG1lcmdlQ2VsbHMgPSAkdGFibGUuZ2V0TWVyZ2VDZWxscygpO1xuICAgIGNvbnN0IGNvbExpc3QgPSBbXTtcbiAgICBjb25zdCBmb290TGlzdCA9IFtdO1xuICAgIGNvbnN0IHNoZWV0Q29scyA9IFtdO1xuICAgIGNvbnN0IHNoZWV0TWVyZ2VzID0gW107XG4gICAgLy8g5aSE55CG6KGo5aS0XG4gICAgaWYgKGlzSGVhZGVyKSB7XG4gICAgICAgIGNvbnN0IGNvbEhlYWQgPSB7fTtcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcbiAgICAgICAgICAgIGNvbEhlYWRbY29sdW1uLmlkXSA9IG9yaWdpbmFsID8gY29sdW1uLnByb3BlcnR5IDogY29sdW1uLmdldFRpdGxlKCk7XG4gICAgICAgICAgICBzaGVldENvbHMucHVzaCh7XG4gICAgICAgICAgICAgICAgd3B4OiBYRVV0aWxzLnRvSW50ZWdlcihjb2x1bW4ucmVuZGVyV2lkdGggKiAwLjc1KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaXNDb2xncm91cCAmJiAhb3JpZ2luYWwgJiYgY29sZ3JvdXBzKSB7XG4gICAgICAgICAgICBjb2xncm91cHMuZm9yRWFjaCgoY29scywgckluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGdyb3VwSGVhZCA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwSGVhZFtjb2x1bW4uaWRdID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb2xzLmZvckVhY2goKGNvbHVtbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IF9jb2xTcGFuLCBfcm93U3BhbiB9ID0gY29sdW1uO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxpZENvbHVtbiA9IGdldFZhbGlkQ29sdW1uKGNvbHVtbik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbkluZGV4ID0gY29sdW1ucy5pbmRleE9mKHZhbGlkQ29sdW1uKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBIZWFkW3ZhbGlkQ29sdW1uLmlkXSA9IG9yaWdpbmFsID8gdmFsaWRDb2x1bW4ucHJvcGVydHkgOiBjb2x1bW4uZ2V0VGl0bGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9jb2xTcGFuID4gMSB8fCBfcm93U3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0TWVyZ2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM6IHsgcjogckluZGV4LCBjOiBjb2x1bW5JbmRleCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IHsgcjogckluZGV4ICsgX3Jvd1NwYW4gLSAxLCBjOiBjb2x1bW5JbmRleCArIF9jb2xTcGFuIC0gMSB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbExpc3QucHVzaChncm91cEhlYWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2xMaXN0LnB1c2goY29sSGVhZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8g5aSE55CG5ZCI5bm2XG4gICAgaWYgKGlzTWVyZ2UgJiYgIW9yaWdpbmFsKSB7XG4gICAgICAgIG1lcmdlQ2VsbHMuZm9yRWFjaChtZXJnZUl0ZW0gPT4ge1xuICAgICAgICAgICAgbGV0IHsgcm93OiBtZXJnZVJvd0luZGV4LCByb3dzcGFuOiBtZXJnZVJvd3NwYW4sIGNvbDogbWVyZ2VDb2xJbmRleCwgY29sc3BhbjogbWVyZ2VDb2xzcGFuIH0gPSBtZXJnZUl0ZW07XG4gICAgICAgICAgICBmb3IgKGxldCBySW5kZXggPSAwOyBySW5kZXggPCBkYXRhcy5sZW5ndGg7IHJJbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJvd0luZGV4ID0gJHRhYmxlLmdldFZUUm93SW5kZXgoZGF0YXNbckluZGV4XS5fcm93KTtcbiAgICAgICAgICAgICAgICBpZiAocm93SW5kZXggPT09IG1lcmdlUm93SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSGVhZGVyICYmIGNvbGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXggPSBySW5kZXggKyBjb2xncm91cHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNoZWV0TWVyZ2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgczogeyByOiByb3dJbmRleCwgYzogbWVyZ2VDb2xJbmRleCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZTogeyByOiByb3dJbmRleCArIG1lcmdlUm93c3BhbiAtIDEsIGM6IG1lcmdlQ29sSW5kZXggKyBtZXJnZUNvbHNwYW4gLSAxIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJvd0xpc3QgPSBkYXRhcy5tYXAoaXRlbSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3QgPSB7fTtcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcbiAgICAgICAgICAgIHJlc3RbY29sdW1uLmlkXSA9IGdldENlbGxMYWJlbChjb2x1bW4sIGl0ZW1bY29sdW1uLmlkXSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdDtcbiAgICB9KTtcbiAgICAvLyDlpITnkIbooajlsL5cbiAgICBpZiAoaXNGb290ZXIpIHtcbiAgICAgICAgY29uc3QgeyBmb290ZXJEYXRhIH0gPSAkdGFibGUuZ2V0VGFibGVEYXRhKCk7XG4gICAgICAgIGNvbnN0IGZvb3RlcnMgPSBnZXRGb290ZXJEYXRhKG9wdGlvbnMsIGZvb3RlckRhdGEpO1xuICAgICAgICBmb290ZXJzLmZvckVhY2goKHJvd3MpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB7fTtcbiAgICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbVtjb2x1bW4uaWRdID0gZ2V0Rm9vdGVyQ2VsbFZhbHVlKCR0YWJsZSwgb3B0aW9ucywgcm93cywgY29sdW1uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9vdExpc3QucHVzaChpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGV4cG9ydE1ldGhvZCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgYm9vayA9IFhMU1gudXRpbHMuYm9va19uZXcoKTtcbiAgICAgICAgY29uc3QgbGlzdCA9IChpc0hlYWRlciA/IGNvbExpc3QgOiBbXSkuY29uY2F0KHJvd0xpc3QpLmNvbmNhdChmb290TGlzdCk7XG4gICAgICAgIGNvbnN0IHNoZWV0ID0gWExTWC51dGlscy5qc29uX3RvX3NoZWV0KGxpc3QubGVuZ3RoID8gbGlzdCA6IFt7fV0sIHsgc2tpcEhlYWRlcjogdHJ1ZSB9KTtcbiAgICAgICAgc2hlZXRbJyFjb2xzJ10gPSBzaGVldENvbHM7XG4gICAgICAgIHNoZWV0WychbWVyZ2VzJ10gPSBzaGVldE1lcmdlcztcbiAgICAgICAgLy8g6L2s5o2i5pWw5o2uXG4gICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQoYm9vaywgc2hlZXQsIHNoZWV0TmFtZSk7XG4gICAgICAgIGNvbnN0IHdib3V0ID0gWExTWC53cml0ZShib29rLCB7IGJvb2tUeXBlOiAneGxzeCcsIGJvb2tTU1Q6IGZhbHNlLCB0eXBlOiAnYmluYXJ5JyB9KTtcbiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFt0b0J1ZmZlcih3Ym91dCldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pO1xuICAgICAgICAvLyDlr7zlh7ogeGxzeFxuICAgICAgICBkb3dubG9hZEZpbGUocGFyYW1zLCBibG9iLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKHNob3dNc2cpIHtcbiAgICAgICAgICAgIG1vZGFsLmNsb3NlKG1zZ0tleSk7XG4gICAgICAgICAgICBtb2RhbC5tZXNzYWdlKHsgbWVzc2FnZTogdCgndnhlLnRhYmxlLmV4cFN1Y2Nlc3MnKSwgc3RhdHVzOiAnc3VjY2VzcycgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmIChzaG93TXNnKSB7XG4gICAgICAgIG1vZGFsLm1lc3NhZ2UoeyBpZDogbXNnS2V5LCBtZXNzYWdlOiB0KCd2eGUudGFibGUuZXhwTG9hZGluZycpLCBzdGF0dXM6ICdsb2FkaW5nJywgZHVyYXRpb246IC0xIH0pO1xuICAgICAgICBzZXRUaW1lb3V0KGV4cG9ydE1ldGhvZCwgMTUwMCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBleHBvcnRNZXRob2QoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkb3dubG9hZEZpbGUocGFyYW1zLCBibG9iLCBvcHRpb25zKSB7XG4gICAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtcztcbiAgICBjb25zdCB7ICR2eGUgfSA9ICR0YWJsZTtcbiAgICBjb25zdCB7IG1vZGFsLCB0IH0gPSAkdnhlO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgZmlsZW5hbWUsIHR5cGUgfSA9IG9wdGlvbnM7XG4gICAgY29uc3Qgc2hvd01zZyA9IG1lc3NhZ2UgIT09IGZhbHNlO1xuICAgIGlmICh3aW5kb3cuQmxvYikge1xuICAgICAgICBpZiAobmF2aWdhdG9yLm1zU2F2ZUJsb2IpIHtcbiAgICAgICAgICAgIG5hdmlnYXRvci5tc1NhdmVCbG9iKGJsb2IsIGAke2ZpbGVuYW1lfS4ke3R5cGV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBsaW5rRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgICAgIGxpbmtFbGVtLnRhcmdldCA9ICdfYmxhbmsnO1xuICAgICAgICAgICAgbGlua0VsZW0uZG93bmxvYWQgPSBgJHtmaWxlbmFtZX0uJHt0eXBlfWA7XG4gICAgICAgICAgICBsaW5rRWxlbS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGlua0VsZW0pO1xuICAgICAgICAgICAgbGlua0VsZW0uY2xpY2soKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGlua0VsZW0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoc2hvd01zZykge1xuICAgICAgICAgICAgbW9kYWwuYWxlcnQoeyBtZXNzYWdlOiB0KCd2eGUuZXJyb3Iubm90RXhwJyksIHN0YXR1czogJ2Vycm9yJyB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGNoZWNrSW1wb3J0RGF0YSh0YWJsZUZpZWxkcywgZmllbGRzKSB7XG4gICAgcmV0dXJuIGZpZWxkcy5zb21lKGZpZWxkID0+IHRhYmxlRmllbGRzLmluZGV4T2YoZmllbGQpID4gLTEpO1xufVxuZnVuY3Rpb24gaW1wb3J0WExTWChwYXJhbXMpIHtcbiAgICBjb25zdCB7ICR0YWJsZSwgY29sdW1ucywgb3B0aW9ucywgZmlsZSB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IHsgJHZ4ZSwgX2ltcG9ydFJlc29sdmUsIF9pbXBvcnRSZWplY3QgfSA9ICR0YWJsZTtcbiAgICBjb25zdCB7IG1vZGFsLCB0IH0gPSAkdnhlO1xuICAgIGNvbnN0IHNob3dNc2cgPSBvcHRpb25zLm1lc3NhZ2UgIT09IGZhbHNlO1xuICAgIGNvbnN0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgIGZpbGVSZWFkZXIub25sb2FkID0gKGUpID0+IHtcbiAgICAgICAgY29uc3QgdGFibGVGaWVsZHMgPSBbXTtcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gY29sdW1uLnByb3BlcnR5O1xuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGFibGVGaWVsZHMucHVzaChmaWVsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChlLnRhcmdldC5yZXN1bHQsIHsgdHlwZTogJ2JpbmFyeScgfSk7XG4gICAgICAgIGNvbnN0IHJlc3QgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oWEVVdGlscy5maXJzdCh3b3JrYm9vay5TaGVldHMpKTtcbiAgICAgICAgY29uc3QgZmllbGRzID0gcmVzdCA/IFhFVXRpbHMua2V5cyhyZXN0WzBdKSA6IFtdO1xuICAgICAgICBjb25zdCBsaXN0ID0gcmVzdDtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gY2hlY2tJbXBvcnREYXRhKHRhYmxlRmllbGRzLCBmaWVsZHMpO1xuICAgICAgICBpZiAoc3RhdHVzKSB7XG4gICAgICAgICAgICBjb25zdCByZWNvcmRzID0gbGlzdC5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVjb3JkID0ge307XG4gICAgICAgICAgICAgICAgdGFibGVGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlY29yZFtmaWVsZF0gPSBYRVV0aWxzLmlzVW5kZWZpbmVkKGl0ZW1bZmllbGRdKSA/IG51bGwgOiBpdGVtW2ZpZWxkXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkdGFibGUuY3JlYXRlRGF0YShyZWNvcmRzKVxuICAgICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGxvYWRSZXN0O1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGUgPT09ICdpbnNlcnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRSZXN0ID0gJHRhYmxlLmluc2VydEF0KGRhdGEsIC0xKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRSZXN0ID0gJHRhYmxlLnJlbG9hZERhdGEoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkUmVzdC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9pbXBvcnRSZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaW1wb3J0UmVzb2x2ZSh7IHN0YXR1czogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2hvd01zZykge1xuICAgICAgICAgICAgICAgIG1vZGFsLm1lc3NhZ2UoeyBtZXNzYWdlOiB0KCd2eGUudGFibGUuaW1wU3VjY2VzcycsIFtyZWNvcmRzLmxlbmd0aF0pLCBzdGF0dXM6ICdzdWNjZXNzJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzaG93TXNnKSB7XG4gICAgICAgICAgICAgICAgbW9kYWwubWVzc2FnZSh7IG1lc3NhZ2U6IHQoJ3Z4ZS5lcnJvci5pbXBGaWVsZHMnKSwgc3RhdHVzOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9pbXBvcnRSZWplY3QpIHtcbiAgICAgICAgICAgICAgICBfaW1wb3J0UmVqZWN0KHsgc3RhdHVzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgZmlsZVJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZSk7XG59XG5mdW5jdGlvbiBoYW5kbGVJbXBvcnRFdmVudChwYXJhbXMpIHtcbiAgICBpZiAocGFyYW1zLm9wdGlvbnMudHlwZSA9PT0gJ3hsc3gnKSB7XG4gICAgICAgIGltcG9ydFhMU1gocGFyYW1zKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGhhbmRsZUV4cG9ydEV2ZW50KHBhcmFtcykge1xuICAgIGlmIChwYXJhbXMub3B0aW9ucy50eXBlID09PSAneGxzeCcpIHtcbiAgICAgICAgZXhwb3J0WExTWChwYXJhbXMpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLyoqXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOaUr+aMgeWvvOWHuiB4bHN4IOagvOW8j1xuICovXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5FeHBvcnRYTFNYID0ge1xuICAgIGluc3RhbGwodnhldGFibGUpIHtcbiAgICAgICAgY29uc3QgeyBpbnRlcmNlcHRvciB9ID0gdnhldGFibGU7XG4gICAgICAgIHZ4ZXRhYmxlLnNldHVwKHtcbiAgICAgICAgICAgIGV4cG9ydDoge1xuICAgICAgICAgICAgICAgIHR5cGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHhsc3g6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpbnRlcmNlcHRvci5taXhpbih7XG4gICAgICAgICAgICAnZXZlbnQuaW1wb3J0JzogaGFuZGxlSW1wb3J0RXZlbnQsXG4gICAgICAgICAgICAnZXZlbnQuZXhwb3J0JzogaGFuZGxlRXhwb3J0RXZlbnRcbiAgICAgICAgfSk7XG4gICAgfVxufTtcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuVlhFVGFibGUpIHtcbiAgICB3aW5kb3cuVlhFVGFibGUudXNlKFZYRVRhYmxlUGx1Z2luRXhwb3J0WExTWCk7XG59XG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbkV4cG9ydFhMU1g7XG4iXX0=\n"],"sourceRoot":""}