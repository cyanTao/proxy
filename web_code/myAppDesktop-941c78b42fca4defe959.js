(window["webpackJsonp_/@project/web_code"]=window["webpackJsonp_/@project/web_code"]||[]).push([[68],{PTv5:function(t,e,a){"use strict";a("dAYI")},QsT7:function(t,e,a){"use strict";var i=a("TqRt"),n=a("cDf5");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a("o0o1")),r=i(a("HaE+")),o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var a=m(e);if(a&&a.has(t))return a.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=s?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}i.default=t,a&&a.set(t,i);return i}(a("mAwZ")),l=a("7Qib"),c=i(a("tVcw")),d=i(a("t2rG")),u=i(a("dtjv")),p=a("oYx3"),f=i(a("x/Cv")),g=a("xBdn"),v=i(a("IoAZ"));function m(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,a=new WeakMap;return(m=function(t){return t?a:e})(t)}var h={components:{draggable:d.default,Upload:f.default,recommentImg:v.default},mixins:[c.default,u.default],props:{},data:function(){return{keyword:"",condition:!1,loading:!1,dialogLoading:!1,appList:[],searchList:[],editMode:!1,getImageUrl:l.getImageUrl,statusFix:{1:"未安装",2:"已安装",3:"待升级",4:"已下架"},dialogVisible:!1,isShortcut:!1,form:{id:0,appName:"",icon:"",link:""},shareIconOption:[this.$getImgPrefix("/myApp/bg-link.png")],rules:{appName:(0,g.getValidators)([{message:"请输入快捷方式名称",include:g.required,required:!0,trigger:"change"}]),icon:(0,g.getValidators)([{message:"请选择快捷方式图标",include:g.required,required:!0,trigger:"change"}]),link:(0,g.getValidators)([{message:"请输入快捷链接",include:g.required,required:!0,trigger:"change"}])}}},created:function(){var t=this;return(0,r.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getAppList();case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){},methods:{confirm:function(){var t=this;this.$refs.formRef.validate((function(e){e&&(t.dialogLoading=!0,o.appShortcutSave(t.form).then((function(){t.$message.success("添加成功"),t.dialogVisible=!1,t.getAppList()})).finally((function(){t.dialogLoading=!1})))}))},addShortcut:function(){var t=this;this.dialogVisible=!0,this.isShortcut=!0,this.$nextTick((function(){t.$refs.formRef.resetFields()}))},onEnd:function(){o.appInstallSort(this.appList.filter((function(t){return t.appId||t.shortcutId})).map((function(t){return{appId:t.appId,shortcutId:t.shortcutId,type:t.type}})))},handleMode:function(){this.editMode=!this.editMode},uninstall:function(t){var e=this;return(0,r.default)(s.default.mark((function a(){return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.appUninstall(t);case 2:e.getAppList();case 3:case"end":return a.stop()}}),a)})))()},viewDetail:function(t){var e=this;if(!this.editMode){var a,i={2:(a=(0,r.default)(s.default.mark((function a(){return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,l.sleep)(300);case 2:"INSTALLED"===t.type?e.useApp(t):window.open(t.link);case 3:case"end":return a.stop()}}),a)}))),function(){return a.apply(this,arguments)}),3:this.upgrade.bind(this,t.appId),4:this.showUnpublicTips.bind(this,t.appId)}[t.installedAppStatus||2];i()}},upgrade:function(t){var e=this;return(0,r.default)(s.default.mark((function a(){return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.appUpgrade(t);case 2:e.getAppList();case 3:case"end":return a.stop()}}),a)})))()},showUnpublicTips:function(t){var e=this;return(0,r.default)(s.default.mark((function a(){var i,n,r,l,c,d;return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.unpublishNote({appId:t});case 2:i=a.sent,n=i.data,r=n.appName,l=n.note,c=n.version,d=e.$createElement,e.$msgbox({title:"已下架",message:d("div",{class:"upgrade-desc-box"},[d("div",{class:"upgrade-title"},"".concat(r," ").concat(c)),d("div",{class:"upgrade-desc"},l)])});case 9:case"end":return a.stop()}}),a)})))()},intoMarket:function(){this.$router.push({name:p.authKey.appMarket})},getAppList:function(){var t=this;return(0,r.default)(s.default.mark((function e(){var a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,o.appDesktop({keyword:t.keyword,onlyShortcut:!1});case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a={data:[]};case 10:t.appList=[{id:"appMarketId"}].concat(a.data),t.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,7]])})))()},getSearchList:function(){var t=this;return(0,r.default)(s.default.mark((function e(){var a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dialogLoading=!0,e.prev=1,e.next=4,o.appDesktop({keyword:t.keyword,onlyShortcut:t.condition});case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a={data:[]};case 10:t.searchList=a.data,t.dialogLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,7]])})))()}},computed:{},watch:{dialogVisible:function(t){t&&this.getSearchList()}}};e.default=h},XjFK:function(t,e,a){"use strict";a.r(e);var i=a("QsT7"),n=a.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e.default=n.a},dAYI:function(t,e,a){var i=a("i5Oa");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("SZ7m").default)("40343574",i,!0,{})},hnq6:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-desktop"},[a("div",{staticClass:"list"},[a("draggable",{attrs:{group:"appList",animation:"300",draggable:".edit"},on:{end:t.onEnd},model:{value:t.appList,callback:function(e){t.appList=e},expression:"appList"}},[a("transition-group",[t._l(t.appList,(function(e){return["appMarketId"===e.id?a("div",{key:e.id,staticClass:"list-item",on:{click:t.intoMarket}},[a("div",{staticClass:"icon",style:"background-image: url("+t.$getImgPrefix("/myApp/app-market.png")+")"}),t._v(" "),a("div",{staticClass:"app-name"},[t._v("应用市场")])]):a("div",{key:e.type+"-"+(e.appId||e.shortcutId),staticClass:"list-item",class:{edit:t.editMode,"app-disabled":4==e.installedAppStatus},on:{click:function(a){return t.viewDetail(e)}}},[t.editMode?a("img",{staticClass:"uninstall",attrs:{src:t.$getImgPrefix("/myApp/app-delete.png"),alt:""},on:{click:function(a){return t.uninstall(e)}}}):t._e(),t._v(" "),a("div",{staticClass:"icon",style:"background-image: url("+t.getImageUrl(e.icon,!1,e.appId)+")"},["SHORTCUT"===e.type?a("span",{staticClass:"app-status shortcut"}):[3,4].includes(e.installedAppStatus)?a("span",{staticClass:"app-status",class:"status"+e.installedAppStatus},[t._v(t._s(t.statusFix[e.installedAppStatus]))]):t._e()]),t._v(" "),a("div",{staticClass:"app-name",attrs:{title:e.appName}},[t._v("\n              "+t._s(e.appName)+"\n            ")])])]}))],2)],1)],1),t._v(" "),a("div",{staticClass:"operate-area"},[a("span",{staticClass:"search",on:{click:function(e){t.isShortcut=!1,t.dialogVisible=!0}}}),t._v(" "),a("span",{staticClass:"add",on:{click:t.addShortcut}}),t._v(" "),a("span",{staticClass:"edit",on:{click:t.handleMode}})]),t._v(" "),a("el-dialog",{staticClass:"search-area",class:{isShortcut:t.isShortcut},attrs:{"custom-class":"low-code-dialog",title:t.isShortcut?"添加快捷方式":"应用搜索",visible:t.dialogVisible,"show-close":!1,modal:!1,"close-on-click-modal":!t.isShortcut},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"search-area-content"},[t.isShortcut?[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogLoading,expression:"dialogLoading"}],ref:"formRef",staticStyle:{width:"600px"},attrs:{model:t.form,rules:t.rules,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"快捷方式名称",prop:"appName"}},[a("el-input",{attrs:{clearable:""},model:{value:t.form.appName,callback:function(e){t.$set(t.form,"appName",e)},expression:"form.appName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"快捷链接",prop:"link"}},[a("el-input",{attrs:{clearable:""},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"快捷方式图标",prop:"icon"}},[a("Upload",{ref:"upload",staticClass:"app-icon",model:{value:t.form.icon,callback:function(e){t.$set(t.form,"icon",e)},expression:"form.icon"}}),t._v(" "),a("recomment-img",{attrs:{options:t.shareIconOption},on:{select:function(e){return t.$refs.upload.recieveFile(e)}}})],1)],1)]:[a("el-row",{staticClass:"flex"},[a("div",{staticStyle:{"padding-right":"15px",flex:"1"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"输入分类或应用名称搜索",clearable:""},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",type:"primary"},on:{click:t.getSearchList},slot:"append"})],1)],1),t._v(" "),a("el-checkbox",{on:{change:t.getSearchList},model:{value:t.condition,callback:function(e){t.condition=e},expression:"condition"}},[t._v("仅快捷方式")])],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogLoading,expression:"dialogLoading"}],staticClass:"full-fill"},t._l(t.searchList,(function(e){return a("div",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.appId,staticClass:"result-item",on:{click:function(a){return t.viewDetail(e)}}},[a("div",{staticClass:"icon",style:"background-image: url("+t.getImageUrl(e.icon,!1,e.appId)+")"}),t._v(" "),a("div",{staticClass:"app-info"},[a("span",{staticClass:"name",attrs:{title:e.appName}},[t._v("\n                "+t._s(e.appName)+"\n              ")]),t._v(" "),a("span",{staticClass:"category",attrs:{title:e.categoryName}},[t._v("\n                "+t._s("SHORTCUT"===e.type?"快捷方式":e.categoryName)+"\n              ")])])])})),0)]],2),t._v(" "),t.isShortcut?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{loading:t.dialogLoading,type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1):t._e()])],1)},n=[]},i5Oa:function(t,e,a){},tmAU:function(t,e,a){"use strict";a.r(e);var i=a("hnq6"),n=a("XjFK");for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("PTv5");var r=a("KHd+"),o=Object(r.a)(n.default,i.a,i.b,!1,null,"1c08f06c",null);e.default=o.exports}}]);
//# sourceMappingURL=/@project/web_code/myAppDesktop-941c78b42fca4defe959.js.map